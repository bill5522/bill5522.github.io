{"hash":"047f85ec51bfa3a4aacb1127251e2bb4591e5dd7","data":{"category":{"title":"tech","belongsTo":{"edges":[{"node":{"title":"Artalk 自托管评论系统的后端部署","path":"/posts/artalk-api-php/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/artalk-api-php.a209973.62a5c1490fd9584deccfb457cc6a6749.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/artalk-api-php.a67b0b2.62a5c1490fd9584deccfb457cc6a6749.png 480w","/assets/static/artalk-api-php.a209973.62a5c1490fd9584deccfb457cc6a6749.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-5a9b2862efa77773eeb0150175794da9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-5a9b2862efa77773eeb0150175794da9)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAABJ0AAASdAHeZh94AAAF8klEQVRIx8VXW1NTVxTmrX%2biD52%2btQ/a6UPrZfrQGUenHe3FcVoRbaugHQdELRAIF2uRFnUEFEERQggBlGsCJCH3s89ln33uAUQUBQft5aHVaXVE246a3XUSoA8FArRTZ1bO7HX2Sc631l7f%2blbSWFFKGifKSVvCZbGEFU2NjfBE5rC09MP/j5vGkmWjFyVR0boHfBXVdRFW4CXlhaNPBLDocxJL5IT7d6Z5WbcU5p/I2lRTU4XVGIfFVbwS4dkzh/Pk8OwuwsR8YOWnmrZYsjlAjwlPVCxriS0ZyibMK%2bVl%2bWO2LEtxMUu0AGdwJpqVvZJoBk8ULKmioguyCi%2bCK6zhjiCp8GscUXi4YplNVRFgaQtvEBkJIlZifkbq9TIAHfE8EjAriIdyc7/YufWotdgbNXr6sCAtm0LJZBPZ5nCGER%2bIoK4%2bty8YAVLBoqWto7uv3xsIA2ioT4YXuWWgNwNYgMQAFxOiGPrEvcaK3I5L1cat3%2bThaWnsp59vGtVl2S%2b9/PqHH7x3I9I%2bzHsZonIraQCD/uC2jz4%2bfqIiz1JYUGQ9W3fhaF5%2bYXFJTW19UUnpkbx8OPB%2brx9iYQQRDmcZJP7HBmfmG6ujUzNPqTc4LGrTfzyn9x4%2bn3lG6a8Tw/zAaxs2p6fvmGAuI6KmzP3cTYkRCQTgHvTVNzSePFPV3tndN%2bCxtbSe%2bK6ysdlhd7Y32Ozn6i9CdYmqPjAUCCMO1olCklZGYhYrooTb/dO1Hnp6IH6wkR6oj1d0xc96aKnzqc3O7y/s2J4X9CKVlyCvKdCLROWxjIkqSxrQFzBJWkzUdChLXtE5VRdjo1g1hAQliGok2RxCnJSgSsouvwCJEZZlBdf33t5xin5le76rKv6Ole6qoiVt8ewmurfqwYbdg69s81TZWVVXkCAthV5UXRzaE7S/6TpZGx0E/kIMJkQw4HEoInl9ZNDD8phN1BibaFBwAmMTt67enBJVI3lnZSQ2A1BxbffkxiKa3UALW2m%2bnVrb6GkXtTppZu3Ttz4Pvbq1N8MaIIrC4kUzhMwAlAKma6fcsTZYtRO1DPG8kEgq9C6k6D/mZD7avH5m09ujjQ2MPsIJJFnAYzcnkTZy8Ur/EDh6DAlkZSRmsKyouKZzcs1h%2bm4phXM4bKPbK%2bl6C11noRsLn23Jjr7xSc%2b6zzyeMBFkedF%2bL0pEVPJQ53bi3Kd2ZbAO33wAAkGqca225veNa%2b7veF/yDSFZ40QzAIAbu3ptiJc9iEAkIJ3skuKQttAGlCx2M5MX/LSTpx6VejXaEqF1PtNamXiGldltDW456D/r4BTdPLEFqxMlCNDDRr%2bMtu9lnHWMV5I00G%2bACCUEyWUU3Wh3Eq%2bPgdIXRLOuhIRhafT6jZHrNwRJYVNJ24JKrDA8Hr429fAxffQk/mAm/vCxad//Ev/hfvzJn/GcSvbA8VBGUejMMmhAiBaOciEeK7IBnTEYRbIxglU9DEhlDQGhjRFIM6gbkFsxhuEKa5TkA07o6SqUGDRLHb3lkumlELVHaHOE2sLUHqVwJvrt%2bLHzfLolsPVQwOUXsSQvQQPYgpRDuwTcIC9nqs81NDU32h1g0Ey7et2lx46fv9jQ2etudjib7I6a2rqmlla7s22ucqTVKHHCJZxkxManh6/fiY3fiSWv43eM8btjE1OnmtDadP%2bekpCJPtU7IACPPwQx%2bMPRsq/LLdbinNwjjvbL5d9WWkuP5Rw%2bkmcpshQVH80v2JuZ9Wn6rn1Z%2b8u%2bKSdz/WdVSjwnPXAOTNJ4AaQN3CiwTxabe6XMfF9LJwxKCsKp5whTj0RTht1eH%2bhXj3sgwvJtV7r6%2bj3w6e33uAa8ME30e4fcHp9r0AsBw3S07HF6ieeIOVZwiTHOBGGazBBN5qN3XeU8xmyypaSeI2aLAWARRYfygB8ELYOQzBlO1mABrBBgkbDESPcfjNOLuKCsPFdQkNfZPzTf45b53Xmpmp2fzXF69g7CyVnadNG/H6dTDvQBJMwOW/iF/ZVZmsQpXC5ZVC/uj9i8%2bxfMRyfaLLKa2QAAAABJRU5ErkJggg==' /%3e%3c/svg%3e"},"date":"August 23. 2020","timeToRead":1,"cjkWordCount":1294,"cjkReadTime":6,"description":"Artalk 的后端部署教程","content":"<p>首先，恭喜自己，成功部署了 Artalk 的后端，这或许是件很简单的事，但对于我这种对后端（利用云服务器）一窍不通的白痴来说，这还真是件值得庆祝的事，从「白痴」进阶到了「小白」。考虑到可能也有像我这样的小白，所以这篇文章就出现了。</p>\n<p>从最开始的 Valine 到 utterances 再到 Disqus。<br>\nValine 基于 LeanCloud，但是第三方的服务总归不是特别安全，LeanCloud 的政策也一直在边，完全切断免费版应该是不可能的，但限制只会越来越多。还有人发了刷 Valine 评论的教程，邮箱随时可能爆炸，本就不安全的 Valine 变得更不可靠。垃圾评论也越来越多，没有后端的 Valine 几乎没办法避免，Valine-Admin（Valine 评论系统的扩展和增强） 引入了垃圾评论过滤，但实际效果不佳，垃圾评论没过滤掉，反而正常评论被误杀了；<br>\nutterances 基于 GitHub 的 Issue，虽然官方并没有禁止使用 Issue 进行评论搭建，但是我总感觉怪怪的，而且众所周知，GitHub 的 API 在国内也非常不稳定。使用体验上，我个人觉得并不是非常好，不能进行回复，还不如直接在 Issue 界面评论；<br>\nDisqus 应该算是世界上比较有名的评论系统了，但是因为一些原因被国内墙了，国内只能依靠 DisqusJS 进行评论浏览，而如果想要评论就必须进行代理，要是没有这个问题，Disqus 或许是个很好的选择（除了那庞大的体积）。害，「向来冷清的本站雪上加霜 —— Monstx」真是麻烦啊。</p>\n<p><a href=\"https://github.com/qwqcode/Artalk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@qwqcode/Artalk</a> 🌌 一款简洁有趣的自托管评论系统，应该算是一个比较小众的评论系统了，光是要自己部署后端就劝退一大批人了。不过这都是<del>小</del>大问题，现在用的 Gridsome 框架在国内应该也算是非常小众的一款博客框架了，<del>但咱就喜欢与众不同（求异心理，不可取😜）</del>，毕竟小而美嘛，正好有台服务器，就本着试一试的心态开始了折腾。</p>\n<p>*教程采用阿里云学生机 + 宝塔面板进行演示</p>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>警告</h5></div><div class=\"admonition-content\"><p><strong>鉴于最近宝塔出现的 0day 漏洞，请自行判断宝塔的安全问题！</strong></p></div></div>\n<h2 id=\"安装宝塔面板\"><a href=\"#%E5%AE%89%E8%A3%85%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>安装宝塔面板</h2>\n<p>新人建站，肯定首选宝塔。</p>\n<p>如果之前服务器有整过一些自己也不知道的东西，可以先重装一次系统（宝塔推荐使用 centos 8.X 的系统），记住重装时的用户名和密码。</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/re-install.png?fmt=webp\" alt=\"重装\"><figcaption>重装</figcaption></figure>\n<p>进入实列进行远程连接，选择 「终端连接」 进行 「密码认证」</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/remote.png?fmt=webp\" alt=\"远程连接\"><figcaption>远程连接</figcaption></figure>\n<p>输入以下命令安装宝塔</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> -y <span class=\"token function\">wget</span>\n<span class=\"token function\">wget</span> -O install.sh http://download.bt.cn/install/install_6.0.sh\n<span class=\"token function\">sh</span> install.sh<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span></span></code></pre>\n<p>安装完成后会显示登录网址（外网）和用户名密码，需要保存。同时可能会提示进行端口放行，此时前往安全组页面查看</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/safe.png?fmt=webp\" alt=\"安全组\"><figcaption>安全组</figcaption></figure>\n<p>若没有相关端口的放行则需要手动添加</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/port.png?fmt=webp\" alt=\"放行端口\"><figcaption>放行端口</figcaption></figure>\n<h2 id=\"安装相关内容\"><a href=\"#%E5%AE%89%E8%A3%85%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>安装相关内容</h2>\n<p>安装 Git，在远程连接中输入：</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\">yum –y <span class=\"token function\">install</span> <span class=\"token function\">git</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>登录宝塔界面，在软件商店页面搜索安装 <code>PHP-7.4</code> 和 <code>Nginx 1.18.0</code>，注意选择<strong>快速安装</strong></p>\n<p>进入 PHP 管理页面，在禁用函数中将 <code>putenv</code> 删除</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/putenv.png?fmt=webp\" alt=\"删除函数禁用\"><figcaption>删除函数禁用</figcaption></figure>\n<p>在远程连接中输入</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/qwqcode/ArtalkServerPhp.git\n<span class=\"token builtin class-name\">cd</span> ArtalkServerPhp\n<span class=\"token function\">composer</span> <span class=\"token function\">install</span>\nphp -r <span class=\"token string\">\"copy('Config.example.php', 'Config.php');\"</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>若在出现报错 <code>Warning: putenv() has been disabled</code>，检查禁用函数中是否还存在 <code>putenv</code>。</p>\n<h2 id=\"修改配置\"><a href=\"#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>修改配置</h2>\n<p>在宝塔面板的文件页面中找到 <code>Config.php</code> 参照注释进行修改，如果你是按之前的步骤来的，没有进入其他目录，那 <code>ArtalkServerPhp</code> 文件夹应该是在根目录的 <code>root</code> 文件夹中。</p>\n<h2 id=\"添加站点\"><a href=\"#%E6%B7%BB%E5%8A%A0%E7%AB%99%E7%82%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>添加站点</h2>\n<p>更改 <code>ArtalkServePhp</code> 文件夹的权限为 755，并应用到子目录</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/authority.png?fmt=webp\" alt=\"更改权限\"><figcaption>更改权限</figcaption></figure>\n<p>在宝塔面板的站点页面添加站点，根目录选择 <code>ArtalkServePhp/public</code> 文件夹</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/artalk-api-php/site.png?fmt=webp\" alt=\"添加站点\"><figcaption>添加站点</figcaption></figure>\n<p>将域名用 A 记录解析到服务器的<strong>公网 IP</strong></p>\n<p>至此，大功告成！</p>\n<h2 id=\"后\"><a href=\"#%E5%90%8E\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>后</h2>\n<p>现在发现这个过程是真的蛮简单的，不过对于当时的我来说可绝对不是这样的。这是 Artalk 后端部署的部分，前端部分如有问题可以看看「<a href=\"https://blog.monsterx.cn/code/use-self-hosted-comment-system-in-gridsome/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">为 Gridsome 添加 Artalk 自托管评论系统 - Monstx</a>」，适配了暗黑模式，那有轮子咱肯定要直接用呀！</p>\n"}},{"node":{"title":"利用 GitHub 从 sitemap 中提取链接并推送至百度","path":"/posts/baidu-submit-using-sitemap/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/baidu-submit-using-sitemap.a209973.acb5d4ba78075527467dd59cd6a12353.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/baidu-submit-using-sitemap.a67b0b2.acb5d4ba78075527467dd59cd6a12353.png 480w","/assets/static/baidu-submit-using-sitemap.a209973.acb5d4ba78075527467dd59cd6a12353.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-2b9d736e64885f28463f41b521517d78'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-2b9d736e64885f28463f41b521517d78)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAHbUlEQVRIx41Xa2/TZhTuT9iXfZk2TdOmgcQu0j7sy6ZJSAy2SbshNnbTQION3dgFgRBjQGlXxgaFMloKNGWDtGmA0jal0Jam6ZWmaVNKk6ZJbCeOEyeOc2vS2k7SBrzjW5o0vSBZ0evXx4/POe85z3lShAY5LMihQRYLstJavM1uZtccAgua9UUEM3R5s0dEKzRDYE0xKMVidBKhhEfi7/JotLAuEu5pBZ3iss6J77DZHYTiyAjYMCd65n5vn/eExHgUM4xaKqQCtBXMwAc8nCZiGVco5fTPuiNznug8rFdFKwLPch7LSZI/QAkphzUR5ogQ02iZ39zAP1bCf1af8YaFkBDFDKXlDK2MtrQZxeKRuSGLu7JWox%2ba0A9bdXrj%2bcvXekw2s93vDqfgHFZAK0KCuSWRNRI35YSxfUjy21b%2b%2bVLy%2bd13njiAf3md94YZJN9MendVtEIzhGKI2Hy3afL7X/aXlVdV/3e16pL2YMkJWGt0XWSCdwZmV0Aryn4MVUBzoMVCDDDv1KQePzTz4tbi1ze%2buWbrsS%2b180SYdQaYnBrNe7EQTdpZwQwJsDbvtHAR01Y8POWNw2X3JaAfVkYrynZDIS6UoCeSdpLx9Sp%2b7Ve1L%2b84v/a7puc%2bKt3ewpPRlHc6A5dyvrnvrhLMkmaY2Ab%2bGf7OXUvJX2d88Ydwm%2bvYcmhFSD5iNkmuUHLEETBN%2bVA6taEqse6DPeu%2bqXtpy/41O65sOtA44fRq2weaDSYiOp%2bNAQtyy6FhCzljXTSHyMQg84S0D3XljWX6zPa//7non%2bWRwKzSY7LTi9DQYJaFcqgq672DnGnrHdEZhu3kzIZzzHMfH39103sv7NKs2a5au3Fbe7/ZqNbu/Xmvg4wCI6HL8GM%2b9wk7DopzCuXLukMpdzgNzONWLjDzCOlgxtEgLDCxBKCJwcZFJ6GWhN%2bCBlvEQnLpu8Nz9xyebZXmLTWhcSz8pop/as/Yuq81T/7BvfJ58a8lZ6bIeGVV8%2b1rAyQdzR50AQvlnCe4HuBG8OQYkexDUkgwPYHRdyfcZjs55gyMOfwjUz4wNlpxqzsCjWuyeR1kwopHwQzW0BjQcnZfXOo6%2bUO0EgAqH5MclpNiIAEGk3XbmaHNqmm9JfTGRf79wyO6cy3b6%2bO1zX0Of9yN0y%2b/u7OqdiDjcDrJBKpMkkI0aYbgIXYQS1YOpmuG0%2boRzhXj6260n1VpahtaKlWaivOXDxT/dbam7uDR41WXGqATDpeV/3HibINOD6Skaem6qL5x5sKV30tPQLSucFqad9JHi5DgomwJg9DmS7Qahk9pe9%2bqwGu6fZvV8xUtmGN88mjFuf3HTnumH3rvTb22ftOvpeWR8KwrkMiyWwGacgI0Zw9wvUhS70iN4JwrLBB/4%2b2%2bNoOpd9TeNTTRNWSB26aOAb3RClVkMNmaOwf7x5D%2bMSc8atUbb/WM3uodnSSmsVAyr4nFKcgqlC/VT3rU4VdpW0urtR9d8JW2hawuxqDv/um3I6pTlWcvqKMpftzqWf/%2b1n1lFa5IxkYyeTyWg5bDenIz2PziKYnDC6gGRq9HHLqwgFvv9AOx%2bllPNOObfgieAA3CDuyDAVwSqypDdjGNSgNCCKDTaDVOEncnvTtrsd034gmUOHSw5O0vvlZfvVmpqo%2bk%2bQELvmvfobKqyz%2b38g1mjoyyTipPouSQHatsSuXLupRNqFVEuCBgQfaAggBe7ui/d%2bTP055YBuYXPBXYSTZjZNZS0PJYCMsRTAA3gUepmQwZmdmnQbdcitrt1IGDpZ98v7e6XleuaojO8Uab98ip82Xn6p4pSRy/w4TiQo9iOVoFW8z0LCbP4Dw2zDUD/yCALI1CPKui5Yq5hTEB3yAiyX97iLp%2bQtPrvGmmkMDMoZPVxacunK7VHj5ZTbG8edLTfsvQ0jH09G/EsduxUDzpCCwhNtFlNClUAhGdQ6lsl7NSdsETh3/mPhYEGoQaE5tHIVDxEkHyyHSxmIMF7HijqS17yj/8pdwbmvWEk8BiJ2s0VeobR09f/G7/UZCK96Z8JrOt/67l2WL6z/ZYKCEHsLqYo2CQJad8icH7mMB4AUbk%2b6QgPAUXhWCg6C14BAzgKQgK0BegKcAHGE2gOBzCyYgHsqSYkyYiuKjRdda3dOARYaAAxJWmTnVTR02DDnpD%2bh74ag8wTROpYTewpCScVhdziMDRc0Yb8enOH24PjOu6Ta0GE4A33OwZsuLq5s4uozXI8tq2ns92/tjYOQiLxo5BsLne3m8YtTfrjW19ZrfApOwqYs6XeOCLP5C%2bClOztXvY7AxADoA0FmY7zcH/G5xeXf/kyi/ItJ1MgCsWdxhmk9UTHcdos8MPaZpwh%2bBwIDuTRGzwvgsGGVhCN0NdCT0dYCY9sSlffIGLJBZC6UUaS/gFipDOV3oEFQlT3UWnRGZY8AmRGG1Bq7AFio3NZyS5JSA74CiUE5ynJCXERUp2jk5Cplxi9UuZkt4CG6kTsmjLy2lBci30pVNRziubPSKa%2bJQpiI2VzSSWpNhHQfsfgnHfilEt5AkAAAAASUVORK5CYII=' /%3e%3c/svg%3e"},"date":"August 11. 2020","timeToRead":2,"cjkWordCount":1215,"cjkReadTime":6,"description":"每天自动从 sitemap 中提取链接并推送至百度","content":"<p>之前在 「利用 GitHub Action 实现自动化」一文中介绍了如何利用 GitHub Action 实现自动提交百度收录。当时使用的博客框架是 Hexo，配套了自动生成文章链接的插件。而目前本站已经从 Hexo 换成了 Gridsome，经过一番折腾，终于成功迁移了，不过以前的一些过水的文章已经删掉了~实际上是懒得给文章做题图~。中途还有用 Forestry（博客 CMS 系统） 管理文章的想法，但是转念一想，管理系统是在浏览器上的，写文章体验本不怎么样，而且我都已经把源代码上传到 GitHub 了，本地在 Markdown 编辑器中写完再上传到 GitHub 中，体验反而更好。</p>\n<h2 id=\"前言\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>前言</h2>\n<p>扯远了，回归正题。前面提到，在 Hexo 中是依靠一个 <a href=\"https://github.com/huiwang/hexo-baidu-url-submit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">hexo-baidu-url-submit</a> 插件就能完成文章链接生成、链接推送，不得不佩服 Hexo 这超赞的生态，不光是插件，主题也是如此，这应该也是 Hexo 最大的优势了吧。相比之下， Gridsome 这里主题少的可怜，插件虽然有 172 个，大概是 Hexo 的一般，但大部分插件的本地化较差，毕竟是外国用户更多。</p>\n<p>Gridsome 官网上看到官方称其 <em>SEO-friendly</em></p>\n<blockquote>\n<p>Gridsome sites load as static HTML before they hydrate into fully Vue.js-powered SPAs. This makes it possible for search engines to be able to crawl content and give better SEO ranking, and still have all the power of Vue.js.</p>\n</blockquote>\n<p>于是乎，就想到了 sitemap，Google 不用说了，交了站点地图基本都会收录，百度那虽然不一定但总比没有好。当然还想到的就是百度提供的 API。翻了一圈，就找到了 <a href=\"https://gridsome.org/plugins/@gridsome/plugin-sitemap\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@gridsome/plugin-sitemap</a>。百度的 API 推送只好暂时放下。今天正好无聊又想到了这件事，现在已经有了 sitemap，或许我们可以直接从其中提取链接进行推送。一搜，果然有提取 sitemap 中链接的网站，但这样手动提取，然后写脚本用 API 岂不是很麻烦，不如直接把提取也集成进来。</p>\n<h2 id=\"提取链接\"><a href=\"#%E6%8F%90%E5%8F%96%E9%93%BE%E6%8E%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>提取链接</h2>\n<p>稍微看看 sitemap.xml 就能发现链接的格式是固定的</p>\n<pre class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>loc</span><span class=\"token punctuation\">></span></span>https://blog.jalenchuh.cn/<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>loc</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span></span></code></pre>\n<p>那么我们只需要用正则去获取 <code>&#x3C;loc></code> 和 <code>&#x3C;/loc></code> 之间的内容就好了</p>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token operator\">?</span><span class=\"token operator\">&lt;=</span><span class=\"token operator\">&lt;</span>loc<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token operator\">?</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>loc<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<h2 id=\"推送\"><a href=\"#%E6%8E%A8%E9%80%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>推送</h2>\n<p>比较方便的有 <code>curl</code> 和 <code>post</code> ，然而利用 <code>post</code> 需要差不多 30s，而 <code>curl</code> 只要 2s 左右。</p>\n<p>官方也给了 <code>curl</code> 的方法</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -H <span class=\"token string\">'Content-Type:text/plain'</span> --data-binary @urls.txt \"http://data.zz.baidu.com/urls?site<span class=\"token operator\">=</span>xxx<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">token</span><span class=\"token operator\">=</span>xxx<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<h2 id=\"编写链接生成脚步\"><a href=\"#%E7%BC%96%E5%86%99%E9%93%BE%E6%8E%A5%E7%94%9F%E6%88%90%E8%84%9A%E6%AD%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>编写链接生成脚步</h2>\n<p>通过 <code>urllib.request.urlopen</code> 进行文件打开，然后用 utf-8 解码 <code>.decode('utf-8')</code>，本地测试的时候没有用 utf-8 就会莫名出错。</p>\n<p>用 <code>re.compile</code> 进行正则匹配，并用 <code>re.findall</code> 直接获取匹配后的字串，之后来个 <code>for</code> 就完美解决。</p>\n<pre class=\"language-py line-numbers\"><code class=\"language-py\"><span class=\"token keyword\">import</span> re\n<span class=\"token keyword\">import</span> urllib\n<span class=\"token keyword\">import</span> requests\n\nsitemap <span class=\"token operator\">=</span> <span class=\"token string\">'https://blog.jalenchuh.cn/sitemap.xml'</span>\n\nhtml <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>sitemap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>\nresult <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'(?&lt;=&lt;loc>).*?(?=&lt;/loc>)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> html<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'urls.txt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">for</span> data <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token builtin\">file</span><span class=\"token operator\">=</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>以上是利用 py 生成 txt 文件，等会再用 <code>curl</code> 推送。当然还可以利用 <code>post</code> 进行推送，不过慢很多。</p>\n<p>首先安装百度要求定义 <code>header</code></p>\n<pre class=\"language-py line-numbers\"><code class=\"language-py\">headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'curl/7.12.1'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'Host'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'data.zz.baidu.com'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'text/plain'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'Content-Length'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'83'</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>利用 <code>requests.post</code> 推送</p>\n<pre class=\"language-py line-numbers\"><code class=\"language-py\"><span class=\"token keyword\">for</span> data <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span> <span class=\"token operator\">+</span>\n    requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>\n      url <span class=\"token operator\">=</span> url<span class=\"token punctuation\">,</span>\n      data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">,</span>\n      headers <span class=\"token operator\">=</span> headers\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span>\n  <span class=\"token punctuation\">)</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>此处 url 涉及 token</h5></div><div class=\"admonition-content\"><p>我们应该先用 <code>BAIDU_TOKEN</code> 替换原来的 token 值，之后在 Action 中利用 <code>sed -i</code> 替换。</p></div></div>\n<h2 id=\"编写-action-文件\"><a href=\"#%E7%BC%96%E5%86%99-action-%E6%96%87%E4%BB%B6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>编写 Action 文件</h2>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> push\n\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 16 * * *'</span>\n  <span class=\"token key atrule\">watch</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>started<span class=\"token punctuation\">]</span>\n\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@master\n\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up python\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>python@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">python-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3.8</span>\n\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install requests\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> pip install requests\n\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> generate\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> python generate.py\n\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Push\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">BAIDU_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.BAIDUTOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">SITE</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SITE <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> curl <span class=\"token punctuation\">-</span>H 'Content<span class=\"token punctuation\">-</span>Type<span class=\"token punctuation\">:</span>text/plain' <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">-</span>binary @urls.txt \"http<span class=\"token punctuation\">:</span>//data.zz.baidu.com/urls<span class=\"token punctuation\">?</span>site=$<span class=\"token punctuation\">{</span>SITE<span class=\"token punctuation\">}</span><span class=\"token important\">&amp;token=$</span><span class=\"token punctuation\">{</span>BAIDU_TOKEN<span class=\"token punctuation\">}</span>\"<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>如果是利用 <code>post</code> 进行推送，直接运行 py 文件就好了，不过在此之前需要替换刚刚文件中的 <code>BAIDU_TOKEN</code></p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> BAIDU env\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">BAIDU_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.BAIDUTOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sed <span class=\"token punctuation\">-</span>i \"s/BAIDU_TOKEN/$<span class=\"token punctuation\">{</span>BAIDU_TOKEN<span class=\"token punctuation\">}</span>/\" xxx.py<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"配置\"><a href=\"#%E9%85%8D%E7%BD%AE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>配置</h2>\n<p>具体配置见 <a href=\"https://github.com/JalenChuh/baidu-url-submit-by-using-sitemap#readme\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">README</a></p>\n<h2 id=\"结束\"><a href=\"#%E7%BB%93%E6%9D%9F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>结束</h2>\n<p>到这里，这篇文章就水完了。终究还是<em>需求推动生成啊</em>。</p>\n<p>前几天从 Hexo 换到了 Gridsome，把一些非常水的文章删了，现在只剩下十几篇了，不过也好，提升博客质量嘛，宁愿文章少也不要一堆水文。每个人对水文的定义不同，在我看来文章很短但不一定是水文，而以前的几篇 OI 题解就很水，题目一放，随便说几句就直接上代码。不过适当的水文还是可以接受的<del>比如这篇</del>。</p>\n"}},{"node":{"title":"我是如何加速博客的","path":"/posts/how-i-make-blog-faster/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/how-i-make-blog-faster.a209973.9110b66f44ef367118bac2f15554b0b1.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/how-i-make-blog-faster.a67b0b2.9110b66f44ef367118bac2f15554b0b1.png 480w","/assets/static/how-i-make-blog-faster.a209973.9110b66f44ef367118bac2f15554b0b1.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-0525b2aeb3c8a2be09ea48ebd32654d4'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-0525b2aeb3c8a2be09ea48ebd32654d4)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAF6klEQVRIx8VXe2xTZRS/U4wPxEj80xklJiaIaCIqGvEPY0gEMRgwEo2BifIQFtyUsSiEzMEYAxnr2OZG2RhjIwzmBhtzL7qte3VurGvZKGxsfdy2a3t7b3sfvbev1Xnam13u%2bnKJCMmXL%2bfennu%2bc77z%2b51zijhIkl9OioIlPPJv4vz0PynzLwmH0%2b5wEE4nHtrjKCNR7Yof%2be%2bjHvNflPk3sWJzcWwg4KddtNfn9QemwWwsy0isq4ol3xdl2C02m81uhwu2E4R4YTjBcazihnpvpmTD1r1bd6dVXaqjaJqkacIZN4CwWxEe%2bc%2bCaZ1NJQj8T3C8WNlJkiRNxYEQL4Ar4Oj4pNZgNFkxDCKZslr5ZZqaAq2C8stPvrAKefSVhGeWJyQsQhYs/nzLLjuOUwwTeS%2bI2NdIPMA3nMfDe%2bzxeXlQ0i4XCOAH6%2bZgn7XrJBkX7iDETseybMNxLLQgCcKy2DAw1iTvX/Di6kVLPjycVyqTK8oqq5e%2b/RGCPJGangFwCruyexkQjhGgxruoGRtv%2bLNZqbppNE/VNzZ39faBoFSp8wp%2bv97RqVTfLCw5M6RSUwxNudxVVVItambd7jCahlmGHXACHpvMZoPBoNcb9KFdpzcQOPZ1Sjay%2bH3pxcaZmRmfzw%2b7akSz8Pllzya%2bNj6pY1gWECG2jMQCMZxHu5gOeXdyStro7TsQTNaxEzm5kmH1yMHMI9/v%2bQm8P1V8en/G4UPZOVrUKmuQXDv11uVzGXrURDNM1NIhyHwAqMmE2Sw05aCcBOnAzWYTajQuW7Nz4esbcNzBsay8V9Ha1Dgxpln/2RfII881tckgCQA/sbU5GRBnJ4QfulXWUXS6tOZKvdfvKz5TphgYBHn77pRcSWF55YWyispi6VlJYbHZam1paTiT/XFrbTbmYIA1fPkT2DKHKhQF4AH0kxTZ0jWYVXTxuLQm72zdhB7FcGzF%2bpTHlm00mCxej0ehUEz2Nuvu3vlh8yYk4SlZR6cnhKLoGQgrUnDlcIzWYADEA0jgcUSjgR3Id3v8LlhRjYyCPmoyQ368fj/kS9bR7vEFIG9QBF0c52JZoEdUy3CLFgxzsUxFbdumPUeT0k9uTvvtxk2N18OmZkmRx1eeLKsF8LhdzAx2O/vY8ZeWLn/z3Q%2bMZjMYD6MTEqcUwuIJCt6ADG6BDG/gcWhYVVJaXtfQqBkb%2b%2bNK/bWmlgmdzmq3t7a3q0dv9fYPtMu7q2vqxicn6ZCFyAAAQlB2AGhujuFYGiiNGk2Qtr%2bUo2u3Z8p6BoqkpdV1DZcqz7/63pqnl6zIP13hg%2bsPpVTsJxLGsKilQ0DCbGmiJUXFb7yzKv1AhvRsxbc7k5NT9pWfvzAwpPwqaVt3X7%2bksCTpu12p%2b36R9/QBp4nZU%2b9BiCAAQsBgrVZrQI3AYK1WZzSZUBTV6/UkqJMklIqq6pr65rZPtmUiL6%2b7M2lgWCbMk%2bidOGonEr4JfkaRtfXXvtmxG9jc0tZ%2bLDcfyN18XdbV0weyrFP%2ba1bOpxu//DF9/9CwGtIVxgQQghCy2cBXCACIOxsJCgsEnU6HE9DOOKh4M9O%2bg3nnkcTV/cO3ODeHO5zxGhnfm6J27LCCCOUMqhBc%2bYRWJ%2b/p1RlQeAR0DSqH4cp1KDqoVHV290IVBgrxX4ktgxws/NC8LBarzRZsZ1YrL/A7/AoMhIPA6QPHixJXri2/fNU/7YfIxb7NaWRx5pPIMgILYmBCNIVOxxM3yJZgnQ62Pwgj9N4Va/IR7JChMUG8xLwHgzmF0nWbd5woKeOioRGJ1ThjTRaR2RDXNUJEMqGMxrBMxZ/zZlPtysgtyMovTj5wCA4STxNzAvjXMXg%2bE/J9V4YAIAP7c05ebZFlnCg4Wij1%2bX1Ci3zI4/R8lOEvwXRg%2bsipkqJzFzxeT1Lqz5W1DSAIOX9o4/Q8lSGAwN%2bB0ou1h/NLoK/dGp9o7VIwoVFyvuN0JMUfsDL0HHTKqjeaQYaS4Pa4Y47TkbciHmYij39gynylEmpxmPI/73A0WRDJTL0AAAAASUVORK5CYII=' /%3e%3c/svg%3e"},"date":"July 30. 2020","timeToRead":5,"cjkWordCount":3504,"cjkReadTime":16,"description":"折腾博客这么久了，加速博客算是有点经验吧","content":"<div class=\"admonition admonition-note\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div>🍉 同步发布</h5></div><div class=\"admonition-content\"><ul>\n<li><strong>在少数派上阅读本文</strong> — <a href=\"https://sspai.com/post/61820\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">我是如何加速博客的</a></li>\n</ul></div></div>\n<p>谁不想拥有一个超快的博客？<del>我</del>\n这篇文章鸽了好多天了，本来打算 28 号写完的，正好那天下午开始暑假，结果晚上去聚餐了，聚餐结束又大晚上的去爬山了 <del>（真爬山，还有机会）</del>。然后到了 29 号，又花了一个下午和晚上重装系统:confounded:，咕咕咕就到了 30 号。</p>\n<p>不多说了，先来看看我的成果：</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/speed_desktop.png?fmt=webp&#x26;w=1280\" alt=\"speed desktop\"><figcaption>speed desktop</figcaption></figure>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/speed_mobile.png?fmt=webp&#x26;w=1280\" alt=\"speed mobile\"><figcaption>speed mobile</figcaption></figure>\n<p>如果你和我一样，时不时用 PageSpeed Insights 跑跑博客、F12 看看网页加载速度，那么接下来的内容可能会对你有点帮助。</p>\n<p>虽然我这冷淡的博客<strong>什么都不优化就能有九十多分</strong>，但是优化完能明显感觉浏览体验更好了。</p>\n<h2 id=\"服务器--cdn\"><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8--cdn\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>服务器 &#x26; CDN</h2>\n<p>如果你是静态博客，你可以使用自己的服务器或者其他平台提供的静态网站托管，而当你没有备案时，没办法用国内的服务器或者 CDN 服务，速度基本上不来。\n动态博客使用服务器一个道理。</p>\n<p>而备案就见仁见智了，但是必须承认，加速博客的最简单最有效的方法就是备案，然后接入国内 CDN。</p>\n<p>我目前使用的是腾讯云开发中的静态网站托管，之前尝试过 <code>COS + CDN</code> 和 <code>OSS + CDN</code>，但是使用 <code>云储存 + CDN</code> 种方法需要担心的就是流量问题，万一被恶意刷流量，会产生巨额费用，所以防护措施一定要做好。</p>\n<p>现在域名还基本都会配个小绿🔒，但是个别免费 SSL 提供商所提供的服务是真滴慢阿，光 SSL\n连接就去了好几秒，所以选择一个不错的提供商是非常重要的。泛域名证书推荐 Let's Encrypt Authority X3，双域名证书推荐 TrustAsia TLS RSA CA。</p>\n<h2 id=\"访问统计\"><a href=\"#%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>访问统计</h2>\n<p>访问统计分为两种，一种是单纯的 PV UV 统计，比如常见的不蒜子。但是<del>众所周知</del>，不蒜子日常抽风，加载时间动不动就超过 1s，但是我们想要一个超快的博客啊，整个博客的加载时间最好在 2s 以内，被你一个不蒜子占了一半怎么行呢。</p>\n<p>还有一种就是稍微专业一点的，会统计更多的内容，就比如大部分博客使用的百度或 Google 提供的统计，而引入统计的同时会带来一个 js 和一张 gif，还有几个乱七八糟的东西。百度虽然是国内的但百度统计加载还是很慢，基本半秒以内，有时候甚至一秒。而 Google 的在国内有节点，速度其实和百度差不了多少。</p>\n<h3 id=\"leancloud-统计代替不蒜子\"><a href=\"#leancloud-%E7%BB%9F%E8%AE%A1%E4%BB%A3%E6%9B%BF%E4%B8%8D%E8%92%9C%E5%AD%90\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>LeanCloud 统计代替不蒜子</h3>\n<p>对于日常抽风的不蒜子，你完全可以使用 LeanCloud 代替它，原理很简单，就是通过网页加载一段 js，向 LeanCloud 中储存的数据进行修改。但是请注意，该方法速度也不是特别快，但至少比不蒜子的 1s 要强一点，基本能在 0.5s 内完成加载。</p>\n<p>直接在网页中加入以下 js<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup> 即可。并在 LeanCloud 中新建一个应用，获取 <code>app_id</code> <code>app_key</code> <code>server_url</code>，并修改 js 中三者的值。</p>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>server_url 为该应用绑定的 API 域名</p><p>国内版用户必填，国际版用户可不填</p></div></div>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 查询存储的记录</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> target</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'get'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/classes/Counter?where='</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>target<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token arrow operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>results<span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>code <span class=\"token operator\">===</span> <span class=\"token number\">401</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> error<span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>results <span class=\"token operator\">&amp;&amp;</span> results<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> record <span class=\"token operator\">=</span> results<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/classes/Counter'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>target<span class=\"token punctuation\">,</span> time<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token arrow operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record<span class=\"token punctuation\">,</span> error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token keyword\">throw</span> error<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Failed to create'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'LeanCloud Counter Error:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 发起自增请求</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> incrArr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/batch'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"requests\"</span><span class=\"token operator\">:</span> incrArr\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        res <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span><span class=\"token property-access\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">throw</span> res<span class=\"token punctuation\">.</span><span class=\"token property-access\">error</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Failed to save visitor count'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 构建自增请求体</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">objectId</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"PUT\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/1.1/classes/Counter/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> objectId <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"time\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string\">'__op'</span><span class=\"token operator\">:</span> <span class=\"token string\">'Increment'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'amount'</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 校验是否为有效的 UV</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">validUV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> key <span class=\"token operator\">=</span> <span class=\"token string\">'LeanCloud_UV_Flag'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> flag <span class=\"token operator\">=</span> <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 距离标记小于 24 小时则不计为 UV</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">86400000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> enableIncr <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;%= theme.web_analytics.enable %>'</span> <span class=\"token operator\">===</span> <span class=\"token string\">'true'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">hostname</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'localhost'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> getterArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> incrArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 请求 PV 并自增</span>\n    <span class=\"token keyword\">var</span> pvCtn <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-pv-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pvCtn <span class=\"token operator\">||</span> enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> pvGetter <span class=\"token operator\">=</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'site-pv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        incrArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">objectId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">var</span> ele <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-pv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          ele<span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> record<span class=\"token punctuation\">.</span><span class=\"token property-access\">time</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pvCtn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            pvCtn<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">display</span> <span class=\"token operator\">=</span> <span class=\"token string\">'inline'</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      getterArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>pvGetter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 请求 UV 并自增</span>\n    <span class=\"token keyword\">var</span> uvCtn <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-uv-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>uvCtn <span class=\"token operator\">||</span> enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> uvGetter <span class=\"token operator\">=</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'site-uv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> vuv <span class=\"token operator\">=</span> <span class=\"token function\">validUV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        vuv <span class=\"token operator\">&amp;&amp;</span> incrArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">objectId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">var</span> ele <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-uv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          ele<span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> record<span class=\"token punctuation\">.</span><span class=\"token property-access\">time</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>vuv <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>uvCtn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            uvCtn<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">display</span> <span class=\"token operator\">=</span> <span class=\"token string\">'inline'</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      getterArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>uvGetter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 如果是文章，请求文章的浏览数，并自增</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;%= is_post() %>'</span> <span class=\"token operator\">===</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> viewCtn <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-post-views-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>viewCtn <span class=\"token operator\">||</span> enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> target <span class=\"token operator\">=</span> <span class=\"token function\">decodeURI</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;%= url_for(page.path) %>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> viewGetter <span class=\"token operator\">=</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n          incrArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">objectId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>viewCtn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> ele <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-post-views'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              ele<span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">time</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n              viewCtn<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">display</span> <span class=\"token operator\">=</span> <span class=\"token string\">'inline'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        getterArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>viewGetter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 如果启动计数自增，批量发起自增请求</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token known-class-name class-name\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">all</span><span class=\"token punctuation\">(</span>getterArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        incrArr<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> incrArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> app_id <span class=\"token operator\">=</span> <span class=\"token string\">'xxx'</span>\n  <span class=\"token keyword\">var</span> app_key <span class=\"token operator\">=</span> <span class=\"token string\">'xxx'</span>\n  <span class=\"token keyword\">var</span> server_url <span class=\"token operator\">=</span> <span class=\"token string\">'xxx'</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">api_server</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">Counter</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">method<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> data</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> api_server <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/1.1</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> url <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        method<span class=\"token punctuation\">,</span>\n        headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string\">'X-LC-Id'</span><span class=\"token operator\">:</span> app_id<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'X-LC-Key'</span><span class=\"token operator\">:</span> app_key<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        body<span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">var</span> api_server <span class=\"token operator\">=</span> app_id<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'-MdYXbMMI'</span> <span class=\"token operator\">?</span> server_url <span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> app_id<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.api.lncldglobal.com</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>api_server<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span>api_server<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://app-router.leancloud.cn/2/route?appId='</span> <span class=\"token operator\">+</span> app_id<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token arrow operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>api_server<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://'</span> <span class=\"token operator\">+</span> api_server<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"加速-google-analytics\"><a href=\"#%E5%8A%A0%E9%80%9F-google-analytics\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>加速 Google Analytics</h3>\n<p>百度统计没看到过有人弄加速，Google Analytics 的话我目前尝试了两种方法</p>\n<h4 id=\"利用-cloudflare-workers\"><a href=\"#%E5%88%A9%E7%94%A8-cloudflare-workers\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>利用 Cloudflare Workers</h4>\n<p>原理是将一段 js 部署在 Cloudflare Workers，网页向它传输数据，它再异步发给 Google Analytics。详见 <a href=\"https://github.com/SukkaW/cloudflare-workers-async-google-analytics\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@SukkaW/cloudflare-workers-async-google-analytics</a></p>\n<p>但是该方法还是存在一定问题的，Cloudflare 自身的速度 emmm，反向加速的称号可不是吹的，某些地区确实速度非常慢，和原来的 Google Analytics 相比或许会快那么一点点（至少我当时测试的是这样的）</p>\n<h4 id=\"采用-dogedoge-提供的加速\"><a href=\"#%E9%87%87%E7%94%A8-dogedoge-%E6%8F%90%E4%BE%9B%E7%9A%84%E5%8A%A0%E9%80%9F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>采用 DogeDoge 提供的加速</h4>\n<p>这个是我目前使用的方法，非常简单，直接使用以下代码来引入 ga。</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">ga_tid</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Your google_site_id'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> dga <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    dga<span class=\"token punctuation\">.</span><span class=\"token property-access\">src</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://rmt.dogedoge.com/fetch/public/ga.js\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    s<span class=\"token punctuation\">.</span><span class=\"token property-access\">parentNode</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">insertBefore</span><span class=\"token punctuation\">(</span>dga<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>引入的文件总共就 1 kb 多一点点，速度也是杠杠的，基本两个文件各自都能在 100ms 内加载完成，总共也就 200ms，而我测试后发现，大部分时间两个文件总共加载时间都在 100ms 内。</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/ga.png?fmt=webp\" alt=\"ga\"><figcaption>ga</figcaption></figure>\n<p>强烈推荐使用这种方法，速度贼快，还省事。</p>\n<h2 id=\"预加载\"><a href=\"#%E9%A2%84%E5%8A%A0%E8%BD%BD\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>预加载</h2>\n<p>网站第一次加载的等待时间非常重要，但浏览过程中的链接跳转的加载速度同样重要。</p>\n<p>提前加载网页，即通过 js 对当前页面中的本站链接进行预先加载，或是在鼠标悬浮在链接上时，对该链接进行预先加载。</p>\n<p>这里吐槽下，看到过有些博客使用了 pjax 局部刷新，但是博客本身的速度还是非常慢，导致体验极差，所以如果博客本身速度就非常非常慢，使用 pjax 并不会有什么效果。</p>\n<p>目前我尝试过的共有 4 种方案</p>\n<ul>\n<li>instantclick</li>\n<li><a href=\"https://github.com/GoogleChromeLabs/quicklink\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">quicklink</a></li>\n<li><a href=\"https://github.com/instantpage/instant.page\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">instant.page</a></li>\n<li><a href=\"https://github.com/gijo-varghese/flying-pages\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">flying-pages</a></li>\n</ul>\n<p>首先建议排除 instantclick，配置非常麻烦，需要考虑很多 js 问题，而且项目本身已经没有人维护了（应该是的，上一次更新是几年前的事了）</p>\n<h3 id=\"quicklink\"><a href=\"#quicklink\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>quicklink</h3>\n<p>由 Google 的团队开发，通过脚本检测当前可视区域内的链接，进行预加载。\n比如下方图片中共包含 6 个本站链接，本页面所有内容加载完成后，就会对这 6 个链接预先加载，在本地留下缓存，使得点击跳转的后的加载速度变快。因为它会加载当前可视区的所有链接，所以对服务器的负担会比较重。</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/quicklink.png?fmt=webp&#x26;w=1280\" alt=\"quicklink\"><figcaption>quicklink</figcaption></figure>\n<p>他采用的预加载是在 <code>&#x3C;head></code> 中引入 <code>&#x3C;link></code></p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>prefetch<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>xxx<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>使用方法很简单</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/quicklink@2.0.0/dist/quicklink.umd.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n......\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">quicklink<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>更多的用法请查看该项目的 <a href=\"https://github.com/GoogleChromeLabs/quicklink\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub 仓库</a></p>\n<h3 id=\"instantpage\"><a href=\"#instantpage\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>instant.page</h3>\n<p>刚刚的 quicklink 是直接预加载，而这个则是鼠标悬浮在链接上时才对该链接预加载，这无疑极大的减轻了服务器的负担，是个非常好的选择。</p>\n<p>只需要加入以下代码就可以使用了</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>//instant.page/5.1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">integrity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>预加载的方式和 quicklink 一样，也是引入 <code>&#x3C;link></code>。</p>\n<p>貌似它没有更多用法了。</p>\n<h3 id=\"flying-pages\"><a href=\"#flying-pages\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Flying Pages</h3>\n<p>这个也就是我目前在使用的了。同时具有 quicklink 和 instant.page 的功能，能直接预加载可视区域内的链接，还能预加载鼠标悬浮的链接（前一个未生效的情况下），并且能自动检测服务器状态，如果服务器繁忙则不进行预加载。同时还能修改 4 个参数的值。</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\"><span class=\"token maybe-class-name\">FPConfig</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    delay<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 浏览器空闲多少秒后开始预加载</span>\n    ignoreKeywords<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 不进行预加载的链接，例 [\"#\", \"/about\"]</span>\n    maxRPS<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 每秒最大加载数</span>\n    hoverDelay<span class=\"token operator\">:</span> <span class=\"token number\">50</span>    <span class=\"token comment\">// 鼠标悬浮后预加的延迟，毫秒单位</span>\n    <span class=\"token comment\">// 上方数值未默认值</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">defer</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"总结\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>总结</h3>\n<table>\n<thead>\n<tr>\n<th align=\"center\">插件</th>\n<th align=\"center\">Quicklink</th>\n<th align=\"center\">Instant.page</th>\n<th align=\"center\">Flying Pages</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">预加载的内容</td>\n<td align=\"center\">当前可视区域内的链接</td>\n<td align=\"center\">鼠标悬浮的链接</td>\n<td align=\"center\">可视区域 + 鼠标悬浮</td>\n</tr>\n<tr>\n<td align=\"center\">大小</td>\n<td align=\"center\">1.5 KB</td>\n<td align=\"center\">1.3 KB</td>\n<td align=\"center\">1.5 KB</td>\n</tr>\n<tr>\n<td align=\"center\">支持 Safari</td>\n<td align=\"center\">✅</td>\n<td align=\"center\">❌</td>\n<td align=\"center\">✅</td>\n</tr>\n<tr>\n<td align=\"center\">判断服务器状态</td>\n<td align=\"center\">❌</td>\n<td align=\"center\">❌</td>\n<td align=\"center\">✅</td>\n</tr>\n</tbody>\n</table>\n<p>大致的一些差异就在这里，怎么选择看你自己需求。</p>\n<h2 id=\"静态文件\"><a href=\"#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>静态文件</h2>\n<h3 id=\"图片\"><a href=\"#%E5%9B%BE%E7%89%87\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>图片</h3>\n<p>图片是一个网站浏览的大头，之前也有写过一篇文章『<a href=\"/posts/12013.html\">加速网页加载？我选择对图片下手</a>』，通过使用 WebP 来减少网站加载流量，提供网站速度。</p>\n<p>今年 WWDC 上 Safari 的更新也支持了 WebP，终于，我们不再需要为 Safair 不支持 WebP 而对它特殊照顾了。但是我个人还是习惯保留 PNG or JPG 原图，所以我选择了 <a href=\"https://v2ex.com/t/659652#reply43\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DogeDoge 提供的图床服务</a>，支持智能 WebP（浏览器支持 WebP 则返回 WebP 格式，不知此则返回原图）。还有件值得提的事情，不单单又拍云，最近腾讯数据万象也支持了智能 WebP。</p>\n<p>当然，如果你这在使用的图床服务并不支持该功能，或者并没有使用图床，但仍然想得当相同的体验，『<a href=\"https://blog.ichr.me/post/webp-on-hexo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebP 图片优化在 Hexo 上的最佳尝试</a>』 这篇文章中的方法或许是目前最佳的方式。</p>\n<p>此外，图片懒加载是个非常有效的方式，用几 kb 的 js 延迟图片加载，博客的首次加载速度能得到非常大的提升。</p>\n<h3 id=\"减少文件\"><a href=\"#%E5%87%8F%E5%B0%91%E6%96%87%E4%BB%B6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>减少文件</h3>\n<p>这是博客，初衷是写文章，输出内容。当然，美化博客是件很重要的事情，但过度的美化会适得其反，真正重要的是内容，只有内容好了，看的人才会多。不过话说回来，每个 Blogger 应该都有一个折腾的过程：<code>简单 -> 花里胡哨 -> 简单</code>，<del>起点就是终点</del>。现在我的博客能有 99 分，最大的原因就是这个主题，简约而不简陋，除去字体文件，首页加载的文件不超过 10 个。</p>\n<p>既让讲到了字体就谈谈吧，这个算是见仁见智了，有的人认为字体非常重要，直接决定了博客的观感，而有的人觉得无关紧要。我属于前者，所以字体文件在我的博客中算是流量大户了，毕竟我引入了整整三个字体，其中还包括一个中文字体，中文字体的体积可想而知。英文字体：Roboto Slab，中文：思源宋体，代码：Fira Code。两个英文字体的体积还算可以，但中文的体积真的有点大，如果你爱折腾可以试试<a href=\"https://www.font-spider.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">字蛛</a>。</p>\n<h3 id=\"文件压缩\"><a href=\"#%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>文件压缩</h3>\n<p>目前我是用的文件压缩插件是 <a href=\"https://github.com/chenzhutian/hexo-all-minifier\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">hexo-all-minifier</a>，但是并没有开启 <code>image_minifier</code>，图片压缩速度慢而且我没有把图片和博文放在一起的习惯。总体效果不错，体积能减少 20% 左右。</p>\n<p>而对于图片，我使用的是<a href=\"https://zhitu.isux.us/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">智图</a>进行压缩，虽然这个软件已经很久没更新了，但是完全够用</p>\n<h3 id=\"尽量统一外链\"><a href=\"#%E5%B0%BD%E9%87%8F%E7%BB%9F%E4%B8%80%E5%A4%96%E9%93%BE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>尽量统一外链</h3>\n<p>这里指的外链是文件外链，加载不同域的文件需要不同的 SSL 连接时间。比如你的一个 js 来自 <code>jsdelivr.net</code>，另一个来自 <code>staticfile.org</code>，那么你就需要两次 SSL 连接，而如果你的两个文件全部来自 <code>jsdelivr.net</code> 那你将只需要一次 SSL 连接。</p>\n<h2 id=\"后\"><a href=\"#%E5%90%8E\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>后</h2>\n<p>以上就是我的一点小优化，其实也没什么东西，还说不定有什么错的地方，不过对于不怎么会代码的人或许还有点用，毕竟这些基本不涉及什么非常复杂深奥的东西。</p>\n<p>V2EX 上曾有一句话 『像你这样不分享教程的人有什么资格看不起我们这些小白？』，所以，希望大佬们在做一些事情之后能分享下相关教程，当然啦，全凭意愿 :blossom:</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>来自 <a href=\"https://github.com/fluid-dev/hexo-theme-fluid/blob/master/layout/_partial/plugins/leancloud.ejs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fluid</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"P3372 【模板】线段树 2","path":"/posts/segment-tree-2/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/segment-tree-2.a209973.44b9c73f3c5e45e18396aad67df0daee.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/segment-tree-2.a67b0b2.44b9c73f3c5e45e18396aad67df0daee.png 480w","/assets/static/segment-tree-2.a209973.44b9c73f3c5e45e18396aad67df0daee.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-c451b7c7732bb0c21cda54e66b9af20d'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-c451b7c7732bb0c21cda54e66b9af20d)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAYAAAA9djs/AAAACXBIWXMAAAsSAAALEgHS3X78AAAHC0lEQVRYw81YeVRU5xWHLNVo1RIlhhQXFiHELufY42lP4klNVRiDYtucpKnGU6CnrWnSGmAGZmBgiGlSqjYS4l6lTaJEBVxGGfZV9m1mYFhc2qNxC1ECDMM67/5uvzfDIObkv9DT%2beOe%2b7133vfeu7/v97v3fp9HomkIwniKnyazIdFog0YeG78ynvCayXuDSBBjtRhrzCOsMQ1zonkYavOIPE9cD2Fy3vTYZMwe0wmAZuInNV8JOMk4KAfpCuQ%2bIMJSRMDRNbelVSW37EnN/bSj/g6pzKMo1alo/5kKUnYyJ7VaHwTPHQHQOANyvEfdOgiNMJkF8o8rTYR40zhPWc1JBshz48WzscJSGu9RcusAfXCqhLqf80br9s2UYLEj0QGgbTpB%2bJ8A4HiHCJxTuiROtow57iWYxlBdpaIjjQWkNIMFGyaBcQGXJLx24lrZQbDEbKYRhQ/3hfvhUHYRqTrFvNYBTErhm4MwvQBoXHoWq5jcMc5bP66l1/UWqAR9c%2bsOERs80JO/krSOIIYfkMCkZATNlR3gA/qLdGN9AHoigmELXYjjB/9F2y8xNC226WTBtAPgXMm2EVbW3SOvkHD84LW/0O7uz6kvNxh8bh5TwXzsa6wRLBCaNlqdq%2bl6hzy31cqxXYyiPTulSy/44npECD5fuxjlaW9QR91Wer9FAGqSHAzSuKEEoG6xIvUy86/2F9GsYAXmhsZhZ%2bFZic8txHjuQnDBI1xTGUexZhZJ0TrJApfJiS6uizkr8xiNKnww9PMA1K5ZjjtbloBzPbgiL4o05vEHkqi7SYC17aP44W/ekQHgGSuisDdTKXG5F8YLFggAZvOd4p%2bQ1tj3gAymACD0D9Qmb6fRdd7o3RSEwY3%2bsEYEYuDwk3zz7GLsarlMzmQ66ATCrQAQXiQzPBP1Ls14egPPCQpH46HF4NK5PG7wBp%2bYhaslGyjBNDpR24dZ1Hm5X5Al4Rjrmnpx9bVVdCnUH70bA2F5MRgDoYEYTf0uuGIujtQXUtzXSej/CYArASaJAFQNvQhYHYWZ/uH8fFgoJMPjPJa3AFL%2bApDeC9a8JUhrueooidrmL/FO5XWKbxqDqA5QdgLphhayRvijUxGMprAQdAkA7ikC8YXaTzDoYa4v2yYDcF9CbsMAuYaL0heZ1UQrwqLJ99k/UEbqOnDet/FZli/qDi1D5f6n0Z/zHWQ3HKPtbcxpF/9DH5WU2s%2bWHLGXl2mpukIlHftnltQX%2bhT6Be3vbBDU3%2bSPgbAA2HSL0PbRk3zt9HJ6z3QTgkXuA4C8%2bnICfPsK84vvnqQ5S1fjsZBXEfPbFeASL3CxF3LeC0LuzhBwkSfKy9WkamP8SSQ9haFQSqvOk6oqdFJrcbS0q7Bdur0xCP0b/IT2A9An7EbYMtiil6I325svHV%2bC9JY2kqvBRB6A2wCQ2k38yuEymvPjX8NzaQTv1XwPXDVP6H8%2bc6kX8wWRCE/Mhr52H71lZCw6ZSGPj7t4ln4IB5sqJUPTLulAbh39W%2bGHhrBnMChW/7ZgQdm65bj7i0CMHPdGzxkf8Ww1KU1w5QG3YQDvuMpYm5QJz2XhvGDly9x%2bdJHQ7XyMnX4CkvDDn/iCTz6K5loVFDV2mrmngB49YYHn0Tboik7YS427pAt/%2bzuNPjcDNYrvo1dQf2CTkIIiCPdeCIQ1fRFG9N/C%2bao9FCMYpDUOsNswwFECLWPYmJZNvj%2bNpId%2bFIn0PweBDY8Bn8wR3c3jzIWzmQ0P8/XyX9Kamn565INS%2bGzbCQ/lKWzNz7bX1unsB4%2bXUFlKHH3xUjCsb/iRbf0iDPz%2bKSDZF/YDXriSE0B7mkyiFNrdSwITGyAWbTDeLLhCM98vl57dkUFN1bHSNf3PaDTLB9fPraHqqhjabbpJKws%2bI4%2bjZn7ozUx4vF3EWwpy7Y0Xk6Q/ik5Q0zqC0/rDEufPw60Pn6d/nDspqeNXYe%2bnqXTAYqF448hED2BzDwlMtsKuXZ5gwsycyxRy5hppRA%2bfnltNX66fTyf3H3X09Mnimch6G606XyutLc8n/%2bI%2biivOsTfUq6XYVoJSVIjMRgNxtgebG1%2bnyNJB8lz2EsL21UIrOk0538jf%2boZ7gumXwMQZgMO/cvEu/a6mh9TdzPtySqhn9ROkz0int0QAov5zYgdDl5EhnYnxo5c3b6PoLa/Sh3%2bNkpRNQ1DJANRfoHHDQqm2NFZSNtsQ/Wk9xVbegLbNxTibe/UB98FwsiC1bZhTzMMyKzi5uQ%2b7SzsptaEHGrOzBRYemspbSNB3k%2b6CiXTnzUgsvkZTd3s6411oTf3in4ZZJ3oMeaOlmXKa5JYHIg4v5wPXVtcR0DDHt9udba8zQOfBSfsoJ3XaWdMhOSxRPj9wHZUJrzY5j8YcVUY%2bYJm6dZ7G3eB/AVzPem40h5axAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"date":"July 11. 2020","timeToRead":4,"cjkWordCount":1127,"cjkReadTime":5,"description":"","content":"<p><sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h2 id=\"题目描述\"><a href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目描述</h2>\n<p>如题，已知一个数列，你需要进行下面三种操作：</p>\n<ul>\n<li>将某区间每一个数乘上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span></li>\n<li>将某区间每一个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span></li>\n<li>求出某区间每一个数的和</li>\n</ul>\n<h2 id=\"输入格式\"><a href=\"#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入格式</h2>\n<p>第一行包含三个整数 n,m,p，分别表示该数列数字的个数、操作的总个数和模数。</p>\n<p>第二行包含 n 个用空格分隔的整数，其中第 i 个数字表示数列第 i 项的初始值。</p>\n<p>接下来 m 行每行包含若干个整数，表示一个操作，具体如下：</p>\n<p>操作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>： 格式：<code>1 x y k</code> 含义：将区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[x,y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> 内每个数乘上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span></p>\n<p>操作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span>： 格式：<code>2 x y k</code> 含义：将区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[x,y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> 内每个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span></p>\n<p>操作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span></span></span></span>： 格式：<code>3 x y</code> 含义：输出区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[x,y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> 内每个数的和对 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">p</span></span></span></span> 取模所得的结果</p>\n<h2 id=\"输出格式\"><a href=\"#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输出格式</h2>\n<p>输出包含若干行整数，即为所有操作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span></span></span></span> 的结果。</p>\n<h2 id=\"输入输出样例\"><a href=\"#%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%A0%B7%E4%BE%8B\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入输出样例</h2>\n<p><strong>输入 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">5 5 38\n1 5 4 2 3\n2 1 4 1\n3 2 5\n1 2 4 2\n2 3 5 5\n3 1 4<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>输出 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">17\n2<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<h2 id=\"说明提示\"><a href=\"#%E8%AF%B4%E6%98%8E%E6%8F%90%E7%A4%BA\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>说明/提示</h2>\n<p>【数据范围】</p>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>30</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">30\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">n \\le 8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">8</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>≤</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">m \\le 10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span>\n对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>70</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">70\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">n \\le 10^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">m \\le 10^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>\n对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">n \\le 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">m \\le 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>除样例外，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><mn>571373</mn></mrow><annotation encoding=\"application/x-tex\">p = 571373</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">p</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">3</span></span></span></span></p>\n<p>（数据已经过加强^_^）</p>\n<p>样例说明：</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/SegmentTree2/01.jpg?fmt=webp\" alt=\"img\"><figcaption>img</figcaption></figure>\n<p>故输出应为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>17</mn></mrow><annotation encoding=\"application/x-tex\">17</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">7</span></span></span></span>、<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>22</mn><mtext>（</mtext><mn>40</mn><mtext> </mtext><mo lspace=\"0.22em\" rspace=\"0.22em\"><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow></mo><mtext> </mtext><mn>38</mn><mo>=</mo><mn>2</mn><mtext>）</mtext></mrow><annotation encoding=\"application/x-tex\">22（ 40 \\bmod 38 = 2 ）</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">2</span><span class=\"mord cjk_fallback\">（</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mspace\" style=\"margin-right:0.05555555555555555em;\"></span><span class=\"mbin\"><span class=\"mord\"><span class=\"mord mathrm\">m</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">d</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mspace\" style=\"margin-right:0.05555555555555555em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord cjk_fallback\">）</span></span></span></span></p>\n<h2 id=\"所以\"><a href=\"#%E6%89%80%E4%BB%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>所以</h2>\n<p>真的有那么亿点点难理解，也还不怎么会，学的时候主要是看 <a href=\"https://oi-wiki.org/ds/seg/#luogu-p3373-2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">线段树 - OI Wiki</a> 的代码 和 <a href=\"https://www.luogu.com.cn/blog/lhr/solution-p3373\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">题解 P3373 【【模板】线段树 2】 - lqhsr 的博客</a> 的思路</p>\n<p>一个讲的挺明白的，一个代码看着挺明白的 :trophy:</p>\n<h3 id=\"结构体函数\"><a href=\"#%E7%BB%93%E6%9E%84%E4%BD%93%E5%87%BD%E6%95%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>结构体函数</h3>\n<p>之前学结构体的时候知道里面可以定义函数，也只是知道，从来没用过。\n这题因为经常要 <code>mod</code>，配合结构体函数还是挺方便的。</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">Test</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> test1<span class=\"token punctuation\">,</span> test2<span class=\"token punctuation\">,</span> test3<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        test1 <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n        test2 <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n        test3 <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>test<span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\ntest<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"懒标记下传\"><a href=\"#%E6%87%92%E6%A0%87%E8%AE%B0%E4%B8%8B%E4%BC%A0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>懒标记下传</h3>\n<p>和线段树 1 比，多了一个乘法，所以多了乘法懒标记，<strong>初值为 1</strong>。\n乘法懒标记下传时需要对 <code>加法懒标记</code>、<code>乘法懒标记</code>和<code>值</code> 进行乘法。\n区间乘法也同样的需要对这三个值进行乘法。\n其他的基本和线段树 1 一样。</p>\n<p>懒标记下传的代码确实挺长的，但理清思路发现还是比较好理解的。</p>\n<ol>\n<li>乘法懒标记不为 1，则需要下传。\n分左右儿子，每边先把所有的乘法做好，再 <code>.mod()</code>\n<strong>最后父亲乘法懒标记赋值为 1</strong></li>\n<li>加法懒标记不为 0，则需要下传。也分左右儿子\n儿子懒标记加上父亲懒标记\n儿子值加上 （父亲懒标记 * 儿子所办含的节点数）\n再 <code>.mod()</code>\n<strong>最后父亲懒标记归零</strong></li>\n</ol>\n<h3 id=\"区间修改\"><a href=\"#%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>区间修改</h3>\n<p>整体思路和线段树 1 的一样，乘法的区间修改唯一的区别就在最后一步</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">*=</span> c<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*=</span> c<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">*=</span> c<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"完整代码\"><a href=\"#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>完整代码</h3>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;cstdio></span></span>\n\n<span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> n<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> at<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">node</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        w <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n        f <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n        m <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>tree<span class=\"token punctuation\">[</span><span class=\"token number\">400010</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">bool</span> flag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">char</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>ch<span class=\"token operator\">&lt;</span><span class=\"token string\">'0'</span> <span class=\"token operator\">||</span> ch<span class=\"token operator\">></span><span class=\"token string\">'9'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>ch <span class=\"token operator\">==</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">)</span> flag <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>ch<span class=\"token operator\">>=</span><span class=\"token string\">'0'</span> <span class=\"token operator\">&amp;&amp;</span> ch <span class=\"token operator\">&lt;=</span> <span class=\"token string\">'9'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>x <span class=\"token operator\">*=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> x <span class=\"token operator\">+=</span> ch <span class=\"token operator\">-</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> flag <span class=\"token operator\">?</span> <span class=\"token operator\">-</span> x <span class=\"token operator\">:</span> x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> l<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> r<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">=</span> l<span class=\"token punctuation\">,</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">=</span> r<span class=\"token punctuation\">,</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">==</span> r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>mid<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> lson <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> k<span class=\"token punctuation\">,</span> rson <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> k <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> m <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m<span class=\"token punctuation\">,</span> f <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">!=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">*=</span> m<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*=</span> m<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">*=</span> m<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">*=</span> m<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*=</span> m<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">*=</span> m<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> f<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> f <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">-</span> tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>lson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> f<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> f <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">-</span> tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>rson<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">cheng</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> l<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> r<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> k<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> c<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>m <span class=\"token operator\">*=</span> c<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*=</span> c<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">*=</span> c<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">cheng</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">>=</span> mid <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token function\">cheng</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> l<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> r<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> k<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> at<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> at<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> at <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>t <span class=\"token operator\">-</span> s <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">,</span> at<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">>=</span> mid <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> at<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">mod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> l<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> r<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">,</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span> mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> sum <span class=\"token operator\">+=</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    sum <span class=\"token operator\">%=</span> p<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">>=</span> mid <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> sum <span class=\"token operator\">+=</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> sum <span class=\"token operator\">%</span> p<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    n <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> m <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> p <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>m<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        d <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> x <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            c <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">cheng</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            at <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> at<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%lld\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>🚨 注意 %}</h5></div><div class=\"admonition-content\"><p>mod 别忘了</p><p>add 要 return\ncheng 要 return\nbuild 要 return</p><p>get 要 down(k)\nadd 要 down(k)\ncheng 要 down(k)</p><p>要不然就会这样，一个月了才过（虽然前面有 AC 一次）</p><figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/SegmentTree2/02.png?fmt=webp\" alt=\"warnning\"><figcaption>warnning</figcaption></figure></div></div>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-0\">\n<p>Banner from <a href=\"https://icons8.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Icons8</a></p>\n<a href=\"#fnref-0\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-1\">\n<p>题目来源 <a href=\"https://www.luogu.com.cn/problem/P3373\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">【模板】线段树 2 - 洛谷</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"利用 GitHub Action 实现自动化","path":"/posts/use-github-action/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/use-github-action.a209973.7eac810ebb843f63471550bc5b62c4f5.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/use-github-action.a67b0b2.7eac810ebb843f63471550bc5b62c4f5.png 480w","/assets/static/use-github-action.a209973.7eac810ebb843f63471550bc5b62c4f5.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-f934b4fdc4f8203dcdc412be48c6d547'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-f934b4fdc4f8203dcdc412be48c6d547)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAGYElEQVRIx41XWW8TVxT2H6j6WlSpj5UqdZeqLkhV1VaqaKs%2b5aEPLaqE%2blJ4ACq6qFDoQ1tQQW0oWVkSQkICISEBmkASZyFxFkJMQuLE8Ronju1gezzjZWZsz8zpuePx%2bM7YBKyrq5t7z9xzvrPdLxZWhIRABqcu2OLMFnfIn/q%2bOrRNo4y%2bk%2bApeUpG%2b1CEx2nU79cueTqNFk1r8ZgtmmsAIFY2qLCmv9JMEanbRE1eN9d0G0tdJUgQz0AsA7wEySww22tU77Ho6Glns5Qm%2bhQ/ZgSDHeViBWUMX1mG9jftnaQIYQ5mfdB6F9rGyQL/5NSj7TUWI0BZYIiDaIakay15RaTCLZqjYYqqvihojPNkIFoUbhmD5hEYWiSjaZggwSA8QSNJoTJlNAxzWIQKMnRy62KFWHFGYAnKF7jGVNlKQVyAZA4cm8T6pQ3gsgTSQgAujoJ7C9I5qn4qabQUAsQVj7UEEMwpQZcyXZSmEkyUVRFD6aZvwyyPJBWcV/2hJbf3%2bix02DBtJEcgwgp5BIaJ1D0Dgkzis41GC1OWGzinsuSzVLbkRYYvNAeF4RVWUFRhba1ajDtKEYCiO4kjHyp0tylAwtywrUL7pGJ1wMScc3R6dtoDV6bA4U9VfbKrvql1i4fWMWnKDXy%2bZIOpGRQB8CXf606aDcINB/gZVZovuVAEyEiQygGXUxd5MqOJ6TxZ4wLDmpbwdoVDGKJCJEkeF%2bBpIHFzJQSXx8G%2bEuiZyT0IAP4QUt0A9NuV4SOHhrruDDmh7raMuZQsphzDl1zAUhlhMaUKztEMtNrh73GwrUFOVluEVkyydXzmgcPj24wFtjj7kmvJ7Xe4A1mABad3xbshKgSD0x9KCBKXlSIJ3hdi/KFYMitjVjB8jsuS0GXysLwJHZPwYNnbeCf7bx/0z8N9n7Lgz9cNw5%2bn7N8fdx/tgcV1hS48U/LoXc5iOsCBdTMXhNMT0LkAUwHoc8LMuiwDDIxN91vHRybvX%2broxtHe2VvT2NzcdnVu0XW2ue1Mw4Vlb3CLEw8c%2bnlxda1v6O75lo62zp5%2b60Rv//B/g2MXWq9M2xcFAlJGN42tQOc9qPoLvvgDPj4G356RMA6Ng/lXDsA7%2b7lz10J5ACaj0NaX49EAmHoFpn4kBb3LUDcFnQ%2bhZhIGXbICYLu/2NLehYbWNFzo7Olrv9bbeqX73MXLaP2Jk//Unm22TswMT8yerK6paWxChN03b6NMdU1jw/lLeHqqurbtag%2bGK56RMKQRlg9EmAP1zBt7o%2b8djL%2b7b8M2MHnrRPWn%2bz179tncfbcyBIBseJSEYv8tdh2OBqB3jEIWDbqgYx7GvDC/CctbBBWm8sNV/%2bpa2LPxyB3Ycq2F1h8x/s34sifoWossuddjaQmzi0mnvcEoJtJamMHZF4y61yP%2bUNzp28R9NZtJzSx5Q%2b3XbzZ1DVdfsp1unTjXda%2b2of3Ij79W7T75zdf1I%2bNekUAti4BY1oXoBlcAgOmFHtrgYMBFqnnlEfji6sPOQ0YmxZpUSzYlkf6NFYmLtDrwhiRp2zKeoolY6GlVpjCn1OpPaBWpYCiWPL4Iw4H6uz08%2btmXX735wUcvvvX%2bjpffvj4wikkbS8s6vyo9TaLWEgtHFrb8nVMHWsypm3q5JNQ2qrfLhNpVOHUmCngzJWG09qp7S9E6XiEIEsw5PJ5gPKE%2bZFW79zzz3I6Xdla9tuun1z///ZeGVXwKTHzOxIWol1ioQMjMT7dQmTlWJnMm/mfiI6ojsP/aHV5/mEHreQX2Hjr87PMvHPyt3uqEG3Z5YEFmeeUJGktdyITSyCXpV9bETw3GGVkQU05AxJIjNADLXl%2bYwU38/XD02Ks7P7wxshiIK/6YHGTVfOOfrNGir7hyMicYWZpYgf1XIHMUiTBfVXKnkpZJCuFDgaWCFPq7wy1/1naPzoedodxKGLzRQjmVnq3HabSYOIYJMVOR5BlhmP9nMD6LJO%2bNZBvLhuNzAj5nLt9mJIpv5Zhtdv/B49a7DuuMOxzL%2bCL59WguLeY4Pq8Rk8drrEzmKtIv1rhTLNMKOxXJHPXeY%2blLSV7iMrkUn0sJuUxWCsdiMS4d4wTcZNN5NpNP8nkUK7SBbTRamKLddHUbKl0o8VOumEhMJWZaItVGysUZI8OUOYsQxzxhTTgSdBU9hcb/Afrv4b4qLUNrAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"date":"July 5. 2020","timeToRead":4,"cjkWordCount":2414,"cjkReadTime":11,"description":"博客部署？我用 GitHub Action 自动部署<br>百度收录推送？我也用 GitHub Action 自动推送","content":"<h2 id=\"前言\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>前言</h2>\n<p>首先，为什么选择静态网站？没后台，没数据库，但是方便折腾，可以完全自定义，这是我选择静态博客最大的原因之一。 <del>（其实没钱买服务器才是最大原因）</del></p>\n<p>部署静态网站的方法很多，GitHub Page, Coding Page, Gitee Page, Vercel 都是免费的，各有各的优势，先说说这几个免费的。</p>\n<h3 id=\"github-page\"><a href=\"#github-page\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>GitHub Page</h3>\n<p>Github Page 巨硬家的东西，除非不可抗力，要不然出问题的概率很小。但国内部分地区无法访问，部分地区访问速度慢。能利用 Github Action 实现自动化部署。速度问题或许可以通过 CloudFlare 的 CDN 来解决，但速度还是不怎么样。当然，如果你域名备案了，用国内的 CDN 也是没问题的。</p>\n<h3 id=\"coding-page\"><a href=\"#coding-page\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Coding Page</h3>\n<p>Coding Page 表明是 Coding 的，但 Coding 现在算是腾讯的了，出问题的概率也很小。但用的节点全是境外的，一般是香港和新加坡.....，而且日常宕机，动不动就崩了。同样能利用 集成CI 进行自动部署。</p>\n<h3 id=\"gitee-page\"><a href=\"#gitee-page\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Gitee Page</h3>\n<p>Gitee Page 码云家的，国内节点，速度没得说，快就完事了。自定义域名和自动更新（也就是说每次更新博客，推送到码云之后还要手动点击部署）需要购买 Pro 版，99 元/年。但因为是国内节点的原因，绑定的域名需要备案。码云还有个比较好的功能，能自动判断博客类型，支持 Jekyll、Hugo、Hexo，能自动进行编译，并部署生成的文件，也就是说你可以直接将整个博客文件夹推上去，每次更新只需要使用 git 推送下就行了，它会帮你生成。</p>\n<h3 id=\"vercel\"><a href=\"#vercel\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Vercel</h3>\n<p>Vercel 可以直接从 GitHub 导入博客仓库，且能识别静态博客类型，和码云一样自动生成。顺便看了下 Vercel 分配的节点，美国的，但是国内访问速度还是不错的，Ping 了一下，平均 62.0ms，速度也还不错（至少我这是这样）。</p>\n<h3 id=\"总结\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>总结</h3>\n<ul>\n<li>不要求自定义域名，无脑上码云</li>\n<li>要自定义域名上 GitHub Page or Vercel</li>\n<li>Coding 不推荐</li>\n</ul>\n<p>那么本博客目前并没有采用上述方式进行部署，但全部体验过。因为域名进行了备案，就直接采用了腾讯的<strong>静态网站托管</strong>。</p>\n<p>有一说一，国内各家的 CDN 计费规则是真的复杂，第一次看完基本都一头雾水，这时候腾讯的云开发出现了。云开发中包含了静态网站托管，专为静态网站而生。计费规则很简单，<code>流量费用</code> + <code>空间费用</code>，而且自动部署到 CDN 上，速度超快。</p>\n<p>至于怎么使用云开发部署静态博客，官方已经给出了详细教程 <a href=\"https://cloud.tencent.com/document/product/1210/43365\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">静态网站托管 搭建 Hexo - 最佳实践 - 文档中心 - 腾讯云</a>。</p>\n<p>当然，这是收费的，不过挺便宜的，正常小站一个月不超过一元，而且还可以申请腾讯的 <a href=\"https://cloud.tencent.com/act/pro/wh99\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">云开发网站托管「9.9包年」赞助计划</a>。</p>\n<h2 id=\"自动部署\"><a href=\"#%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>自动部署</h2>\n<p>接下来进入重点，利用 GitHub Action 实现自动化部署，如果你还不知道 GitHub Action 是什么，可以看看 <a href=\"https://github.com/features/actions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官方介绍</a>，简单来说，以你的仓库为根目录，给你一台电脑，帮你完成一些事情。如果想进一步了解，可以看看 <a href=\"https://zkqiang.cn/posts/e8ed6836/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">编写自己的 GitHub Action，体验自动化部署</a></p>\n<h3 id=\"连接-github\"><a href=\"#%E8%BF%9E%E6%8E%A5-github\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>连接 GitHub</h3>\n<p>保证你的整个博客文件夹已 <code>push</code> 到了GitHub 上。如果没有，新建一个仓库 <code>Public</code> or <code>Private</code>  均可，然后将本地本地与仓库连接。</p>\n<p><code>username</code> 替换成用户名，<code>repo</code> 替换成仓库名</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">git</span> init\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> commit -m <span class=\"token string\">\"first commit\"</span>\n<span class=\"token function\">git</span> remote <span class=\"token function\">add</span> origin https://github.com/username/repo.git\n<span class=\"token function\">git</span> push -u origin master<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>🚨 注意</h5></div><div class=\"admonition-content\"><p>如果仓库为 <code>Public</code> 请不要将隐私内容直接写在文件中，暂时用一些单词替换，后续编写自动部署文件时有方法解决</p></div></div>\n<h3 id=\"编写-github-action\"><a href=\"#%E7%BC%96%E5%86%99-github-action\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>编写 GitHub Action</h3>\n<p>从这里开始，默认你已经看完之前提到的『编写自己的 GitHub Action，体验自动化部署』，或者对 GitHub Action 有初步的了解，知道大致操作。</p>\n<p>以我的<a href=\"https://JalenChuh.cn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">个人主页</a>为例，是由 Vue.js 构建的，部署在腾讯云静态网站托管。GitHub 仓库地址：<a href=\"https://github.com/jalenchuh/homepage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">homepage</a></p>\n<p>共分为 <code>Setup</code> <code>Build</code> <code>Lint</code> <code>Deploy</code> 四个步骤</p>\n<ul>\n<li>Setup: 安装 node 环境</li>\n<li>Build: 构建</li>\n<li>Lint: Lint 代码</li>\n<li>Deploy: 推送到腾讯静态网站托管</li>\n</ul>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v1\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'10.x'</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Lint\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run lint\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy\n      <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> deployStatic\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> TencentCloudBase/cloudbase<span class=\"token punctuation\">-</span>action@v1.1.1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">secretId</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SECRET_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">secretKey</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SECRET_KEY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">envId</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ENV_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">staticSrcPath</span><span class=\"token punctuation\">:</span> dist<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>对于隐私数据须在 secrets 中设置</h5></div><div class=\"admonition-content\"><p>文件中出现的 <code>secrets.xxx</code> 须在仓库的 <code>settings > secrets</code> 中设置</p><p>新建 <code>secrests</code> 时，<code>name</code> 为 <code>xxx</code> ，<code>Value</code> 为内容</p></div></div>\n<h3 id=\"部署到-github-page\"><a href=\"#%E9%83%A8%E7%BD%B2%E5%88%B0-github-page\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>部署到 GitHub Page</h3>\n<p><sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy                      <span class=\"token comment\"># Actions 显示的名字，随意设置</span>\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>                        <span class=\"token comment\"># 监听到 push 事件后触发</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout              <span class=\"token comment\"># 拉取当前执行 Actions 仓库的指定分支</span>\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">ref</span><span class=\"token punctuation\">:</span> master\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Update Submodule      <span class=\"token comment\"># 如果仓库有 submodule，在这里更新，没有则删掉此步骤</span>\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        git submodule init\n        git submodule update --remote</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Node            <span class=\"token comment\"># 安装 Node 环境</span>\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10.x\"</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Hexo Generate         <span class=\"token comment\"># 安装 Hexo 依赖并且生成静态文件</span>\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        rm -f .yarnclean\n        yarn --frozen-lockfile --ignore-engines --ignore-optional --non-interactive --silent --ignore-scripts --production=false\n        rm -rf ./public\n        yarn run hexo clean\n        yarn run hexo generate</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Hexo Deploy           <span class=\"token comment\"># 部署步骤，这里以 hexo deploy 为例</span>\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">SSH_PRIVATE</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SSH_PRIVATE <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">GIT_NAME</span><span class=\"token punctuation\">:</span> yourname\n        <span class=\"token key atrule\">GIT_EMAIL</span><span class=\"token punctuation\">:</span> your@email.com\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        mkdir -p ~/.ssh/\n        echo \"$SSH_PRIVATE\" | tr -d '\\r' > ~/.ssh/id_rsa\n        chmod 600 ~/.ssh/id_rsa\n        ssh-keyscan github.com >> ~/.ssh/known_hosts\n        git config --global user.name \"$GIT_NAME\"\n        git config --global user.email \"$GIT_EMAIL\"\n        yarn run hexo deploy</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"部署到腾讯静态托管\"><a href=\"#%E9%83%A8%E7%BD%B2%E5%88%B0%E8%85%BE%E8%AE%AF%E9%9D%99%E6%80%81%E6%89%98%E7%AE%A1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>部署到腾讯静态托管</h3>\n<p>建议使用<a href=\"https://github.com/TencentCloudBase/cloudbase-action\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官方 Action</a></p>\n<p>示例代码</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'10.x'</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Hexo\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        npm install hexo-cli -g\n        npm install</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Generate\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> hexo clean <span class=\"token important\">&amp;&amp;</span> hexo g\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy\n      <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> deployStatic\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> TencentCloudBase/cloudbase<span class=\"token punctuation\">-</span>action@v1.1.1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">secretId</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SECRET_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">secretKey</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SECRET_KEY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">envId</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ENV_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">staticSrcPath</span><span class=\"token punctuation\">:</span> public<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>部署 Hexo 的过程中，<code>Deploy</code> 之前的都是差不多，所有之后只需要修改 <code>Deploy</code> 之后的内容就行。</p>\n<h3 id=\"部署到-腾讯cos\"><a href=\"#%E9%83%A8%E7%BD%B2%E5%88%B0-%E8%85%BE%E8%AE%AFcos\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>部署到 腾讯COS</h3>\n<p>建议使用<a href=\"https://github.com/zkqiang/tencent-cos-action\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">zkqiang/tencent-cos-action</a></p>\n<h3 id=\"其他\"><a href=\"#%E5%85%B6%E4%BB%96\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>其他</h3>\n<p>大部分都是有官方 Action 的，即使没有也会有其他人编写的，或参考官方文档。</p>\n<h2 id=\"隐私问题\"><a href=\"#%E9%9A%90%E7%A7%81%E9%97%AE%E9%A2%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>隐私问题</h2>\n<p>可以直接使用 Private 仓库解决。</p>\n<p>对于 Publlic 仓库，可以使用 <code>sed</code> 命令。</p>\n<p>比如我在博客配置 <code>_config.yml</code> 文件中有百度推送的代码</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">baidu_url_submit</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">count</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span>\n  <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> blog.JalenChuh.cn\n  <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> baiduToken\n  <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> baidu_urls.txt<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>其中 <code>token</code> 属于隐私内容，不能公开，那么我们可以使用 <code>baiduToken</code> 将 <code>token</code> 代替</p>\n<p>而之后在编写的 Action 的时候将 <code>token</code> 存入 <code>secrets</code> ，利用 <code>sed</code> 命令对 <code>baiduToken</code> 进行替换即可。</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sed</span> -i <span class=\"token string\">\"s/baiduToken/<span class=\"token variable\">${baiduToken}</span>/\"</span> _config.yml<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p><code>sed -i</code> 用法为 <code>sed -i 's/原字符串/新字符串/' 文件路径</code></p>\n<p>结合 <code>secrets</code> 使用</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> env\n  <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">baiduToken</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.baiduToken <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sed <span class=\"token punctuation\">-</span>i \"s/baiduToken/$<span class=\"token punctuation\">{</span>baiduToken<span class=\"token punctuation\">}</span>/\" _config.yml<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"自动提交百度收录\"><a href=\"#%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E7%99%BE%E5%BA%A6%E6%94%B6%E5%BD%95\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>自动提交百度收录</h2>\n<p>解决了这个问题我们就可以进行一些更好玩的了，比如百度自动推送</p>\n<p>首先确保安装了 <code>hexo-baidu-url-submit</code>，并且 <code>package.json</code> 的 <code>dependencies</code> 中含有该插件。</p>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p><code>package.json</code> 中如果没有，必须使用 <code>npm i hexo-baidu-url-submit --save</code> 安装</p></div></div>\n<p>然后还是该文件，修改 <code>scripts</code> 部分</p>\n<pre class=\"language-diff line-numbers\"><code class=\"language-diff\">\"scripts\": {\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> .......\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> \"xx\": \"xxxx\",\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">  \"baidupush\": \"hexo deploy\"\n</span></span>},<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>必须遵循 json 规范</h5></div><div class=\"admonition-content\"><p>最后一行，也就是 <code>baidupush</code> 这行结尾没有逗号，而倒数第二行必须有逗号</p></div></div>\n<p>百度给了几千条的限额，你可以通过 <code>hexo deploy &#x26;&#x26; hexo deploy ...</code> 执行多次，把全部额度用完，但貌似一个链接重复提交会被百度降权（不懂 SEO），所以看你自己了。</p>\n<p>但是还有一个问题，如果你使用的是 GitHub Page 之类的，每次推送的同时都会把博客也推送一遍，没这必要，那么我们可以新建一个配置文件 <code>_baidupush.yml</code> ，将 <code>_config.yml</code> 中我内容复制进去，再修改末尾 <code>deploy</code> 部分，仅保留百度推送。</p>\n<pre class=\"language-diff line-numbers\"><code class=\"language-diff\">deploy:\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> - type: baidu_url_submitter\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">  - type: git\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">    repo: git@github.com:jalenchuh/test.git\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">    branch: master</span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>那么之前命令中的所有 <code>hexo deploy</code> 就需要相应的替换成 <code>hexo deploy --config _baidupush.yml</code></p>\n<p>然后在 <code>secrets</code>  中存入 <code>baiduToken</code></p>\n<p>并编写 Action，每天北京时间 0 点自动执行</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> baiduPush\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 16 * * *'</span> <span class=\"token comment\"># Github Action 使用的是 UTC 时间</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'10.x'</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Hexo\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        npm install hexo-cli -g\n        npm install</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> BAIDU env\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">baiduToken</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.baiduToken <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> sed <span class=\"token punctuation\">-</span>i \"s/baiduToken/$<span class=\"token punctuation\">{</span>baiduToken<span class=\"token punctuation\">}</span>/\" _baidupush.yml <span class=\"token comment\"># 替换 baiduToken</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> generate\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> hexo clean <span class=\"token important\">&amp;&amp;</span> hexo g\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> push\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run baidupush <span class=\"token comment\"># 执行前面写好的命令</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"最后\"><a href=\"#%E6%9C%80%E5%90%8E\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>最后</h2>\n<p>著名的 CI 工具还有 Travis CI，相比之下我觉得 GitHub Action 更加容易上手，而且和 GitHub 直接集成算是它的一大优势吧。</p>\n<p>不过还是有一些缺点的，比如没办法本地调试，第一次使用 Action 列表中总是一片 :x:。还有就是出错之后 <code>re run</code> 只能全部重来，没办法指定从某一个 steps 开始</p>\n<p>当然了，已经做的非常不错了。同时，期待下即将推出的 Codespaces。</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>GitHub Page 部署代码来自 <a href=\"https://hexo.fluid-dev.com/posts/actions-deploy/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://hexo.fluid-dev.com/posts/actions-deploy/</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"P3372 【模板】线段树 1","path":"/posts/segment-tree-1/","cover_image":null,"date":"June 5. 2020","timeToRead":5,"cjkWordCount":1678,"cjkReadTime":8,"description":"","content":"<h2 id=\"题目\"><a href=\"#%E9%A2%98%E7%9B%AE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目</h2>\n<p><sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h3 id=\"题目描述\"><a href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目描述</h3>\n<p>如题，已知一个数列，你需要进行下面两种操作：</p>\n<ol>\n<li>将某区间每一个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span>。</li>\n<li>求出某区间每一个数的和。</li>\n</ol>\n<h3 id=\"输入格式\"><a href=\"#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入格式</h3>\n<p>第一行包含两个整数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n, m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span>，分别表示该数列数字的个数和操作的总个数。</p>\n<p>第二行包含 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span> 个用空格分隔的整数，其中第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 个数字表示数列第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 项的初始值。</p>\n<p>接下来 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span> 行每行包含 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span></span></span></span> 或 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span></span></span></span> 个整数，表示一个操作，具体如下：</p>\n<ol>\n<li><code>1 x y k</code>：将区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[x, y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> 内每个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span>。</li>\n<li><code>2 x y</code>：输出区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[x,y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> 内每个数的和。</li>\n</ol>\n<h3 id=\"输出格式\"><a href=\"#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输出格式</h3>\n<p>输出包含若干行整数，即为所有操作 2 的结果。</p>\n<h3 id=\"输入输出样例\"><a href=\"#%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%A0%B7%E4%BE%8B\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入输出样例</h3>\n<p><strong>输入 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">5 5\n1 5 4 2 3\n2 2 4\n1 2 3 2\n2 3 4\n1 1 5 1\n2 1 4<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>输出 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">11\n8\n20<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"说明提示\"><a href=\"#%E8%AF%B4%E6%98%8E%E6%8F%90%E7%A4%BA\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>说明/提示</h3>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>30</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">30\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">n \\le 8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">8</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>≤</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">m \\le 10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span>。<br>\n对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>70</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">70\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">n \\le {10}^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.848448em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.848448em;\"><span style=\"top:-3.09734em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>≤</mo><msup><mn>10</mn><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">m \\le {10}^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.848448em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.848448em;\"><span style=\"top:-3.09734em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>。<br>\n对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le n, m \\le {10}^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304100000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.848448em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.848448em;\"><span style=\"top:-3.09734em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>。</p>\n<p>保证任意时刻数列中任意元素的和在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><msup><mn>2</mn><mn>63</mn></msup><mo separator=\"true\">,</mo><msup><mn>2</mn><mn>63</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[-2^{63}, 2^{63})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">6</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">6</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 内。</p>\n<p><strong>【样例解释】</strong></p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/2024/01.png?fmt=webp\" alt=\"样例解释\"><figcaption>样例解释</figcaption></figure>\n<h2 id=\"题解\"><a href=\"#%E9%A2%98%E8%A7%A3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题解</h2>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>想认真学推荐看看这篇两篇</p><p><a href=\"https://www.cnblogs.com/TheRoadToTheGold/p/6254255.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">浅谈线段树 - TRTTG - 博客园</a>\n<a href=\"https://oi-wiki.org/ds/seg/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">线段树 - OI Wiki</a></p></div></div>\n<h3 id=\"建树\"><a href=\"#%E5%BB%BA%E6%A0%91\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>建树</h3>\n<p>一直二分，直到 到了叶子节点，输入数据，==记住 return==</p>\n<p>非叶子节点的值为 左儿子+右儿子</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token comment\">// 建树，k 当前节点</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>LL l<span class=\"token punctuation\">,</span> LL r<span class=\"token punctuation\">,</span> LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">=</span> l<span class=\"token punctuation\">,</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">==</span> r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 判断叶子节点</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>mid<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"懒标记\"><a href=\"#%E6%87%92%E6%A0%87%E8%AE%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>懒标记</h3>\n<blockquote>\n<p>A 有两个儿子，一个是 B，一个是 C。</p>\n<p>有一天 A 要建一个新房子，没钱。刚好过年嘛，有人要给 B 和 C 红包，两个红包的钱数相同都是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 元，然而因为 A 是父亲所以红包肯定是先塞给 A 咯~</p>\n<p>理论上来讲 A 应该把两个红包分别给 B 和 C，但是……缺钱嘛，A 就把红包偷偷收到自己口袋里了。</p>\n<p>A 高兴地说：「我现在有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span> 份红包了！我又多了 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>1</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2 \\times 1 = 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span> 元了！哈哈哈~」</p>\n<p>但是 A 知道，如果他不把红包给 B 和 C，那 B 和 C 肯定会不爽然后导致家庭矛盾最后崩溃，所以 A 对儿子 B 和 C 说：「我欠你们每人 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 份 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 元的红包，下次有新红包给过来的时候再给你们！这里我先做下记录……嗯……我欠你们各 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 元……」</p>\n<p>儿子 B、C 有点恼怒：「可是如果有同学问起我们我们收到了多少红包咋办？你把我们的红包都收了，我们还怎么装？」</p>\n<p>父亲 A 赶忙说：「有同学问起来我就会给你们的！我欠条都写好了不会不算话的！」</p>\n<p>这样 B、C 才放了心。<sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup></p>\n</blockquote>\n<p>举个例子：</p>\n<p>要求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>∽</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">4 \\backsim 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel amsrm\">∽</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span></span></span></span> 的数都加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span></p>\n<p>那么我们现在只需要将其父亲节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span></span></span></span> 的懒标记 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">+2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">+</span><span class=\"mord\">2</span></span></span></span></p>\n<p>需要用到的时候将懒标记下传给子节点</p>\n<p>下传操作：</p>\n<ol>\n<li>两个子节点的懒标记分别加上父亲节点的懒标记的值</li>\n<li>子节点的值分别加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mtext>父亲节点的懒标记值</mtext></mrow><annotation encoding=\"application/x-tex\">(r-l+1) \\times 父亲节点的懒标记值</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">父</span><span class=\"mord cjk_fallback\">亲</span><span class=\"mord cjk_fallback\">节</span><span class=\"mord cjk_fallback\">点</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">懒</span><span class=\"mord cjk_fallback\">标</span><span class=\"mord cjk_fallback\">记</span><span class=\"mord cjk_fallback\">值</span></span></span></span>。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r-l+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 表示该节点之下还有多少节点，这里必须乘父亲节的懒标记的值，而不是自己的懒标记，因为自身的懒标记可能还包含上一次下传的值</li>\n<li>父亲节点懒标记归零</li>\n</ol>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token comment\">// 懒标记下传，k 当前节点</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    tree<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">;</span>\n\n    tree<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">-</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">-</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"区间修改\"><a href=\"#%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>区间修改</h3>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">n = [l, r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 需要修改的区间，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">m = [s, t]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">]</span></span></span></span> 当前区间</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n, m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span> 只满足以下三种关系的一种</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>⊆</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m \\subseteq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>∩</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m \\cap n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.55556em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span> 不为空</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>⊆</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n \\subseteq m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span></li>\n</ol>\n<h4 id=\"1\"><a href=\"#1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>1</h4>\n<p>第一种情况 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>⊆</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m \\subseteq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span>，直接返回当前区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span> 的值就行了</p>\n<h4 id=\"2\"><a href=\"#2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>2</h4>\n<p>第二种情况 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>∩</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m \\cap n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.55556em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span> 不为空</p>\n<p>令 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>=</mo><mfrac><mrow><mi>s</mi><mo>+</mo><mi>t</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">mid= \\frac{s+t}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.169556em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824556em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">s</span><span class=\"mbin mtight\">+</span><span class=\"mord mathdefault mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo>≤</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">l \\le mid</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83041em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">d</span></span></span></span> 则说明待修改区间（一部分）在当前节点的左孩子</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>&gt;</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">r &gt; mid</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">d</span></span></span></span> 则说明待修改区间（一部分）在当前节点的右孩子</li>\n</ol>\n<p>重复多次后就得到了情况 1\n（画个图模拟下就明白了）</p>\n<h4 id=\"3\"><a href=\"#3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>3</h4>\n<p>第三种情况 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>⊆</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n \\subseteq m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span></p>\n<p>解决方法和情况 2 相同</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token comment\">// 区间修改 [l, r] 修改区间，[s, t]当前区间，k 当前节点，addition 修改的值</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>LL l<span class=\"token punctuation\">,</span> LL r<span class=\"token punctuation\">,</span> LL k<span class=\"token punctuation\">,</span> LL addition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> addition<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> addition <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>t <span class=\"token operator\">-</span> s <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 不满足上面的 if，所以需要修改子节点，所以需要下传懒标记</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">)</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> addition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>r <span class=\"token operator\">></span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> addition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"区间查询\"><a href=\"#%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>区间查询</h3>\n<p>与区间修改基本一样</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">n = [l, r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> 需要查询的区间，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">m = [s, t]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">]</span></span></span></span> 当前区间</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n, m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span> 只满足以下三种关系的一种</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>⊆</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m \\subseteq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>∩</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m \\cap n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.55556em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span> 不为空</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>⊆</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n \\subseteq m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span></li>\n</ol>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token comment\">// 区间查询，[l, r] 查询区间，[s, t]当前区间，k 当前节点</span>\nLL <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>LL l<span class=\"token punctuation\">,</span> LL r<span class=\"token punctuation\">,</span> LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 不满足上面的 if，所以需要修改子节点，所以需要下传懒标记</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">)</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> sum <span class=\"token operator\">+=</span> <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>r <span class=\"token operator\">></span> mid<span class=\"token punctuation\">)</span> sum <span class=\"token operator\">+=</span> <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"代码\"><a href=\"#%E4%BB%A3%E7%A0%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>代码</h3>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;cstdio></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token expression\">LL <span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span></span></span>\n\nLL n<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">node</span> <span class=\"token punctuation\">{</span>\n    LL l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">;</span> <span class=\"token comment\">// w 值，f 懒标记</span>\n<span class=\"token punctuation\">}</span>tree<span class=\"token punctuation\">[</span><span class=\"token number\">400001</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 大小 4 * n</span>\n\nLL <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">bool</span> flag <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> LL x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">char</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>ch<span class=\"token operator\">&lt;</span><span class=\"token string\">'0'</span> <span class=\"token operator\">||</span> ch<span class=\"token operator\">></span><span class=\"token string\">'9'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ch <span class=\"token operator\">==</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">)</span> flag <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>ch<span class=\"token operator\">>=</span><span class=\"token string\">'0'</span> <span class=\"token operator\">&amp;&amp;</span> ch <span class=\"token operator\">&lt;=</span> <span class=\"token string\">'9'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>x <span class=\"token operator\">*=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> x <span class=\"token operator\">+=</span> ch <span class=\"token operator\">-</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> flag <span class=\"token operator\">?</span> <span class=\"token operator\">-</span> x <span class=\"token operator\">:</span> x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 建树，k 当前节点</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>LL l<span class=\"token punctuation\">,</span> LL r<span class=\"token punctuation\">,</span> LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">=</span> l<span class=\"token punctuation\">,</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">==</span> r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 判断叶子节点</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>mid<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 懒标记下传，k 当前节点</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    tree<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">-</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r <span class=\"token operator\">-</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 单点修改，k 当前节点</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>LL k<span class=\"token punctuation\">,</span> LL addition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL l <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> r <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">==</span> r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> addition<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 不满足上面的 if，所以需要修改子节点，所以需要下传懒标记</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">)</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 单点查询，k 当前节点</span>\nLL <span class=\"token function\">ask</span><span class=\"token punctuation\">(</span>LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL l <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> r <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 不满足上面的 if，所以需要修改子节点，所以需要下传懒标记</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">==</span> r<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> ask<span class=\"token punctuation\">[</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token function\">ask</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 区间修改 [l, r] 修改区间，[s, t]当前区间，k 当前节点，addition 修改的值</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>LL l<span class=\"token punctuation\">,</span> LL r<span class=\"token punctuation\">,</span> LL k<span class=\"token punctuation\">,</span> LL addition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f <span class=\"token operator\">+=</span> addition<span class=\"token punctuation\">;</span>\n        tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+=</span> addition <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>t <span class=\"token operator\">-</span> s <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 不满足上面的 if，所以需要修改子节点，所以需要下传懒标记</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">)</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> addition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>r <span class=\"token operator\">></span> mid<span class=\"token punctuation\">)</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> addition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w <span class=\"token operator\">+</span> tree<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 区间查询，[l, r] 查询区间，[s, t]当前区间，k 当前节点</span>\nLL <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>LL l<span class=\"token punctuation\">,</span> LL r<span class=\"token punctuation\">,</span> LL k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    LL s <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">,</span> t <span class=\"token operator\">=</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n    LL mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">+</span> t<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 不满足上面的 if，所以需要修改子节点，所以需要下传懒标记</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l<span class=\"token operator\">&lt;=</span>s <span class=\"token operator\">&amp;&amp;</span> t<span class=\"token operator\">&lt;=</span>r<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">)</span> <span class=\"token function\">down</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> mid<span class=\"token punctuation\">)</span> sum <span class=\"token operator\">+=</span> <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> k<span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>r <span class=\"token operator\">></span> mid<span class=\"token punctuation\">)</span> sum <span class=\"token operator\">+=</span> <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">*</span>k<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    n <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> m <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>m<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        LL t <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> x <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>t <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%lld\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getsum</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            LL k <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>学完可以做做 <a href=\"https://www.luogu.com.cn/problem/P2068\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">P2068 统计和</a></p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>题目来源 <a href=\"https://www.luogu.com.cn/problem/P3372\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">【模板】线段树 1 - 洛谷</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p>来自 <a href=\"https://oi-wiki.org/ds/seg/#_4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">线段树 - OI Wiki</a></p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"HandShaker 好看实用的手机管理工具","path":"/posts/handshaker/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/handshaker.a209973.23dc6fce51d8f4fa7e32a5e2329f0b0c.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/handshaker.a67b0b2.23dc6fce51d8f4fa7e32a5e2329f0b0c.png 480w","/assets/static/handshaker.a209973.23dc6fce51d8f4fa7e32a5e2329f0b0c.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6076a53b0ad3f53786526e943c31377f'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6076a53b0ad3f53786526e943c31377f)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAGJklEQVRIx81WaVBTVxTOj/5wnP7rz/7pL51x2lGrttraTTqOWh07VUbHFlF0VAq4T7WtWlDckVYF2RdZE9l3CKtAWGUxISQBXkKWl7e/vJc9EEhPEmmtpoozrThz580995573znnnu87R2AkzUbKbCR8g5wbr11ESTNGW1jeZeKnWH4Kp63zPCtYEHOfFlGChwEWa/RUfUtXbWNHbVOnCjFilA3FX35W8GSDWKDY%2b1YIxsaap2vEHau/%2bPrLb7796MsgYUmF3e5GCRP6sqsEC2s9hJA2ua7E34u%2beE0mV4dFnjr5a8zh07EVzTKlbgoxgDKvx7gXXCVYyLwneCNpoWlubdDGqAP7px0ujLZitPNMrudg4mzwDU%2bsECBhM1s9kGA%2b5QBXCV74D/4pkf/PnTHgPGOytD62Lfnku6CQmC6Vh2Y4LcpH57sikqd33ZxJqZ%2bRy1V30/OVCEoArF8RxBaccqAk5zWdMBOUw%2b8PivP%2bp38%2bnKhPExSezP8J0%2bd/BBgFB9rrVBvPcmuPW0UlCMVwqC9wGGlG9LyBcRJSad71y0MKDcXYAyZhYBBjpEWP0wrtMEFN46TLSDoU%2bmHUt06bnARjJ012A855bcV574SAX1oo1knQNppzwoBHN8ztgohRlmf0fT%2byQHSsvZ2hN%2bxbomcVQqFOJidMDgwiRVnhCM7aMQSzqfTeaJLWgFgNBGJvzEwk7W6T328cjehCjldLw7vHqhl2FtHi7d1DI6pJSZ/MZJ6iWQfDOYG8Gd4FJAhbMsVkm2SgrWtQrtKazNNAL5zV3dTeN2mggd0ZzqsJB3HK6nsrjuBcKknPmq/2rNp8eAIxGnGLxmjWoBZCrbew9oTUjM%2b2HVi//cTG4BCtkQWX5jx/IYhRb6pYjCQTV7c%2bvvEtie79mApBgngXY5oaUxvTckRND3tzhOXwbW7va2jtKiypGVFqswvLEtPz8h5UllSJiyvF8Ynp/cNKML25ox8Uiioa%2boYUZTXNwPFF5fXSUTX4psdMNOfq7BlasmLV0pUryxsfRYs8pzPdkcmucrHag2pFWaLlO%2b%2bFhYRdOHZUPYlhgWAQAMQQfpqe6VZV7csSnC1ZfLfj7RPCRaHpixS6Ea2eu5WYlpVfkpotvJ2cBVYmZean5z64nZKdnluUVVDS0tGfdl%2bUK6rIyCtOySpMzRFe%2byMpKbPg9PlLZbXNP8dcA7U7KdlalPGBmIOE7B1QLPv483eXfpCRX3au0LMnzh183XNLpHPY2IFB6bL1Wzdv3oRKZYzJATmJzQfE8LI0M9Mprz%2bY%2bc7e1MXfJy/em7boSOZ78skRZJIurwWKniyqbCgoroa4VtS1VNW3Vda3QdRFZXWNbT0Vda2lNY2wUlLVKCytLSytLa1ugkeAKgsv0NEzDDf4MY16WcjZ1Sdb8emGpR%2buORGdlCL2nMkwX34wezUfjxPhkTcHl2//ffmOFHGvjjb5CjMxPxD7xXGdflA12K/sHhp7jOiNAFPMS02ATo5gbZTJAWkAqAW8kjBhbCRjhzlkKmzBFxYp1gGL3i3WDpokbffeMNfngAMAjPoWyYatO3aGHDz%2bSyzJueWqiW6FI/j6zLozntVH2XVn3dsuuXoGJyjG5iXAV6rEOGWjaBfFTJGME%2bZ/Q5yco0s/pZK8d0BQcR9j%2bkSfwlMcCgefEQlvCnGWacBMcOihsIiTsXF3TBa3RjOeXDe7IhwNOufacqxm25HkTbtPXbxyE6Os/mtfrRKjTzDN/x%2bV2OeAGxLsh0NRu8PCiysbCNah0SCXRe6jqc79d2Z/yxhXqxHpqKa9RwHEGtAMwUL1EX4HgGrrmyWh4VF7DoQrJ1ADxinHtRGpnsKHzvSG6X3xjB63aTF%2bUG4welOAf7PaaS8GOFdX/0joj%2bfPX0kkfcTaNzwWFa%2bUIlbphG3fhbZRhNXjfL8MapkNI%2bYP4tflDAAamO2nyKs5BWIDxmoMdK6wvKy4VEe4DIQ1ISGpVSJXG5je4UmMglaCR9%2b0dtoIxRVji0orWyWPRsf0UL/lKh2iJSHewPq9Q8oBGQLVXYXgvuLNv1nt9F%2bDs8z42ydoOUnaRszZCnRM%2bpmasvzbVX8C6k7rzdadJngAAAAASUVORK5CYII=' /%3e%3c/svg%3e"},"date":"April 26. 2020","timeToRead":1,"cjkWordCount":1761,"cjkReadTime":8,"description":"不夸张的说，我认为这或许是最好的非系统的安卓手机管理工具，好看的 UI、舒适的体验，至少我目前还没有找到一个既免费又有与之相同体验的软件","content":"<p>经常为了手机电脑间传文件烦恼，想着什么时候在 Windows 和 Android 之间能有 iCloud 的体验 <del>（我知道我在想:peach:）</del>。或许 OneDrive 能实现类似体验，但是我这同步文件的速度并不是很理想，手机端传一个文件上去，电脑端要过一段时间才能同步出来，那我还不如用 QQ 传文件</p>\n<p>在网上:surfer:时，看到了别人推荐这款软件，就下下来试了试，没报太大希望，但是用了一段时间，真的超 nice 啊</p>\n<h3 id=\"简介\"><a href=\"#%E7%AE%80%E4%BB%8B\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>简介</h3>\n<p>HandShaker<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup> 是一款轻便易用的 Android 手机管理工具，融合了 Mac 系统和 Smartisan OS 的界面风格和操作逻辑，可直观、简洁的帮助用户管理 Android 手机中的照片、视频、音乐等文件。<sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup></p>\n<p>HandShaker，<strong>握手</strong>？那咱<strong>交个朋友</strong>？还是熟悉的锤子风格啊</p>\n<h3 id=\"特性\"><a href=\"#%E7%89%B9%E6%80%A7\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>特性</h3>\n<ul>\n<li>支持<strong>无线</strong>链接</li>\n<li>可同步全部文件（双端完全同步）</li>\n<li><strong>支持拖拽操作</strong></li>\n<li>支持文件预览</li>\n<li>闪念胶囊</li>\n</ul>\n<p>不夸张的说，我认为这或许是最好的<strong>非系统的</strong>安卓手机管理工具，全平台通用，不限制机型（就我目前发现的软件而言）</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/01.png?w=1280&#x26;fmt=webp\" alt=\"HandShaker\"><figcaption>HandShaker</figcaption></figure>\n<p>UI 还是锤子的一贯风格\n看惯了 Material Design，再看看锤子的扁平感觉也挺不错的:laughing:</p>\n<p>虽然:hammer:现在一言难尽，但是它出的软件可以说大部分都是精品，甚至你可以看到许多非数码圈的人在用锤子便签</p>\n<h4 id=\"无线链接\"><a href=\"#%E6%97%A0%E7%BA%BF%E9%93%BE%E6%8E%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>无线链接</h4>\n<p>连接速度还不错的，也非常方便，第一次连接好像要在手机上同意\n<del>我第一次连的时候狂点连接，半点反应都没有，都想卸载了，然后发现是自己 zz 了</del></p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/02.gif?w=1280\" alt=\"无线链接\"><figcaption>无线链接</figcaption></figure>\n<p>还可通过二维码和 USB 数据线连接</p>\n<h4 id=\"文件同步\"><a href=\"#%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>文件同步</h4>\n<p>不仅能同步全部文件，还能将相册、音乐、视频和下载进行单独分类</p>\n<p>相册页面还能按照手机上的不同相册来显示</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/03.png?w=1280&#x26;fmt=webp\" alt=\"文件同步\"><figcaption>文件同步</figcaption></figure>\n<p>同时，如果开启完全同步，还可将相册保存在本地，即使与手机断开连接，也能操作</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/04.png?w=1280&#x26;fmt=webp\" alt=\"完全同步\"><figcaption>完全同步</figcaption></figure>\n<p>但这里的相册有个小问题，<strong>相机相册</strong>中的照片并不是系统相机而是<strong>谷歌相机</strong>，这就有的迷了，不知道是不是只有 Flyme 这样</p>\n<p>其他页面也感觉非常 nice</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/05.png?w=1280&#x26;fmt=webp\" alt=\"音乐界面\"><figcaption>音乐界面</figcaption></figure>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/06.png?w=1280&#x26;fmt=webp\" alt=\"视频界面\"><figcaption>视频界面</figcaption></figure>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/07.png?w=1280&#x26;fmt=webp\" alt=\"下载界面\"><figcaption>下载界面</figcaption></figure>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/08.png?w=1280&#x26;fmt=webp\" alt=\"文件页面\"><figcaption>文件页面</figcaption></figure>\n<p>文件页面的图标能看得出非常用心</p>\n<h4 id=\"拖拽操作\"><a href=\"#%E6%8B%96%E6%8B%BD%E6%93%8D%E4%BD%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>拖拽操作</h4>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/09.gif?w=1280\" alt=\"拖拽操作\"><figcaption>拖拽操作</figcaption></figure>\n<p>支持全类型文件双向拖拽，速度非常快，比传文件的那些软件方便多了</p>\n<p>挑了个视频文件测试，文件过大时提示 ”当前传输文件过大，建议通过 USB 数据线传输“，还是非常细心啊，并且你也可以不接受建议 :joy:</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/10.png?w=1280&#x26;fmt=webp\" alt=\"提示\"><figcaption>提示</figcaption></figure>\n<p>但是无线传输的速度还是同不错的，能达到将近 10MB/S</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/11.png?w=1280&#x26;fmt=webp\" alt=\"无线传输\"><figcaption>无线传输</figcaption></figure>\n<p>而 USB 传输的速度能达到将近 20MB/S</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/12.png?w=1280&#x26;fmt=webp\" alt=\"USB 传输\"><figcaption>USB 传输</figcaption></figure>\n<p>基本满足了传输需求，比 OneDrive 的玄学速度好太多了</p>\n<h4 id=\"文件预览\"><a href=\"#%E6%96%87%E4%BB%B6%E9%A2%84%E8%A7%88\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>文件预览</h4>\n<p>文件预览在我这有点玄学，是我的食用方法不对？和拖拽一样传文件到本地，但是速度只有 2MB/s 左右，偶尔能跑的和之前一样的 8MB/s</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/13.png?w=1280&#x26;fmt=webp\" alt=\"文件预览\"><figcaption>文件预览</figcaption></figure>\n<p>所以用来预览大文件不太方便，不过图片什么的还是非常方便的，图片的预览会先跳出略缩图，再加载清楚</p>\n<p>还内置了音乐播放器，可以直接播放音乐，不过功能比较简陋</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/14.png?w=1280&#x26;fmt=webp\" alt=\"音乐播放器\"><figcaption>音乐播放器</figcaption></figure>\n<h4 id=\"闪念胶囊\"><a href=\"#%E9%97%AA%E5%BF%B5%E8%83%B6%E5%9B%8A\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>闪念胶囊</h4>\n<p>真的超级超级 nice 啊，非常好用，之前一直在用微软的 ToDo，手机上可以同步，UI 也做的挺不错的</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/15.png?w=1280&#x26;fmt=webp\" alt=\"闪念胶囊\"><figcaption>闪念胶囊</figcaption></figure>\n<p>不过最近已经开始用闪念胶囊了，至于原因，<del>我自己可能也说不出来</del>，总之，感觉用着更舒服一点吧，虽然这是锤子手机内置的功能，其他手机用不了。但是认真想想，在手机上记录的 ToDo 可能更多是一些零碎的小事情，需要马上去做，记下来只是怕忘了，用负一屏自带的备忘录就可以了，而在电脑上记录的可能则是一些任务规划。</p>\n<p>一开始我并不觉得 ToDo 这种东西有用，但是用了一段时间发现还真有用 :joy_cat:，看到那一项一项就贼想把它打勾</p>\n<p>虽然说不出什么原因让我换到了闪念胶囊，但是可能就是体验和 UI 吧，还是开头那句话，看惯了现有的设计，再看看锤子的扁平感觉也挺不错的 :laughing:</p>\n<p>同样的，也支持一些拖拽，操作很方便</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/16.gif?w=1280\" alt=\"闪念胶囊拖拽\"><figcaption>闪念胶囊拖拽</figcaption></figure>\n<p>还能对每个胶囊添加附件，同样可以拖拽\n但是对于附件有一些小限制，一个胶囊最多添加 14 个附件</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/17.gif?w=1280\" alt=\"闪念胶囊附件\"><figcaption>闪念胶囊附件</figcaption></figure>\n<p>当然了，ToDo 必备的日期肯定也是有的</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/17291/18.png?w=1280&#x26;fmt=webp\" alt=\"闪念胶囊日期\"><figcaption>闪念胶囊日期</figcaption></figure>\n<h3 id=\"最后\"><a href=\"#%E6%9C%80%E5%90%8E\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>最后</h3>\n<p>知乎上一篇写的挺好的文章，某人在评论区撒野，最后真相：没用过，<strong>纯</strong>云体验，但想到前段时间发布的网民收入数据，害，只要自己用着开心就好:stuck_out_tongue_winking_eye:</p>\n<p>那么，关于 HandShaker，还有些没提到的地方，就自己探索啦\n虽然已经停更了，但还是感谢锤科:smiley_cat:</p>\n<p><del>OK 各位，这就是这篇文章的全部内容了，非常感谢你能看到这里，如果你觉得这篇文章写的还不错的话，求赞求收藏求硬币求转发，最重要的是点一个大大的关注</del></p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>下载地址 <a href=\"https://www.smartisan.com/apps/#/handshaker\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Smartisan 应用下载-锤子商城</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p>参考 <a href=\"http://www.cnmo.com/news/551241.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">体验至上 SmartFinder 更名为 HandShaker</a></p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"加速网页加载？我选择对图片下手","path":"/posts/use-webp/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/use-webp.a209973.0bea90b5c8b5792e8f8a6dfadb3be513.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/use-webp.a67b0b2.0bea90b5c8b5792e8f8a6dfadb3be513.png 480w","/assets/static/use-webp.a209973.0bea90b5c8b5792e8f8a6dfadb3be513.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-f4b0b250abf456871f1e90458daf2038'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-f4b0b250abf456871f1e90458daf2038)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAFXklEQVRIx9VX/09TVxT3T1iyH5dlyZIl20%2bLURedIgOVxBnJlpiYbBOoThTYps6JqHNIC0jAWUotli8KodQAm1jELzBxIrTF0gKuLRbo9/b1%2b%2bv3V2op792d5xNF3ZbiSMaam%2bac13tvz%2bd%2bPufc81YhmwXZrU8HZlsRLoyUJ69aWQDgG2y3i3FJ5uH/BgAMtxNFwsnZ2YQfp8D2eymAYbWsbAB06FbkwKhQkCKIZDgcj4SpuYTJYLzW8cusyYhCAXr%2bCgVgM9N2AKeIKBkJx8NhMpmMBAKSnhs8gbDw0A/yGzclIrF/UoOcduqvFPU6AGAjihHrvwfg9dChE0Qi4Cej4floeFg2UllXz2tqV44bGwXCiR7JJLfGKRuCxFgiALCd2IINFNvpwfzqccJ5PJ/jxF7FQ9ks/wjACuKmwiEqRiRDoUQohGKEXq3hChr5fKHXOH2pb2ZPnebieW7/9cHOVrlOoUMuYCB1CWG2hNFAzEyRVjPEOmc2EtM6%2bAYMFGbT3R/EtWpIuLhhJjKtCz7SUi7sOTzgB/bBPbB23mJ6NijYalGhnHfYHwcDkKxzwYDX620Vd1RxBWqtJhmfJYnw%2bEOjdsZzmVtTerbrvZKxlu4J5MPmrakxQBcvn0fZd7voQIF9VHG6%2bLhJ8aAwv8A6MT5nMSGvu5rNaanloVhkYuDOfta%2b2sqqNkE9TQUjLZcjbrNyOeW%2baR2KE1Q4iCJBRESQ17X4vwBAPOCP416zyVxaXXvtVj%2bO%2b24qbJjbp52xsLjyh1Oeqxd5HY0Sfr1cOqBGHoxMkQEgF44zOj3FPnW6V3wlPTPrXnf3%2bYpKy6ji%2bJGjguoaCJeVy6phc6aG7h8u/ObhwJ2cnLy4ycDUiqTFVFRQ%2bMZb73z/7XdVZ8o4P56u/Kn05LHi4R4JnAu5wAMNwI8niOiQVF7F5SOErg1qPzxy91DL5OEGxepi6c5zGl5t%2b2BT4/avSprbelHAk2TWpiKheZjq90KsrNy9PSLR7t1fDHZ3X67j5%2bXkCX8%2bX1Zysr%2bzq5nHa7kgOJh/8BynXHb9OiiKtIDeMFDUhvTMN99%2b96NNmz9Oz9yQlpGWsfWD1WthORREgPcMwGwgMPc4Piwf4fLrHW48m33vE7Zq8xllWuloVrkyrWxiR0lXPY/3/saMtoZGFPQ/XZsqgCDeKxbvY30NMe3M/twkl6n6%2b/P37f%2bts1N8UXji6LHSkpO/Nl9i7cmLwNn7fUzW0vLzuo2KB5/uyNZLh2lUVjPFsPpis0BiNiISmY3FhmQjPEH92S7NuhJZVsXY1nLVVo5yW/lYeqVu%2b1ER5PGu3AMdrSIU8M2nzgBjPzYZgpNaAIBr1EmzCXlcBrlML5NC7s5Ih20qJWSwbuh%2bTD/9UpFFbkfcbKQJgcyG5zAc9hdaHQZANEIQMcUD%2ba4i9jaOKpOj2sJRQvRZVdoNp2Rr9/J5dZe6Re1Fh4tbhU1QFZYIwL5QOsGg6%2bmTuxCud8hFh42upGDDfHCZa3LRWhrDSxG/0q4xDACAMeXI%2bi9LMyvUW9iKrLPqzezxNQWi/cdqlLd6UcQvuzMgrBO0NV8GYsklA3jFfSqGRT0jtfjeWEq/CQCi8HkCYFPOmW1VjzIr/lhzSPJZUbWk/cqcRY9wb8JsFDc03ZP0SNrFcFLLAGAZXTiIBO6LRQnlqHxjbsW6E9KMfO6FuobQ5ATInXpCI9w8cYN%2btK/v96tXkc9NLlcrsVwuzZ7HrVONrs/eW1zGN8kGQeiU0/H8FocOwIUlLCby79X4XzdzUCqMeu3dARKzMCqnlrjVCmin6UrgoV43nVbECw21lHfIl9w/AV53/kKIjQKBAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"date":"April 20. 2020","timeToRead":2,"cjkWordCount":2245,"cjkReadTime":10,"description":"WebP，由 Google 开发的新型图像格式，从名字就可以看出是专门为了 Web 而设计。采用 WebP 格式能对网站速度提升起到很大帮助。","content":"<p>WebP 是一种现代图像格式，可为 Web 上的图像提供出色的无损和有损压缩。使用 WebP ，网站管理员和 Web 开发人员可以创建更小，更丰富的图像，从而使 Web 更快。\n与 PNG 相比，WebP 无损图像的尺寸要小 26％。 在同等的 SSIM 质量指数下，WebP 有损图像比同类 JPEG 图像小 25-34％。\n无损 WebP 支持透明性（也称为 Alpha 通道），而仅增加 22％ 的字节数。 对于可以接受有损 RGB 压缩的情况，有损 WebP 还支持透明性，与 PNG 相比，文件大小通常小 3 倍。</p>\n<h2 id=\"webp\"><a href=\"#webp\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>WebP</h2>\n<p>新型图像格式，由 Google 开发<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h3 id=\"webp-是如何工作的\"><a href=\"#webp-%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>WebP 是如何工作的</h3>\n<blockquote>\n<p>有损 WebP 压缩使用预测编码对图像进行编码，这与 VP8 视频编解码器用于压缩视频中的关键帧的方法相同。预测编码使用相邻像素块中的值来预测块中的值，然后仅对差异进行编码。</p>\n<p>无损 WebP 压缩使用已经看到的图像片段来精确地重建新像素。如果找不到有趣的匹配项，它也可以使用本地调色板。</p>\n<p>WebP 文件由 VP8 或 VP8L 图像数据以及基于 RIFF 的容器组成。</p>\n</blockquote>\n<h3 id=\"兼容性\"><a href=\"#%E5%85%BC%E5%AE%B9%E6%80%A7\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>兼容性</h3>\n<p>这种东西就贼烦了:hear_no_evil:</p>\n<p>Google Chrome，Firefox，Edge，Opera 等都支持 WebP</p>\n<p><sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup><figure><img src=\"https://cos.royce2003.top/12013/01.webp-default\" alt=\"支持列表\"><figcaption>支持列表</figcaption></figure></p>\n<p><del>万恶的</del> Safari 居然还不支持，但当看到下方的 <code>Safari is experimenting with supporting WebP images.</code><sup id=\"fnref-3\"><a href=\"#fn-3\" class=\"footnote-ref\">3</a></sup> 时，还兴奋了一小会，但点进去之后...</p>\n<figure><img src=\"https://cos.royce2003.top/12013/02.webp-default\" alt=\"Safari 支持情况\"><figcaption>Safari 支持情况</figcaption></figure>\n<p>2016 年 7 月 19 日 ... wd*md:anger::anger:<br>\n而且 2016 年就内测过，居然给删了...<br>\n和 Google 竞争？没有技术做好？我肯定相信前者</p>\n<h3 id=\"使用情况\"><a href=\"#%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>使用情况</h3>\n<p>随便找了几个网站测下</p>\n<h4 id=\"淘宝\"><a href=\"#%E6%B7%98%E5%AE%9D\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>淘宝</h4>\n<p>淘宝官网中大部分图片均采用了 WebP 格式</p>\n<figure><img src=\"https://cos.royce2003.top/12013/03.webp-default\" alt=\"淘宝\"><figcaption>淘宝</figcaption></figure>\n<p>对于部分较小的图片仍采用 JPG or PNG 格式</p>\n<figure><img src=\"https://cos.royce2003.top/12013/04.webp-default\" alt=\"淘宝\"><figcaption>淘宝</figcaption></figure>\n<h4 id=\"京东\"><a href=\"#%E4%BA%AC%E4%B8%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>京东</h4>\n<p>京东官网中大部分图片均采用了 WebP 格式</p>\n<figure><img src=\"https://cos.royce2003.top/12013/05.webp-default\" alt=\"京东\"><figcaption>京东</figcaption></figure>\n<p>对于极少的图片仍采用 JPG or PNG 格式，如 Logo 等</p>\n<figure><img src=\"https://cos.royce2003.top/12013/06.webp-default\" alt=\"京东\"><figcaption>京东</figcaption></figure>\n<h4 id=\"腾讯、阿里云\"><a href=\"#%E8%85%BE%E8%AE%AF%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>腾讯、阿里云</h4>\n<p>两者均无 WebP 格式图片:-1:</p>\n<h3 id=\"大小\"><a href=\"#%E5%A4%A7%E5%B0%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>大小</h3>\n<p><sup id=\"fnref-4\"><a href=\"#fn-4\" class=\"footnote-ref\">4</a></sup>\n<figure><img src=\"https://cos.royce2003.top/12013/07.webp-default\" alt=\"PNG WebP 对比1\"><figcaption>PNG WebP 对比1</figcaption></figure>\n<figure><img src=\"https://cos.royce2003.top/12013/08.webp-default\" alt=\"PNG WebP 对比2\"><figcaption>PNG WebP 对比2</figcaption></figure></p>\n<p>这些都是较小图片的对比，感觉没差太多，于是乎自己找了几张大图测了下\n图片名字为 分辨率 + 大小</p>\n<figure><img src=\"https://cos.royce2003.top/12013/09.webp-default\" alt=\"大图\"><figcaption>大图</figcaption></figure>\n<p>好像图片有点大诶，由于采用本地软件<a href=\"https://zhitu.isux.us/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">智图</a>转换，CPU 直接拉满了 qaq:sob:</p>\n<figure><img src=\"https://cos.royce2003.top/12013/10.webp-default\" alt=\"CPU\"><figcaption>CPU</figcaption></figure>\n<p>而且两张图图还出错了 qaq，就成功了两张:sob:</p>\n<figure><img src=\"https://cos.royce2003.top/12013/11.webp-default\" alt=\"出错\"><figcaption>出错</figcaption></figure>\n<p>这数据吓到我了<br>\n5.7 MB 直接被干到了 74.2 KB<br>\n11.6 MB 直接被干到了 266 KB</p>\n<p>再来看看网络上一个<a href=\"https://renzhezhilu.gitee.io/webp2jpg-online/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">工具</a>的转换情况</p>\n<figure><img src=\"https://cos.royce2003.top/12013/12.webp-default\" alt=\"webp2jpg-online\"><figcaption>webp2jpg-online</figcaption></figure>\n<p>也是很吓人，不过前两张和智图比一下就效果不怎么样了，但是智图有对图片进行适当压缩，所以...</p>\n<p>原本四张图总大小 87.5 MB，现在 15.7 MB<br>\n反正都 NB 就是了</p>\n<p>再说下智图的压缩，和网络上处理的对比了下，除非放大看细节，要不然没差</p>\n<p>三张对比图放在蓝奏云上了 <a href=\"https://jalen.lanzous.com/ibnfvza\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://jalen.lanzous.com/ibnfvza</a></p>\n<p>顺便再说下，WebP 是支持动图的，也就是说 GIF 也可以转成 WebP，不过目前我找到的大部分工具都不支持转换，<a href=\"https://www.upyun.com/webp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">又拍云</a>支持</p>\n<h3 id=\"总结\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>总结</h3>\n<p>图片体积小，支持透明、动画，不过少数浏览器不支持<br>\n<del>万恶的</del> Safari 以后应该也是会支持的吧</p>\n<p>能有效缓解网页加载过慢的情况 <del>（不配图加载最快了）</del><br>\n还能有效缓解流量太大导致的费用过高（针对对象存储）</p>\n<p>WebP 支持 Alpha 透明和 24-bit 颜色数，例如 PNG8 中的毛边问题是不会出现的</p>\n<p>在大幅缩小体积的情况下保证了图片质量，所以还是非常推荐使用的</p>\n<p>但是有的时候就很玄学了，我曾试过在 JPG 图片通过压缩工具压缩到体积很小的情况下，再去转成 WebP，体积反而变大了，这说明 JPG 比 WebP 体积更小吗？我觉得应该没有。<br>\n本身 JPG 的体积已经很小了，图片质量也非常差，但是大部分情况 WebP 在差不多相同大小的情况下，图片质量能明显高出很多，不排除个例</p>\n<p>真是因为这些优势，本站已将所有的图片换成了 WebP 格式（图标 icon 和个别特例除外）<br>\n那对于<del>万恶的</del> Safari 怎么办呢？<br>\n加几行代码不就好了，<del>简单高效（bushi）</del></p>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token dom variable\">sessionStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'confirm'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token language-regex\">Safari</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token dom variable\">navigator</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">userAgent</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token language-regex\">Chrome</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token dom variable\">navigator</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">userAgent</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">'抱歉，本博客在 Safari 中大部分图片无法显示'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">sessionStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'confirm'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>当然了，也可以通过一些 JS 代码来进行转换，但是效率不怎么高</p>\n<p>还有就是又拍云支持 WebP 自适应，根据浏览器对 WebP 的支持情况，自动返回对应格式图片</p>\n<p>希望 cos 等也能尽快出个这种功能</p>\n<h2 id=\"工具\"><a href=\"#%E5%B7%A5%E5%85%B7\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>工具</h2>\n<p>最后来推荐些转换工具，当然了，可以自己写代码转换，但是我菜啊，只好找现成的</p>\n<h3 id=\"又拍云\"><a href=\"#%E5%8F%88%E6%8B%8D%E4%BA%91\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>又拍云</h3>\n<p><a href=\"https://www.upyun.com/webp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">转换工具地址</a>\n这东西事实上是个 Demo，给用户体验用的，所以下载时需要手动右键另存为，不过它没限制上传数量啊</p>\n<figure><img src=\"https://cos.royce2003.top/12013/13.webp-default\" alt=\"又拍云\"><figcaption>又拍云</figcaption></figure>\n<p>下面这张图片为 GIF to WebP</p>\n<figure><img src=\"https://cos.royce2003.top/12013/14.webp-default\" alt=\"又拍云\"><figcaption>又拍云</figcaption></figure>\n<h4 id=\"优点\"><a href=\"#%E4%BC%98%E7%82%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>优点</h4>\n<ol>\n<li>智能压缩</li>\n<li>转换速度较快</li>\n<li>支持 GIF 转 WebP</li>\n</ol>\n<h4 id=\"缺点\"><a href=\"#%E7%BC%BA%E7%82%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>缺点</h4>\n<ol>\n<li>不支持较大图片</li>\n<li>只能一张一张转换（可以开多个网页同时进行）</li>\n<li>不可自己调节质量</li>\n</ol>\n<p>如果使用又拍云 CDN，可以开启 WebP 自适应<br>\n智能判断浏览器是否支持 WebP，来决定返回 WebP 格式图片还是原图，从而减少网络传输消耗</p>\n<figure><img src=\"https://cos.royce2003.top/12013/15.webp-default\" alt=\"智能 WebP\"><figcaption>智能 WebP</figcaption></figure>\n<h3 id=\"智图\"><a href=\"#%E6%99%BA%E5%9B%BE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>智图</h3>\n<p>腾讯的东西，为数不多的一个良心产品，<a href=\"https://zhitu.isux.us/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官网</a>\n这东西不仅可以转成 WebP，还能优化图片</p>\n<p>软件中需要在右上角的菜单中打开生成 WebP</p>\n<figure><img src=\"https://cos.royce2003.top/12013/16.webp-default\" alt=\"智图\"><figcaption>智图</figcaption></figure>\n<p>会在图片相同位置新建一个文件夹，里面包含了智能处理后的图片和一个 WebP 文件夹</p>\n<h4 id=\"优点-1\"><a href=\"#%E4%BC%98%E7%82%B9-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>优点</h4>\n<ol>\n<li>智能压缩</li>\n<li>支持多张图一起转换</li>\n</ol>\n<h4 id=\"缺点-1\"><a href=\"#%E7%BC%BA%E7%82%B9-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>缺点</h4>\n<ol>\n<li>不支持较大图片</li>\n<li>不支持 GIF 转 WebP</li>\n<li>不可自己调节质量</li>\n<li>偶尔出现转换失败或提示文件格式错误</li>\n</ol>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>软件中的质量调节对生成 WebP 图片无效</p></div></div>\n<h3 id=\"webp-converter\"><a href=\"#webp-converter\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>WebP Converter</h3>\n<p><a href=\"https://webp-converter.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官网</a></p>\n<figure><img src=\"https://cos.royce2003.top/12013/17.webp-default\" alt=\"WebP Converter\"><figcaption>WebP Converter</figcaption></figure>\n<p>options 可调节质量</p>\n<h4 id=\"优点-2\"><a href=\"#%E4%BC%98%E7%82%B9-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>优点</h4>\n<ol>\n<li>支持多张图一起转换</li>\n<li>可自行调节质量</li>\n<li>转换速度较快</li>\n</ol>\n<h4 id=\"缺点-2\"><a href=\"#%E7%BC%BA%E7%82%B9-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>缺点</h4>\n<ol>\n<li>限制 8MB 以下</li>\n<li>不支持 GIF 转 WebP</li>\n</ol>\n<h3 id=\"webp2jpg-online\"><a href=\"#webp2jpg-online\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>webp2jpg-online</h3>\n<p><a href=\"https://renzhezhilu.gitee.io/webp2jpg-online/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官网</a></p>\n<figure><img src=\"https://cos.royce2003.top/12013/18.webp-default\" alt=\"webp2jpg-online\"><figcaption>webp2jpg-online</figcaption></figure>\n<p>options 可调节质量</p>\n<h4 id=\"优点-3\"><a href=\"#%E4%BC%98%E7%82%B9-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>优点</h4>\n<ol>\n<li>转换速度非常快</li>\n<li>支持多张图一起转换</li>\n<li>可自行调节质量</li>\n<li><strong>可自行裁剪</strong></li>\n<li><strong>支持大图片</strong></li>\n<li><strong>支持 jpeg, jpg, png, gif, svg, ico, bmp 转 WebP</strong></li>\n</ol>\n<p>还可以转换成 JPEG PNG ICO</p>\n<h4 id=\"缺点-3\"><a href=\"#%E7%BC%BA%E7%82%B9-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>缺点</h4>\n<p>好像没找到缺点，还是托管在 gitee 的，访问速度非常快:laughing:</p>\n<h3 id=\"总结-1\"><a href=\"#%E6%80%BB%E7%BB%93-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>总结</h3>\n<p>上面推荐的工具用着都还不错，各有各的优势</p>\n<p>我在转换时的优先级排序</p>\n<p>单张图片：又拍云 > webp2jpg-online > 智图 > WebP Converter</p>\n<p>大量图片：智图 > webp2jpg-online > WebP Converter > 又拍云</p>\n<p>单张图片最优选又拍云是因为会智能压缩而且比较快，比较方便\n多图主要还是因为智图有客户端，方便一点，webp2jpg-online 如果出客户端我肯定毫不犹豫选它</p>\n<p>这篇文章在此之前一共 18 张图片，PNG 格式大小为 25.1 MB，Snipaste 直接100质量输出，智图转 WebP 之后仅 645 KB，直接就省了 24 MB 啊:+1:</p>\n<figure><img src=\"https://cos.royce2003.top/12013/19.webp-default\" alt=\"总结\"><figcaption>总结</figcaption></figure>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>参考 <a href=\"https://developers.google.com/speed/webp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A new image format for the Web</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p>图片来源 <a href=\"https://caniuse.com/#feat=webp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Can I use...</a></p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-3\">\n<p>来源 <a href=\"https://www.cnet.com/news/apple-ios-macos-tests-googles-webp-graphics-to-speed-up-web/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apple tests Google graphics format to speed up websites</a></p>\n<a href=\"#fnref-3\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-4\">\n<p>图片来源 <a href=\"https://isparta.github.io/compare-webp/index.html#12345\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebP 示例 (PNG 转 WebP)</a></p>\n<a href=\"#fnref-4\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"Hexo Fluid 暗黑模式","path":"/posts/hexo-dark-mode/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/hexo-dark-mode.a209973.7c0cd696151d288cd24e7c37d5cb3c78.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/hexo-dark-mode.a67b0b2.7c0cd696151d288cd24e7c37d5cb3c78.png 480w","/assets/static/hexo-dark-mode.a209973.7c0cd696151d288cd24e7c37d5cb3c78.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-a0b1e28dd81e2634e243c84b48088226'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-a0b1e28dd81e2634e243c84b48088226)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAGL0lEQVRIx81X21MaZxTPS6fTl/Sx04fOdNqZNHZEmTQaTcQrNwk3EQTvVmOI8Y4XFBEUFUFE2F1crgILu8vNS2Kb1Mxk0pl2pn9Xzy5ipN6wD01nvoeP/c6ePb/z%2b51zPu6gMQpjF8ou7IqFXthcb3NbV2g8icRJLHqZqziFxa9yRd7B2GNf3qiw%2bS9/QhAoSYb39kPBLE6n4ScWJ4uMY5QvdoWrGHXn8rTFS2MgXgID17pCEqQ/mY25jqw9Ho32pcnl9iczeIKFATYE5YvSUeQQILER01gBQ36htwbAvvPxNJ8e8PvvABBUGMt5RqOdrWMP%2bU%2b5fHG1UKbTj9uxYJDK7hIpFKiI0tTmm5A/h8RIT4Rg%2bSkGULqE8nQXYDAssySS3r0EFruNhFhJIIkksfHKpkEfNj/lCIU1YuUjsaJaJOc2tfKk6qEZozO45yfSCJEM%2b/dDnlw4lXv3%2b19%2blpxiCZ2hiVNoMUEX%2bCIDZGYvfRDLHAWSmbNkHLx9HySz3mgSK80VcxolcTqzOuUxNq6OKa0CaTdXKK4SympEikdieQVfVCfSmPpcqIPASNoTTdDHb7LH716dfCByr4o%2bdCsGYEXTh5njk%2bwvJ9HMETxEoknq8Ne3H/4k9l/7CDqvpVJcAYBgNmeacVgEdqwzsiJxDyrmn0jaOQJhbatqUDm3JNtc1tnMJidOZdBoMkTl4IsgIfjKhSIuMW2sSCABDIDjk3zEnr1E%2bvg32B%2b%2bff/m/R9owexmVwSFBBLjHYsj9VPY8zA%2bEHXJfSapY0i1MCe16WsmZZz2Se2s1eIOpHOAFjIFQs0r9kIR3wig8A5oBqQSyx4RuddQZGw9kHgiBYQAJMgQcmpJMp3xRgD%2bxPyQbbB%2brLPu%2bZJ6M/AyjmiDBp5JWa5puSeRVbTPdi0aJles2z4g1k9m/Mk0vHX7IiZSeDINyYY0MH2D1R9UAsJudhnZME7BhnkCcYOECJppICy8a4o4cni0aHBM85Z0vCFd44sRycKq0tVe0SUqk0l%2bVEo5KuPAsr7HUF3dYLQ5ekYNL4zLjH7O%2bbxBQkyxE7TLv7fqxjxhAmfacwoyASHCE2jVu4nUFh7ewiOwX/fi4Itp4cm0OxjbQAMBKse280sqGIvTO8F4v2GuTTyEKMKqn7of32tW1fa11Q/IKjSS%2b4rWH%2bSyctV8r1nfNX337pfCtg5ucyt0WCcegY%2beJ%2bFaBmIkhLvs3Jky2xbWnZYt76obXdlGTfZtg3V9adMNBhaXd3hq3uELDoxObyB%2bOAI8U0urs9YNALmyjQAVWLFnEBgkAjq9SNfbJOiYVa0/a5gQV7TxyoR19/kyjlpSoWpp1EgaO41DFq1muOybSl6z4pFE%2bZAvnVmx56Vb0iTOCwPihqANlnX9zOLInGl8wWLb8Q1PG2HBqR0N6A0LsKaX16bMq8Y158CoYcm%2bPbZg%2bXnMMGPdyGfrgnDJ3UQalG2wbog7%2bmua5E8fd2qq%2blorVZJyVT1f1dLZz23giwRaWY1OXq550qKskbaV8wTPDIuh1D7yjzZ6jYQgRMj65NKK1eWds20CjHmbYwPFZ1fsEJw7FFtHcOOaY9npAYrMDjcAMDs9c6ubsAH7Ne9uvutdOlKAh3DqAJwMzhhrpW2P6%2bXqx/3Kio6yB3Vff3fv88%2b%2bUHC0ak6XpEzeyJVyeQKhptvpjzDVWKqEChcpQIwnU6f3kBiJnGtKWL4RJdNQ3HnX%2bOmkpNlmn7zUs6/Q0CKpfdB0kM5BzWj0o1UCWW2DrJLH/%2brb78ureO0PunprnynLtMPSCYW622TfCqf2z/ssllCegbOrS/zc5uLduOiU/HhHiuXVQucfAoyP2Tp3KTqz9DKpScNwBNhAiGnTLekZeNAiqRYrYKipOLrhunG9eOKF2mB2uLYDe6fNrZjJT3ydZjs1M8LhesIUaJQcN9sa23TcJpGkWjsrXV6ZcPaKnq95oBPGd2/VRi9rf0Wb621u4Yolh5lTcSpC74fofVcg2jcxI5L3qqV6XqW0p2UYRthVM/F/AKAgBlhhOocTKZgnAGPNi7cPjohVPYuWLbbArgDwyf%2bRnf8JfwBARXupgxCVharwEdROJO6nMlcPK%2bpv6umPJZtcGSsAAAAASUVORK5CYII=' /%3e%3c/svg%3e"},"date":"April 2. 2020","timeToRead":2,"cjkWordCount":919,"cjkReadTime":4,"description":"适用于 Hexo 的暗黑模式，推荐在主题没有暗色模式的情况下使用","content":"<p>大概花了一个晚上搞暗黑模式，之后几天陆续优化了下\n目前博客已经基本上适配完成了\n目前是三种方案（优先级递减）</p>\n<ol>\n<li>媒体查询</li>\n<li>定时开启</li>\n<li>\n<p>localStorage/sessionStorage 查询</p>\n<!--more-->\n<p><code>媒体查询</code>，判断系统是否处于暗黑模式，支持大部分系统\nWin10 需要浏览器开启深色模式\nAndroid 同理，需要浏览器支持手机开启夜间模式的时候将自身切换到神色模式，目前 Chrome 支持，Edge 不支持，其他没测\niOS、MacOS 上的 Safari 也支持</p>\n</li>\n</ol>\n<p><code>定时开启</code>，在规定时间自动开启，如果在该时间段内取消了暗黑模式，能一直保持</p>\n<p><code>localStorage/sessionStorage 查询</code>，能一直保持某一个模式的依赖</p>\n<h3 id=\"html\"><a href=\"#html\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>HTML</h3>\n<p>在 <code>\\themes\\fluid\\layout\\layout.ejs</code> 中找到 <code>&#x3C;body></code>，在其之后加入如下代码</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dark<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>switchDarkMode()<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">var</span> isNight <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">22</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token function\">matchMedia</span><span class=\"token punctuation\">(</span><span class=\"token string\">'(prefers-color-scheme: dark)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">matches</span> <span class=\"token operator\">||</span> isNight <span class=\"token operator\">||</span> <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>isNight<span class=\"token operator\">&amp;&amp;</span><span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'noDark'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">classList</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">innerHTML</span> <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">classList</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dark\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token string\">\"🌙\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"🌞\"</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>注意</h5></div><div class=\"admonition-content\"><p>一定紧跟在 <code>body</code> 标签之后，否则会出现闪烁</p></div></div>\n<h3 id=\"js\"><a href=\"#js\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>JS</h3>\n<p>然后随便找个 JS 把下面代码加进去，直接加到 <code>&#x3C;/body></code> 之前也行</p>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">//点击事件</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">switchDarkMode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#dark\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"🌞\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">classList</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">remove</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'noDark'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#dark\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"🌙\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">classList</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dark'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'noDark'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"css\"><a href=\"#css\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CSS</h3>\n<p>在自定义 CSS 中加入代码</p>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>可以用 <code>stylus</code>，能少些写\n但是引入时记得后缀还是 <code>.css</code> 不要变</p></div></div>\n<p>下面是我的样式代码，基本覆盖所有内容，根据自身情况修改</p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token selector\"><span class=\"token comment\">/* 切换按钮 */</span>\n#dark</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">cursor</span> pointer</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> fixed</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">right</span> <span class=\"token number\">40</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">bottom</span> <span class=\"token number\">98</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">16</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">14</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">100</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span></span>\n\n<span class=\"token comment\">/*暗黑模式*/</span>\n<span class=\"token punctuation\">.</span>dark\n\n  <span class=\"token selector\"><span class=\"token comment\">/* 主体 */</span>\n  #board</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#282c34</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n  \n  <span class=\"token selector\">img  </span>\n    <span class=\"token property-declaration\"><span class=\"token property\">filter</span> <span class=\"token func\"><span class=\"token function\">brightness</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token unit\">%</span><span class=\"token punctuation\">)</span></span></span>\n\n  <span class=\"token selector\">p\n  .index-info a  </span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span> <span class=\"token important\">!important</span></span>\n\n  <span class=\"token selector\">.markdown-body</span>\n    <span class=\"token selector\">h1<span class=\"token punctuation\">,</span>h2<span class=\"token punctuation\">,</span>h3<span class=\"token punctuation\">,</span>h4<span class=\"token punctuation\">,</span>h5<span class=\"token punctuation\">,</span>h6<span class=\"token punctuation\">,</span>s<span class=\"token punctuation\">,</span>li  </span>\n      <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span><span class=\"token hexcode\">#a09c9c</span> <span class=\"token important\">!important</span></span>\n\n  <span class=\"token selector\"><span class=\"token comment\">/* 顶栏 */</span>\n  .navbar-col-show\n  .top-nav-collapse  </span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#282c34</span></span>\n\n  <span class=\"token selector\">.navbar a</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span> <span class=\"token important\">!important</span></span>\n\n  <span class=\"token selector\">.animated-icon span   <span class=\"token comment\">/* 手机端 */</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* page-number */</span>\n  .pagination a:hover\n  .pagination .current  </span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#6b6b6b</span><span class=\"token number\">73</span><span class=\"token punctuation\">;</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* 打字机 */</span>\n  #subtitle\n  .dark.typed-cursor--blink\n  .scroll-down-arrow</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#dfdfdf</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* back to top */</span>\n  #scroll-top-button</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#282c34</span></span>\n\n    <span class=\"token selector\">i</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* Toc */</span>\n  .tocbot-list a</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n\n  <span class=\"token selector\">.tocbot-active-link\n  footer a:hover</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#1abc9c</span> <span class=\"token important\">!important</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* footer */</span>\n  footer\n  footer a</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* 归档页 */</span>\n  .list-group-item</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#282c34</span></span>\n\n  <span class=\"token selector\">.list-group-item:hover\n  .tagcloud a:hover</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#46484d</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* 友链页 */</span>\n  .links</span>\n    <span class=\"token selector\">.card  </span>\n      <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#282c34</span></span>\n\n    <span class=\"token selector\">.card-body:hover  </span>\n      <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#46484d</span></span>\n\n    <span class=\"token selector\">.link-title\n    .link-intro  </span>\n      <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#a09c9c</span></span>\n\n\n  <span class=\"token selector\"><span class=\"token comment\">/* note标签 可能这配色有点丑 */</span>\n  .note-info</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#3b5359</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">border-color</span> <span class=\"token hexcode\">#006d80</span></span>\n\n  <span class=\"token selector\">.note-danger</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#783f42</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">border-color</span> <span class=\"token hexcode\">#670009</span></span>\n\n  <span class=\"token selector\">.note-success</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#2a3e2e</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">border-color</span> <span class=\"token hexcode\">#005915</span></span>\n\n  <span class=\"token selector\">.note-warning</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#5b543e</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">border-color</span> <span class=\"token hexcode\">#846500</span></span>\n\n  <span class=\"token selector\">.note-primary</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#455a6f</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">border-color</span> <span class=\"token hexcode\">#004188</span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"localstorage-还是-sessionstorage\"><a href=\"#localstorage-%E8%BF%98%E6%98%AF-sessionstorage\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>localStorage 还是 sessionStorage</h3>\n<p>仔细观察刚刚的 js 代码，在其中用的是 localStorage\n除了 localStorage，你还可以用 sessionStorage\n两者的区别也非常简单</p>\n<blockquote>\n<p>localStorage：除非被手动清除，否则将会永久保存。\nsessionStorage： 仅在当前网页会话下有效，关闭页面或浏览器后就会被清除。</p>\n</blockquote>\n<p>举个简单例子，如果现在是白天（即没有触发夜间自动开启暗黑模式）\n你手动点击切换成了暗黑模式，当你关闭当前网页再次进入时\n如果你用的是 localStorage，那么此时就还是暗黑模式\n而如果你用的是 sessionStorage，此时就不是暗黑模式了</p>\n<p>两者的使用方法相同\n直接替换就可以了</p>\n<div class=\"admonition admonition-caution\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z\"></path></svg></div><a href=\"https://crosschannel.cc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">track13</a> 指出</h5></div><div class=\"admonition-content\"><p>sessionStorage 在手机浏览器上问题很多，不推荐使用</p></div></div>\n<p>下面是支持该特性的最低版本\n<figure><img src=\"https://cos.royce2003.top/41212/01.webp-default\" alt=\"支持情况\"><figcaption>支持情况</figcaption></figure></p>\n<p>可以在浏览器控制台中查看他们的值\n<figure><img src=\"https://cos.royce2003.top/41212/02.webp-default\" alt=\"查看\"><figcaption>查看</figcaption></figure></p>\n<hr>\n<h3 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>参考</h3>\n<ol>\n<li><a href=\"https://crosschannel.cc/daily/hexo%E6%B7%BB%E5%8A%A0%E6%9A%97%E8%89%B2%E6%A8%A1%E5%BC%8F.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">面向小白的Hexo添加暗色模式教程 | 宅日记</a></li>\n</ol>\n"}},{"node":{"title":"Hexo Fluid 瞎折腾","path":"/posts/hexo-fluid/","cover_image":null,"date":"April 1. 2020","timeToRead":16,"cjkWordCount":3955,"cjkReadTime":18,"description":"Fluid 主题的瞎折腾汇总","content":"<div class=\"admonition admonition-note\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div>📄 更新日志</h5></div><div class=\"admonition-content\"><p>2020.04.10 新增超好看的复选框<br>\n2020.04.13 更新动态背景代码<br>\n2020.04.28 自定义返回顶部图片和球形标签云  </p></div></div>\n<div class=\"admonition admonition-warning\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></div>🚨 注意</h5></div><div class=\"admonition-content\"><p>随着主题的更新，文中的代码可能失效或引起错误，请自行修改</p></div></div>\n<h3 id=\"前言\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>前言</h3>\n<p>好像还没有看到大佬写关于 Fluid 折腾的文章，就开了这个坑\n文章放了源码进来，所以挺长的，大部分是改 CSS，JS 很少\n首先，按照 Fluid 配置文件中的方法，新建自定义 CSS 和 JS\n对于自定义 css，建议新建 <code>custom.styl</code>，接下来的代码基本都是 styl 的，直接放入 css 文件中无法使用</p>\n<p>如果你还不知道什么是 stylus，有兴趣的话可以看看这篇文章 <a href=\"https://juejin.im/post/5bbd7a7c6fb9a05cfd27f4c6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">『前端干货篇』：你不知道的Stylus</a></p>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>新建的是 <code>styl</code>，配置文件中也填 <code>.css</code></p></div></div>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">custom_js</span><span class=\"token punctuation\">:</span> /js/custom.js <span class=\"token comment\"># 指定自定义 js 文件路径，路径是相对 source 目录，如 /js/custom.js</span>\n<span class=\"token key atrule\">custom_css</span><span class=\"token punctuation\">:</span> /css/custom.css <span class=\"token comment\"># 指定自定义 css 文件路径，路径是相对 source 目录，如 /css/custom.css</span>\n<span class=\"token key atrule\">custom_html</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span>  <span class=\"token comment\"># 自定义底部 HTML 内容（位于 footer 上方），也可用于外部引入 js css 这些操作，注意不要和 post.custom 配置冲突</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"动态背景\"><a href=\"#%E5%8A%A8%E6%80%81%E8%83%8C%E6%99%AF\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>动态背景</h3>\n<p><sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<p>效果见 <a href=\"https://a9m5yn.coding-pages.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">演示站点</a></p>\n<p>自定义 CSS 中加入如下代码</p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token selector\">.slideshow</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> fixed</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">100</span><span class=\"token unit\">vw</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">vh</span></span>\n\n  <span class=\"token selector\">.slideshow-image</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> fixed</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-size</span> cover</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background</span> repeat <span class=\"token number\">50</span><span class=\"token unit\">%</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">animation-name</span> kenburns</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">animation-timing-function</span> linear</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">animation-iteration-count</span> infinite</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">animation-duration</span> <span class=\"token number\">24</span><span class=\"token unit\">s</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">1</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transform</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">filter</span> <span class=\"token func\"><span class=\"token function\">brightness</span><span class=\"token punctuation\">(</span><span class=\"token number\">70</span><span class=\"token unit\">%</span><span class=\"token punctuation\">)</span> </span><span class=\"token comment\">//背景遮罩，100% 正常，0% 完全黑色</span></span>\n\n    <span class=\"token selector\">&amp;:nth-child(1)<span class=\"token punctuation\">{</span></span><span class=\"token property-declaration\"><span class=\"token property\">-webkit-animation-name</span><span class=\"token punctuation\">:</span> kenburns-1<span class=\"token punctuation\">;</span> animation-name<span class=\"token punctuation\">:</span> kenburns-1<span class=\"token punctuation\">;</span> z-index<span class=\"token punctuation\">:</span> <span class=\"token number\">-2</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n    <span class=\"token selector\">&amp;:nth-child(2)<span class=\"token punctuation\">{</span></span><span class=\"token property-declaration\"><span class=\"token property\">-webkit-animation-name</span><span class=\"token punctuation\">:</span> kenburns-2<span class=\"token punctuation\">;</span> animation-name<span class=\"token punctuation\">:</span> kenburns-2<span class=\"token punctuation\">;</span> z-index<span class=\"token punctuation\">:</span> <span class=\"token number\">-3</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n    <span class=\"token selector\">&amp;:nth-child(3)<span class=\"token punctuation\">{</span></span><span class=\"token property-declaration\"><span class=\"token property\">-webkit-animation-name</span><span class=\"token punctuation\">:</span> kenburns-3<span class=\"token punctuation\">;</span> animation-name<span class=\"token punctuation\">:</span> kenburns-3<span class=\"token punctuation\">;</span> z-index<span class=\"token punctuation\">:</span> <span class=\"token number\">-4</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span>\n    <span class=\"token selector\">&amp;:nth-child(4)<span class=\"token punctuation\">{</span></span><span class=\"token property-declaration\"><span class=\"token property\">-webkit-animation-name</span><span class=\"token punctuation\">:</span> kenburns-4<span class=\"token punctuation\">;</span> animation-name<span class=\"token punctuation\">:</span> kenburns-4<span class=\"token punctuation\">;</span> z-index<span class=\"token punctuation\">:</span> <span class=\"token number\">-5</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span></span>\n\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@keyframes</span> kenburns-1<span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">1.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">23.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">26.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">98.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.21176</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.21176</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span></span></span></span></span></span></span></span></span>\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@keyframes</span> kenburns-2<span class=\"token punctuation\">{</span><span class=\"token number\">23.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">26.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">48.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">51.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span></span></span></span></span></span></span>\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@keyframes</span> kenburns-3<span class=\"token punctuation\">{</span><span class=\"token number\">48.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">51.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">73.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">76.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span></span></span></span></span></span></span>\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@keyframes</span> kenburns-4<span class=\"token punctuation\">{</span><span class=\"token number\">73.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">76.5625</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">98.4375</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">{</span>opacity<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> -webkit-transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> transform<span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span></span></span></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>接着在 <code>themes\\fluid\\layout\\layout.ejs</code> 中 <code>&#x3C;body></code> 后加入如下代码\n<code>background-image: url</code> 中填入图片链接</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>slideshow<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>slideshow-image<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">'1'</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>slideshow-image<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">'2'</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>slideshow-image<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">'3'</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>slideshow-image<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">'4'</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>然后取消原本头图的获取\n用最简单的方法，直接删去获取头图的代码，保留标签</p>\n<pre class=\"language-diff line-numbers\"><code class=\"language-diff\"><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> &lt;header style=\"height: &lt;%- banner_img_height %>vh;\">\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   &lt;%- partial('_partial/nav') %>\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    &lt;div class=\"view intro-2\" id=\"background\" &lt;%- theme.banner_parallax &amp;&amp; 'parallax=true' %>\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      style=\"background: url('&lt;%- url_for(banner_img) %>') no-repeat center center;\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        background-size: cover;\">\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;div class=\"view intro-2\" id=\"background\">\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     &lt;div class=\"full-bg-img\">\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">       &lt;div class=\"mask flex-center\"></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>将主题配置中<strong>所有</strong>头图的黑色蒙版设为 0</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">banner_mask_alpha</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># 头图黑色蒙版的透明度，available: 0 - 1.0， 0 是完全透明（无蒙版），1 是完全不透明</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>如果出现背景跟随滚动，请在配置文件中关闭头图滚动视差</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">banner_parallax</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span> <span class=\"token comment\"># 头图滚动视差</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>因为是依赖 <code>z-index</code> 实现的切换，建议图片大小递增排序，避免第一张图还没加载出来，第二张图先出现的情况</p>\n<h3 id=\"侧边滚动条\"><a href=\"#%E4%BE%A7%E8%BE%B9%E6%BB%9A%E5%8A%A8%E6%9D%A1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>侧边滚动条</h3>\n<pre class=\"language-css line-numbers\"><code class=\"language-css\"><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>-webkit-scrollbar-button\n  display <span class=\"token property\">none</span>\n\n<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>-webkit-scrollbar\n  width <span class=\"token number\">10</span><span class=\"token unit\">px</span>\n  height <span class=\"token number\">10</span><span class=\"token unit\">px</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #<span class=\"token number\">2</span><span class=\"token property\">f415452</span>\n\n<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>-webkit-scrollbar-thumb\n  border-radius <span class=\"token number\">5</span><span class=\"token unit\">px</span>\n  background-color <span class=\"token hexcode color\">#2f4154</span>\n  background-image <span class=\"token function\">-webkit-linear-gradient</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">,</span><span class=\"token color\"><span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">.2</span><span class=\"token punctuation\">)</span></span> <span class=\"token number\">25</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token color\">transparent</span> <span class=\"token number\">25</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token color\">transparent</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token color\"><span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">.2</span><span class=\"token punctuation\">)</span></span> <span class=\"token number\">50</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token color\"><span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">.2</span><span class=\"token punctuation\">)</span></span> <span class=\"token number\">75</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token color\">transparent</span> <span class=\"token number\">75</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token color\">transparent</span><span class=\"token punctuation\">)</span>\n\n  &amp;<span class=\"token punctuation\">:</span>hover\n    background-color <span class=\"token hexcode color\">#2f4154b8</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>会同时对所有滚动条生效</p></div></div>\n<h3 id=\"返回顶部按钮\"><a href=\"#%E8%BF%94%E5%9B%9E%E9%A1%B6%E9%83%A8%E6%8C%89%E9%92%AE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>返回顶部按钮</h3>\n<p>增加动画</p>\n<pre class=\"language-css line-numbers\"><code class=\"language-css\">#scroll-top-button\n  border-radius <span class=\"token number\">25</span><span class=\"token unit\">px</span>\n  -webkit-transition all <span class=\"token number\">.6</span><span class=\"token unit\">s</span>\n  -moz-transition all <span class=\"token number\">.6</span><span class=\"token unit\">s</span>\n  -o-transition all <span class=\"token number\">.6</span><span class=\"token unit\">s</span>\n  transition all <span class=\"token number\">.6</span><span class=\"token unit\">s</span>\n\n  &amp;<span class=\"token punctuation\">:</span>hover\n    transform <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">)</span>\n    border-radius <span class=\"token number\">20</span><span class=\"token unit\">%</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"标题前-emoji\"><a href=\"#%E6%A0%87%E9%A2%98%E5%89%8D-emoji\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>标题前 Emoji</h3>\n<p><sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup></p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token comment\">/* 想在手机端也显示，去除最外层的 @media，并更改缩进 */</span>\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@media</span> <span class=\"token punctuation\">(</span>min-width<span class=\"token punctuation\">:</span><span class=\"token number\">768</span><span class=\"token unit\">px</span><span class=\"token punctuation\">)</span></span>\n  <span class=\"token selector\">.post-content</span>\n    <span class=\"token selector\">h1::before</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"🌈\"</span><span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">visibility</span><span class=\"token punctuation\">:</span> visible<span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline<span class=\"token punctuation\">;</span></span>\n    <span class=\"token selector\">h2::before</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"🚀\"</span><span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">visibility</span><span class=\"token punctuation\">:</span> visible<span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline<span class=\"token punctuation\">;</span></span>\n    <span class=\"token selector\">h3::before</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"🔍\"</span><span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">visibility</span><span class=\"token punctuation\">:</span> visible<span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline<span class=\"token punctuation\">;</span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"首页图片动画\"><a href=\"#%E9%A6%96%E9%A1%B5%E5%9B%BE%E7%89%87%E5%8A%A8%E7%94%BB\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>首页图片动画</h3>\n<p>鼠标触碰放大</p>\n<pre class=\"language-css line-numbers\"><code class=\"language-css\">.index-img\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> <span class=\"token number\">.4</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span>\n\n.<span class=\"token property\">index-card</span><span class=\"token punctuation\">:</span>hover .index-img\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">5</span><span class=\"token unit\">px</span> <span class=\"token number\">11</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span> <span class=\"token color\"><span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.38</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token number\">4</span><span class=\"token unit\">px</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span> <span class=\"token color\"><span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.35</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"底部及-toc-样式更改\"><a href=\"#%E5%BA%95%E9%83%A8%E5%8F%8A-toc-%E6%A0%B7%E5%BC%8F%E6%9B%B4%E6%94%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>底部及 TOC 样式更改</h3>\n<p>因为之前的动态背景添加了遮罩导致底部链接等看不起</p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token selector\">.tocbot-list a\n#toc<span class=\"token punctuation\">,</span> footer<span class=\"token punctuation\">,</span> footer a</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#ffffff</span></span>\n\n<span class=\"token property-declaration\"><span class=\"token property\">footer</span> a<span class=\"token punctuation\">:</span>hover</span>\n<span class=\"token selector\">.tocbot-active-link</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#1abc9c</span> <span class=\"token important\">!important</span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"标题文字特效\"><a href=\"#%E6%A0%87%E9%A2%98%E6%96%87%E5%AD%97%E7%89%B9%E6%95%88\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>标题文字特效</h3>\n<figure><img src=\"https://cos.royce2003.top/60394/01.webp-default\" alt=\"演示\"><figcaption>演示</figcaption></figure>\n<p>文字触碰动画（源网，找不到原站链接了）</p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token selector\"><span class=\"token comment\">/* 注意避免类名相同造成样式冲突 */</span>\n.link <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">outline</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">text-decoration</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">em</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#9e9ba4</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block<span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.link--kukuri <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">text-transform</span><span class=\"token punctuation\">:</span> uppercase<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> <span class=\"token number\">700</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#2f4144</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.link--kukuri:hover <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#2f4144</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.link--kukuri::after <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">42</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> auto<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">right</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#F9F9F9</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token number\">-100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token number\">-100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transition</span><span class=\"token punctuation\">:</span> -webkit-transform <span class=\"token number\">0.4</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> transform <span class=\"token number\">0.4</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transition-timing-function</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">cubic-bezier</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition-timing-function</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">cubic-bezier</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.link--kukuri:hover::after <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">translate3d</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.link--kukuri::before <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token unit\">px</span> solid<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span>data-letters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#ff779a</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">white-space</span><span class=\"token punctuation\">:</span> nowrap<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transition</span><span class=\"token punctuation\">:</span> width <span class=\"token number\">0.4</span><span class=\"token unit\">s</span> <span class=\"token number\">0.3</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> width <span class=\"token number\">0.4</span><span class=\"token unit\">s</span> <span class=\"token number\">0.3</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.link--kukuri:hover::before <span class=\"token punctuation\">{</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>然后在你想显示的地方插入如下 HTML</p>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>data-letters 中需要和内容保持一致<br>\n不用 a 标签也可以，保证类名正确</p></div></div>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>link link--kukuri<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test.test<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-letters</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>test<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<h3 id=\"留言板\"><a href=\"#%E7%95%99%E8%A8%80%E6%9D%BF\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>留言板</h3>\n<p>在 <code>themes\\hexo-theme-fluid-master\\layout\\</code> 中新建 <code>messageboard.ejs</code> 文件\n先写上头图之类的设定</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\">&lt;%\npage.layout = \"messageboard\"\npage.title = theme.messageboard.title || __('messageboard.title')\npage.subtitle = theme.messageboard.subtitle || __('messageboard.subtitle')\npage.banner_img = theme.messageboard.banner_img\npage.banner_img_height = theme.messageboard.banner_img_height\n%><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>然后在配置文件中加入相应内容，当然，你也可以直接在上面的代码中指定</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token comment\">#---------------------------</span>\n<span class=\"token comment\"># 留言板页</span>\n<span class=\"token comment\"># Messageboard Page</span>\n<span class=\"token comment\">#---------------------------</span>\n<span class=\"token key atrule\">messageboard</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">banner_img</span><span class=\"token punctuation\">:</span>         <span class=\"token comment\"># 头图</span>\n  <span class=\"token key atrule\">banner_img_height</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># available: 0 - 100</span>\n  <span class=\"token key atrule\">subtitle</span><span class=\"token punctuation\">:</span>           <span class=\"token comment\"># 打字机内容</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>语言文件中也是一样的，这里就不写了</p>\n<h4 id=\"引入评论\"><a href=\"#%E5%BC%95%E5%85%A5%E8%AF%84%E8%AE%BA\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>引入评论</h4>\n<p>刚刚创建的 ejs 文件中</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- Comments --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container comments mx-auto<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>comments<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    &lt;% if(theme.post.comments.enable) { %>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\n    &lt;% var type = '_partial/comments/' + theme.post.comments.type %>\n    &lt;%- partial(type) %>\n    &lt;% } %>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>自定义内容写在评论代码之前就好了，支持 HTML</p>\n<p>然后两种方法开启，二选一即可</p>\n<h4 id=\"1\"><a href=\"#1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>1</h4>\n<p>在根目录的 <code>source</code> 文件夹中创建 <code>messageboard.md</code>\n并在 <code>front-matter</code> 中加上 <code>layout: messageboard</code>\n和 about 界面的方法一样</p>\n<h4 id=\"2\"><a href=\"#2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>2</h4>\n<p>在 <code>themes\\fluid\\scripts\\pages.js</code> 文件中加入如下代码</p>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// generate messageboard page</span>\nhexo<span class=\"token punctuation\">.</span><span class=\"token property-access\">extend</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">generator</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_messageboard'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">locals</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token string\">'messageboard/index.html'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token operator\">:</span> locals<span class=\"token punctuation\">.</span><span class=\"token property-access\">theme</span><span class=\"token punctuation\">,</span>\n    layout<span class=\"token operator\">:</span> <span class=\"token string\">'messageboard'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"更好看的音乐播放器\"><a href=\"#%E6%9B%B4%E5%A5%BD%E7%9C%8B%E7%9A%84%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>更好看的音乐播放器</h3>\n<p><sup id=\"fnref-3\"><a href=\"#fn-3\" class=\"footnote-ref\">3</a></sup></p>\n<p>本身的 aplayer 个人觉得并不是很好看，而且是全局的\n换了给好看点的播放器，在指定页面加载\n需要加载的页面加入</p>\n<figure><img src=\"https://cos.royce2003.top/60394/02.webp-default\" alt=\"音乐播放器\"><figcaption>音乐播放器</figcaption></figure>\n<h4 id=\"js\"><a href=\"#js\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>JS</h4>\n<p>自定义 js 里加入</p>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> dr <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#dowebok\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>dr<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    dr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;div id=\\\"player\\\">&lt;div id=\\\"player-track\\\">&lt;div id=\\\"album-name\\\">&lt;/div>&lt;div id=\\\"track-name\\\">&lt;/div>&lt;div id=\\\"track-time\\\">&lt;div id=\\\"current-time\\\">&lt;/div>&lt;div id=\\\"track-length\\\">&lt;/div>&lt;/div>&lt;div id=\\\"s-area\\\">&lt;div id=\\\"ins-time\\\">&lt;/div>&lt;div id=\\\"s-hover\\\">&lt;/div>&lt;div id=\\\"seek-bar\\\">&lt;/div>&lt;/div>&lt;/div>&lt;div id=\\\"player-content\\\">&lt;div id=\\\"album-art\\\">&lt;img src=\\\"images/1.jpg\\\" class=\\\"active\\\" id=\\\"album-pic\\\">&lt;div id=\\\"buffer-box\\\">加载中...&lt;/div>&lt;/div>&lt;div id=\\\"player-controls\\\">&lt;div class=\\\"control\\\">&lt;div class=\\\"player-button\\\" id=\\\"play-previous\\\">&lt;i class=\\\"fas fa-backward\\\">&lt;/i>&lt;/div>&lt;/div>&lt;div class=\\\"control\\\">&lt;div class=\\\"player-button\\\" id=\\\"play-pause-button\\\">&lt;i class=\\\"fas fa-play\\\">&lt;/i>&lt;/div>&lt;/div>&lt;div class=\\\"control\\\">&lt;div class=\\\"player-button\\\" id=\\\"play-next\\\">&lt;i class=\\\"fas fa-forward\\\">&lt;/i>&lt;/div>&lt;/div>&lt;/div>&lt;/div>&lt;/div>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> playerTrack <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#player-track\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        albumName <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#album-name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        trackName <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#track-name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        albumArt <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#album-art'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        sArea <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#s-area'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        seekBar <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#seek-bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        trackTime <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#track-time'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        insTime <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#ins-time'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        sHover <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#s-hover'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        playPauseButton <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#play-pause-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        i <span class=\"token operator\">=</span> playPauseButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tProgress <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#current-time'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        tTime <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#track-length'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        seekT<span class=\"token punctuation\">,</span> seekLoc<span class=\"token punctuation\">,</span> seekBarPos<span class=\"token punctuation\">,</span> cM<span class=\"token punctuation\">,</span> ctMinutes<span class=\"token punctuation\">,</span> ctSeconds<span class=\"token punctuation\">,</span> curMinutes<span class=\"token punctuation\">,</span> curSeconds<span class=\"token punctuation\">,</span> durMinutes<span class=\"token punctuation\">,</span> durSeconds<span class=\"token punctuation\">,</span> playProgress<span class=\"token punctuation\">,</span> bTime<span class=\"token punctuation\">,</span> nTime <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        buffInterval <span class=\"token operator\">=</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">,</span>\n        tFlag <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        playPreviousTrackButton <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#play-previous'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        playNextTrackButton <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#play-next'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">playPause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">paused</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                playerTrack<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">checkBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                i<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fas fa-pause'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                audio<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                playerTrack<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>buffInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'buffering'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                i<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fas fa-play'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                audio<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">showHover</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        seekBarPos <span class=\"token operator\">=</span> sArea<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">offset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        seekT <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span><span class=\"token property-access\">clientX</span> <span class=\"token operator\">-</span> seekBarPos<span class=\"token punctuation\">.</span><span class=\"token property-access\">left</span><span class=\"token punctuation\">;</span>\n        seekLoc <span class=\"token operator\">=</span> audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">duration</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>seekT <span class=\"token operator\">/</span> sArea<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">outerWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sHover<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">width</span><span class=\"token punctuation\">(</span>seekT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        cM <span class=\"token operator\">=</span> seekLoc <span class=\"token operator\">/</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n        ctMinutes <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">floor</span><span class=\"token punctuation\">(</span>cM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ctSeconds <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">floor</span><span class=\"token punctuation\">(</span>seekLoc <span class=\"token operator\">-</span> ctMinutes <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>ctMinutes <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>ctSeconds <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ctMinutes <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> ctMinutes <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">+</span> ctMinutes<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ctSeconds <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> ctSeconds <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">+</span> ctSeconds<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>ctMinutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>ctSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> insTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'--:--'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> insTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span>ctMinutes <span class=\"token operator\">+</span> <span class=\"token string\">':'</span> <span class=\"token operator\">+</span> ctSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        insTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">css</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'left'</span><span class=\"token operator\">:</span> seekT<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'margin-left'</span><span class=\"token operator\">:</span> <span class=\"token string\">'-21px'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fadeIn</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">hideHover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        sHover<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">width</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        insTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">css</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'left'</span><span class=\"token operator\">:</span> <span class=\"token string\">'0px'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'margin-left'</span><span class=\"token operator\">:</span> <span class=\"token string\">'0px'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fadeOut</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">playFromClickedPos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">currentTime</span> <span class=\"token operator\">=</span> seekLoc<span class=\"token punctuation\">;</span>\n        seekBar<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">width</span><span class=\"token punctuation\">(</span>seekT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">hideHover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">updateCurrTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        nTime <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        nTime <span class=\"token operator\">=</span> nTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tFlag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            tFlag <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            trackTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        curMinutes <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">floor</span><span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">currentTime</span> <span class=\"token operator\">/</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        curSeconds <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">floor</span><span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">currentTime</span> <span class=\"token operator\">-</span> curMinutes <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        durMinutes <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">floor</span><span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">duration</span> <span class=\"token operator\">/</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        durSeconds <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">floor</span><span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">duration</span> <span class=\"token operator\">-</span> durMinutes <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        playProgress <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">currentTime</span> <span class=\"token operator\">/</span> audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">duration</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>curMinutes <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> curMinutes <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">+</span> curMinutes<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>curSeconds <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> curSeconds <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">+</span> curSeconds<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>durMinutes <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> durMinutes <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">+</span> durMinutes<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>durSeconds <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> durSeconds <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">+</span> durSeconds<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>curMinutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>curSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> tProgress<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> tProgress<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span>curMinutes <span class=\"token operator\">+</span> <span class=\"token string\">':'</span> <span class=\"token operator\">+</span> curSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>durMinutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>durSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> tTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> tTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span>durMinutes <span class=\"token operator\">+</span> <span class=\"token string\">':'</span> <span class=\"token operator\">+</span> durSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>curMinutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>curSeconds<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>durMinutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>durSeconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> trackTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> trackTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        seekBar<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">width</span><span class=\"token punctuation\">(</span>playProgress <span class=\"token operator\">+</span> <span class=\"token string\">'%'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>playProgress <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            i<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fa fa-play'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            seekBar<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">width</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            tProgress<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'buffering'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>buffInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">checkBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>buffInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        buffInterval <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>nTime <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>bTime <span class=\"token operator\">-</span> nTime<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'buffering'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">else</span> albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'buffering'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            bTime <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            bTime <span class=\"token operator\">=</span> bTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">selectTrack2</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">flag</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//歌单api调用 https://api.uomg.com/doc-rand.music.html</span>\n        $<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getJSON</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.uomg.com/api/rand.music?'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n            sort<span class=\"token operator\">:</span> <span class=\"token string\">\"热歌榜\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//选择输出分类[热歌榜|新歌榜|飙升榜|抖音榜|电音榜]，为空输出热歌榜</span>\n            <span class=\"token comment\">// mid: 12345,    歌单 id</span>\n            <span class=\"token comment\">// sort mid 二选一</span>\n            format<span class=\"token operator\">:</span> <span class=\"token string\">'json'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">json<span class=\"token punctuation\">,</span> textStatus</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">.</span><span class=\"token property-access\">code</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> i<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fa fa-play'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                    albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'buffering'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    i<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fa fa-pause'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                seekBar<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">width</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                trackTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                tProgress<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                tTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                currAlbum <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">artistsname</span><span class=\"token punctuation\">;</span>\n                currTrackName <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">;</span>\n                currArtwork <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">picurl</span><span class=\"token punctuation\">;</span>\n                audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">src</span> <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">url</span><span class=\"token punctuation\">;</span>\n                nTime <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n                bTime <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                bTime <span class=\"token operator\">=</span> bTime<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    audio<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    playerTrack<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>buffInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token function\">checkBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                albumName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span>currAlbum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                trackName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">text</span><span class=\"token punctuation\">(</span>currTrackName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                albumArt<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">'img.active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#album-pic'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#album-pic'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span>currArtwork<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">initPlayer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        audio <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Audio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">selectTrack2</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//非0自动播放</span>\n        audio<span class=\"token punctuation\">.</span><span class=\"token property-access\">loop</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        playPauseButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> playPause<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sArea<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">mousemove</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">showHover</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sArea<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">mouseout</span><span class=\"token punctuation\">(</span>hideHover<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sArea<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> playFromClickedPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timeupdate'</span><span class=\"token punctuation\">,</span> updateCurrTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        playPreviousTrackButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">selectTrack2</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        playNextTrackButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">selectTrack2</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">initPlayer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"css\"><a href=\"#css\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CSS</h4>\n<p>自定义 CSS 中加入</p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token selector\">#dowebok</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">right</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">430</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin</span> <span class=\"token number\">100</span><span class=\"token unit\">px</span> auto <span class=\"token number\">100</span><span class=\"token unit\">px</span></span>\n\n<span class=\"token selector\">#player</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> relative</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">3</span></span>\n\n<span class=\"token selector\">#player-track</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">right</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span> <span class=\"token number\">13</span><span class=\"token unit\">px</span> <span class=\"token number\">22</span><span class=\"token unit\">px</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span> <span class=\"token number\">184</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#fff7f7</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.3</span><span class=\"token unit\">s</span> ease top</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">1</span></span>\n\n  <span class=\"token selector\">&amp;.active</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">-80</span><span class=\"token unit\">px</span></span>\n\n<span class=\"token selector\">#album-name</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#54576f</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">17</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-weight</span> bold</span>\n\n<span class=\"token selector\">#track-name</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#acaebd</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">11</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">white-space</span><span class=\"token punctuation\">:</span> nowrap<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">text-overflow</span><span class=\"token punctuation\">:</span>ellipsis<span class=\"token punctuation\">;</span></span>\n\n<span class=\"token selector\">#track-time</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">12</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin-bottom</span> <span class=\"token number\">3</span><span class=\"token unit\">px</span></span>\n\n  <span class=\"token selector\">&amp;.active</span>\n    <span class=\"token selector\">#current-time<span class=\"token punctuation\">,</span> #track-length</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#f86d92</span><span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token color\">transparent</span></span>\n\n<span class=\"token selector\">#current-time</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">float</span> left</span>\n\n<span class=\"token selector\">#track-length</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">float</span> right</span>\n\n<span class=\"token selector\">#current-time<span class=\"token punctuation\">,</span>\n#track-length</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token color\">transparent</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">11</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#ffe8ee</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.3</span><span class=\"token unit\">s</span> ease all</span>\n\n\n<span class=\"token selector\">#s-area<span class=\"token punctuation\">,</span>\n#seek-bar</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> relative</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">4</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">4</span><span class=\"token unit\">px</span></span>\n\n<span class=\"token selector\">#s-area</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#ffe8ee</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">cursor</span> pointer</span>\n\n<span class=\"token selector\">#ins-time</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">-29</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#fff</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">12</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">white-space</span> pre</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span> <span class=\"token number\">5</span><span class=\"token unit\">px</span> <span class=\"token number\">6</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">4</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">display</span> none<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#3b3d50</span></span>\n\n<span class=\"token selector\">#s-hover</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">bottom</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">0.2</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">2</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#3b3d50</span></span>\n\n\n<span class=\"token selector\">#seek-bar</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">content</span> <span class=\"token string\">''</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">bottom</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#fd6d94</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.2</span><span class=\"token unit\">s</span> ease width</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">1</span></span>\n\n<span class=\"token selector\">#player-content</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> relative</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#fff</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">box-shadow</span> <span class=\"token number\">0</span> <span class=\"token number\">30</span><span class=\"token unit\">px</span> <span class=\"token number\">80</span><span class=\"token unit\">px</span> <span class=\"token hexcode\">#656565</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">2</span></span>\n\n<span class=\"token selector\">#album-art</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">-40</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">115</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">115</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin-left</span> <span class=\"token number\">40</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transform</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.3</span><span class=\"token unit\">s</span> ease all</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">box-shadow</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span> <span class=\"token hexcode\">#fff</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">overflow</span> hidden</span>\n\n  <span class=\"token selector\">.buffering</span>\n    <span class=\"token selector\">#buffer-box</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">1</span></span>\n\n    <span class=\"token selector\">img</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">0.25</span></span>\n\n      <span class=\"token selector\">.active</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">0.8</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">filter</span> <span class=\"token func\"><span class=\"token function\">blur</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">)</span></span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">-webkit-filter</span> <span class=\"token func\"><span class=\"token function\">blur</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">)</span></span></span>\n\n  <span class=\"token selector\">img</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">display</span> block<span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute<span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">-1</span><span class=\"token punctuation\">;</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.1</span><span class=\"token unit\">s</span> linear all</span>\n\n    <span class=\"token selector\">&amp;.active</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span>\n\n  <span class=\"token selector\">&amp;.active</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">-60</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">box-shadow</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">4</span><span class=\"token unit\">px</span> <span class=\"token hexcode\">#fff7f7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token number\">30</span><span class=\"token unit\">px</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span> <span class=\"token number\">-15</span><span class=\"token unit\">px</span> <span class=\"token hexcode\">#afb7c1</span></span>\n\n    <span class=\"token selector\">img.active</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">-webkit-animation</span> rotateAlbumArt <span class=\"token number\">3</span><span class=\"token unit\">s</span> linear <span class=\"token number\">0</span><span class=\"token unit\">s</span> infinite forwards<span class=\"token punctuation\">;</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">animation</span> rotateAlbumArt <span class=\"token number\">3</span><span class=\"token unit\">s</span> linear <span class=\"token number\">0</span><span class=\"token unit\">s</span> infinite forwards<span class=\"token punctuation\">;</span></span>\n\n  <span class=\"token selector\">&amp;::before</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">content</span> <span class=\"token string\">''</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">right</span> <span class=\"token number\">0</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">0</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">margin</span> <span class=\"token number\">-10</span><span class=\"token unit\">px</span> auto <span class=\"token number\">0</span> auto</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#d6dee7</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">box-shadow</span> inset <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> <span class=\"token hexcode\">#fff</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">2</span></span>\n\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@-webkit-keyframes</span> rotateAlbumArt</span>\n  <span class=\"token selector\">0%</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token selector\">100%</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span></span></span>\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@keyframes</span> rotateAlbumArt</span>\n  <span class=\"token selector\">0%</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token selector\">100%</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token func\"><span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span></span></span>\n\n<span class=\"token selector\">#buffer-box</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">top</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">right</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">13</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#1f1f1f</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">13</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-family</span> Helvetica</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">text-align</span> center</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">font-weight</span> bold</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">line-height</span> <span class=\"token number\">1</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span> <span class=\"token number\">6</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin</span> <span class=\"token number\">-12</span><span class=\"token unit\">px</span> auto <span class=\"token number\">0</span> auto</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token func\"><span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.19</span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">opacity</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">z-index</span> <span class=\"token number\">2</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.1</span><span class=\"token unit\">s</span> linear all</span>\n\n<span class=\"token selector\">#player-controls</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">250</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin</span> <span class=\"token number\">0</span> <span class=\"token number\">5</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span> <span class=\"token number\">141</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">float</span> right</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">overflow</span> hidden</span>\n\n<span class=\"token selector\">.control</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">33.333</span><span class=\"token unit\">%</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">float</span> left</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span> <span class=\"token number\">12</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span></span>\n\n<span class=\"token selector\">.player-button</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span> <span class=\"token number\">25</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#fff</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">6</span><span class=\"token unit\">px</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">cursor</span> pointer</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.2</span><span class=\"token unit\">s</span> ease all</span>\n\n  <span class=\"token selector\">i</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">display</span> block</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#d6dee7</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">26</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">text-align</span> center</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">line-height</span> <span class=\"token number\">1</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">transition</span> <span class=\"token number\">0.2</span><span class=\"token unit\">s</span> ease all</span>\n\n  <span class=\"token selector\">&amp;:hover</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#d6d6de</span></span>\n\n    <span class=\"token selector\">i</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#fff</span></span>\n\n<span class=\"token atrule-declaration\"><span class=\"token atrule\">@media</span> <span class=\"token punctuation\">(</span>max-width<span class=\"token punctuation\">:</span><span class=\"token number\">768</span><span class=\"token unit\">px</span><span class=\"token punctuation\">)</span></span>\n  <span class=\"token selector\">#dowebok</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">95</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">20</span><span class=\"token unit\">vw</span></span>\n\n  <span class=\"token selector\">#player-controls</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">175</span><span class=\"token unit\">px</span></span>\n\n  <span class=\"token selector\">.player-button</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span></span>\n\n    <span class=\"token selector\">i</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span></span>\n\n    <span class=\"token selector\">&amp;:hover</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">background-color</span> <span class=\"token hexcode\">#0000</span></span>\n\n      <span class=\"token selector\">i</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">color</span> <span class=\"token hexcode\">#d6dee7</span></span>\n\n  <span class=\"token selector\">#album-art</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">30</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">0</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">padding-bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token unit\">%</span></span>\n\n  <span class=\"token selector\">#album-name</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">15</span><span class=\"token unit\">px</span></span>\n\n  <span class=\"token selector\">#track-name</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">font-size</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>上方的 css 可在 JS 中引进去，或者在需要的界面加进去\n不建议加到全局，毕竟不是所有界面都需要（其实影响也不是很大）</p>\n<h4 id=\"html\"><a href=\"#html\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>HTML</h4>\n<p>需要加载的页面（md 或者 ejs）中加入</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dowebok<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>可能会出现遮挡问题，自己通过 <code>&#x3C;br></code> 调整就好了</p>\n<p>js 和 css，源自<a href=\"https://www.yanghuaxing.com/blog/547.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">链接</a>\n稍作修改，手机端适配我可能没怎么写好 <del>(就那么几行能适配完美才怪)</del>\n暗黑模式也没适配这个\n音乐来源见 js 代码块的 114、115 行，可选自己的网易歌单或者热歌榜等排行榜</p>\n<p>直接把源码部署到一个地方拿来代替用也非常不错，毕竟很好看，再用 Edge 安装在电脑上，嘻嘻嘻</p>\n<h3 id=\"可交互复选框\"><a href=\"#%E5%8F%AF%E4%BA%A4%E4%BA%92%E5%A4%8D%E9%80%89%E6%A1%86\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>可交互复选框</h3>\n<p><sup id=\"fnref-4\"><a href=\"#fn-4\" class=\"footnote-ref\">4</a></sup></p>\n<p>已 PR 至主题，可前往主题更新并通过 Tag 标签使用\n但主题只内置了方形选框，下方新增</p>\n<div><input type=\"radio\" disabled=\"\" checked=\"\"><p>圆形选框</p></div>\n<div><input type=\"checkbox\" disabled=\"\" checked=\"\"><p>方形选框</p></div>\n<div><input type=\"checkbox\" class=\"red\" disabled=\"\" checked=\"\"><p>可选颜色</p></div>\n<p>下方只介绍 HTML 用法\n自定义 CSS 中添加以下代码</p>\n<pre class=\"language-css line-numbers\"><code class=\"language-css\">input\n  <span class=\"token property\">-webkit-appearance</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">-moz-appearance</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">-ms-appearance</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">-o-appearance</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">appearance</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">right</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span>all <span class=\"token number\">.15</span><span class=\"token unit\">s</span> ease-out <span class=\"token number\">0</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#fff</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span> pointer<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> <span class=\"token number\">.4</span><span class=\"token unit\">rem</span> <span class=\"token number\">.2</span><span class=\"token unit\">rem</span> <span class=\"token number\">.4</span><span class=\"token unit\">rem</span> <span class=\"token important\">!important</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">outline</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">/* Checkbox */</span>\ninput[type=checkbox]\n  <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> <span class=\"token number\">-0.65</span><span class=\"token unit\">rem</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>before<span class=\"token punctuation\">,</span> &amp;<span class=\"token punctuation\">:</span>after\n    <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#fff</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> all <span class=\"token number\">.2</span><span class=\"token unit\">s</span> ease-in-out<span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-moz-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-ms-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-o-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>after\n    <span class=\"token property\">right</span><span class=\"token punctuation\">:</span> <span class=\"token number\">9</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-webkit-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-moz-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-ms-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">-o-transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token unit\">deg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transition-delay</span><span class=\"token punctuation\">:</span> <span class=\"token number\">.2</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>checked\n    &amp;<span class=\"token punctuation\">:</span>before\n      <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n\n    &amp;<span class=\"token punctuation\">:</span>after\n      <span class=\"token property\">right</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">14</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/* radio */</span>\ninput[type=radio]\n  <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> <span class=\"token number\">-0.7</span><span class=\"token unit\">rem</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> <span class=\"token number\">.2</span><span class=\"token unit\">rem</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> all ease-out <span class=\"token number\">250</span><span class=\"token unit\">ms</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span><span class=\"token property\">checked</span><span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/* Colors */</span>\ninput[type=checkbox]\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#4caf50</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>checked<span class=\"token punctuation\">,</span> &amp;<span class=\"token punctuation\">:</span>indeterminate\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#4caf50</span><span class=\"token punctuation\">;</span>\n\ninput[type=radio]\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#4caf50</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span><span class=\"token property\">checked</span><span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#4caf50</span><span class=\"token punctuation\">;</span>\n\ninput[type=checkbox].<span class=\"token color\">blue</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#2196f3</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>checked<span class=\"token punctuation\">,</span> &amp;<span class=\"token punctuation\">:</span>indeterminate\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#2196f3</span><span class=\"token punctuation\">;</span>\n\ninput[type=radio].<span class=\"token color\">blue</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#2196f3</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span><span class=\"token property\">checked</span><span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#2196f3</span><span class=\"token punctuation\">;</span>\n\ninput[type=checkbox].<span class=\"token color\">red</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#f44336</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>checked<span class=\"token punctuation\">,</span> &amp;<span class=\"token punctuation\">:</span>indeterminate\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#f44336</span><span class=\"token punctuation\">;</span>\n\ninput[type=radio].<span class=\"token color\">red</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#f44336</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span><span class=\"token property\">checked</span><span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#f44336</span><span class=\"token punctuation\">;</span>\n\ninput[type=checkbox].<span class=\"token color\">orange</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#ffc107</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span>checked<span class=\"token punctuation\">,</span> &amp;<span class=\"token punctuation\">:</span>indeterminate\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#ffc107</span><span class=\"token punctuation\">;</span>\n\ninput[type=radio].<span class=\"token color\">orange</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">px</span> solid <span class=\"token hexcode color\">#ffc107</span><span class=\"token punctuation\">;</span>\n\n  &amp;<span class=\"token punctuation\">:</span><span class=\"token property\">checked</span><span class=\"token punctuation\">:</span>before\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode color\">#ffc107</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>用法</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<div><input type=\"checkbox\" class=\"green\" disabled=\"\"><p>左边是 <code>type=checkbox</code></p></div>\n<div><input type=\"radio\" disabled=\"\"><p>左边是 <code>type=radio</code></p></div>\n<p>默认绿色，设置颜色，只需要加上 class 就行。\n目前 class 有 <code>blue</code> <code>red</code> <code>orange</code>，可自行更改 CSS</p>\n<p>默认是方形没有打勾，圆形没有选中\n加上 chencked 就会默认选中\n如下方代码</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">chencked</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<div><input type=\"checkbox\" class=\"blue\" disabled=\"\" checked=\"\"><p>左边是选中的</p></div>\n<div><input class=\"red\" type=\"radio\" checked=\"\" disabled=\"\"><p>左边是选中的</p></div>\n<h3 id=\"球形标签云\"><a href=\"#%E7%90%83%E5%BD%A2%E6%A0%87%E7%AD%BE%E4%BA%91\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>球形标签云</h3>\n<p><sup id=\"fnref-5\"><a href=\"#fn-5\" class=\"footnote-ref\">5</a></sup></p>\n<p><code>hexo-tag-cloud</code> 插件是 MikeCoder 写的一个 Hexo 博客的标签云插件</p>\n<figure><img src=\"https://cos.royce2003.top/db44ecae/03.webp-default\" alt=\"GIF.gif\"><figcaption>GIF.gif</figcaption></figure>\n<h4 id=\"安装插件\"><a href=\"#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>安装插件</h4>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> hexo-tag-cloud@^2.1.* --save<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>在 <code>fluid\\layout\\tags.ejs</code> 中加入如下代码</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\">&lt;% if (site.tags.length) { %>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text-center<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;%- url_for(<span class=\"token punctuation\">'</span>/js/tagcloud.js<span class=\"token punctuation\">'</span>) %><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>&lt;%- url_for(<span class=\"token punctuation\">'</span>/js/tagcanvas.js<span class=\"token punctuation\">'</span>) %><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>widget-wrap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>myCanvasContainer<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>widget tagcloud<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>250<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>250<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>resCanvas<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\">width=<span class=\"token number\">100</span><span class=\"token unit\">%</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          &lt;%- tagcloud() %>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n&lt;% } %><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"开启\"><a href=\"#%E5%BC%80%E5%90%AF\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>开启</h4>\n<p>根目录配置文件添加如下的配置</p>\n<pre class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token comment\"># hexo-tag-cloud</span>\n<span class=\"token key atrule\">tag_cloud</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">textFont</span><span class=\"token punctuation\">:</span> Trebuchet MS<span class=\"token punctuation\">,</span> Helvetica\n    <span class=\"token key atrule\">textColor</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'#333'</span>\n    <span class=\"token key atrule\">textHeight</span><span class=\"token punctuation\">:</span> <span class=\"token number\">25</span>\n    <span class=\"token key atrule\">outlineColor</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'#E2E1D1'</span>\n    <span class=\"token key atrule\">maxSpeed</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.5</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><code>textColor</code>: 字体颜色\n<code>textHeight</code>: 字体高度\n<code>maxSpeed</code>: 文字滚动速度</p>\n<h3 id=\"代码块仿-mac\"><a href=\"#%E4%BB%A3%E7%A0%81%E5%9D%97%E4%BB%BF-mac\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>代码块仿 Mac</h3>\n<p>源网</p>\n<pre class=\"language-stylus line-numbers\"><code class=\"language-stylus\"><span class=\"token selector\">.markdown-body</span>\n  <span class=\"token selector\">pre</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">padding-bottom</span> <span class=\"token number\">5</span><span class=\"token unit\">px</span></span>\n\n    <span class=\"token selector\">code</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">padding</span> <span class=\"token number\">1</span><span class=\"token unit\">rem</span> <span class=\"token number\">0</span> <span class=\"token number\">.5</span><span class=\"token unit\">rem</span> <span class=\"token number\">0</span></span>\n\n      <span class=\"token selector\">&amp;::before</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">content</span> <span class=\"token string\">' '</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">position</span> absolute</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">background</span> <span class=\"token hexcode\">#fc625d</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">box-shadow</span> <span class=\"token number\">20</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span> <span class=\"token hexcode\">#fdbc40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token unit\">px</span> <span class=\"token number\">0</span> <span class=\"token hexcode\">#35cd4b</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">margin-top</span> <span class=\"token number\">-20</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">left</span> <span class=\"token number\">12</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">height</span> <span class=\"token number\">12</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">width</span> <span class=\"token number\">12</span><span class=\"token unit\">px</span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<hr>\n<h3 id=\"最后\"><a href=\"#%E6%9C%80%E5%90%8E\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>最后</h3>\n<p>应该没啥可折腾的了，还有的话也不新开文章了，就这里持续更新吧，会置顶并将最近一次更新写在摘要中\n暗黑模式下篇文章再写吧 <del>(水文章数量)</del></p>\n<p>作者已经把主题做的非常完美了，有什么问题都会立马修复，功能也出的很快，超 nice</p>\n<p>博客刚搭建的时候用了一个 material 主题，觉得过于平淡，换到了一个 gal 主题，功能很多\n慢慢的又看厌了，很多人推荐 Next，就又换到了 Next，的确很好用\n就光针对 Next 的教程数量而言，应该能算是大部分用 Hexo 的人都用过的\n经常逛博客也发现很多都是用的这个主题，用了几个月，改了很多东西，但也慢慢看厌了</p>\n<p>就开始再次踏上寻找主题的路，经常看到一个好看的主题，但又想到自己在 Next 上大量的自定义内容，一直不忍心丢下\n看到 Fluid 之后超喜欢，先用 Fluid 搭建了副站，放在 Gitee 上，慢慢完善\n完善到一定程度，有人和我说副站更好看，我看了看好像真是这么回事...\n才下定决心开始换主题，前前后后花了一个多星期全部完成</p>\n<p>Fluid 应该是会一直用下去了\n不过仍有继续折腾的打算\n可能会再用 Typecho 搭建一个玩玩...</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>参考: <a href=\"https://www.51qianduan.com/article/3115.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">纯css3全屏图片背景缩小渐变式切换特效</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p>参考: <a href=\"https://bestzuo.cn/posts/blog-establish.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hexo博客+Next主题深度优化与定制</a></p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-3\">\n<p>参考: <a href=\"https://www.yanghuaxing.com/blog/547.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">网易云HTML5音乐随机播放器</a></p>\n<a href=\"#fnref-3\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-4\">\n<p>参考: <a href=\"http://www.htmleaf.com/css3/css3donghua/201806235190.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">带点击动画特效的CSS3单选框和复选框</a></p>\n<a href=\"#fnref-4\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-5\">\n<p>参考: <a href=\"https://github.com/MikeCoder/hexo-tag-cloud\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MikeCoder/hexo-tag-cloud</a></p>\n<a href=\"#fnref-5\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"P3368 【模板】树状数组 2","path":"/posts/fenwick-tree-2/","cover_image":null,"date":"March 26. 2020","timeToRead":3,"cjkWordCount":742,"cjkReadTime":4,"description":"","content":"<h3 id=\"题目\"><a href=\"#%E9%A2%98%E7%9B%AE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目</h3>\n<p><sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h4 id=\"题目描述\"><a href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目描述</h4>\n<p>如题，已知一个数列，你需要进行下面两种操作：</p>\n<ol>\n<li>将某区间每一个数数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span>；</li>\n<li>\n<p>求出某一个数的值。</p>\n<!--more-->\n</li>\n</ol>\n<h4 id=\"输入格式\"><a href=\"#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入格式</h4>\n<p>第一行包含两个整数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span>、<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">M</span></span></span></span>，分别表示该数列数字的个数和操作的总个数。</p>\n<p>第二行包含 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 个用空格分隔的整数，其中第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 个数字表示数列第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 项的初始值。</p>\n<p>接下来 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">M</span></span></span></span>行每行包含 2 或 4 个整数，表示一个操作，具体如下：</p>\n<p>操作 1： 格式：<code>1 x y k</code> 含义：将区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x,y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 内每个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span>；</p>\n<p>操作 2： 格式：<code>2 x</code> 含义：输出第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span> 个数的值。</p>\n<h4 id=\"输出格式\"><a href=\"#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输出格式</h4>\n<p>输出包含若干行整数，即为所有操作 2 的结果。</p>\n<h4 id=\"输入输出样例\"><a href=\"#%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%A0%B7%E4%BE%8B\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入输出样例</h4>\n<p><strong>输入 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">5 5\n1 5 4 2 3\n1 2 4 2\n2 3\n1 1 5 -1\n1 3 5 7\n2 4<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>输出 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">6\n10<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<h4 id=\"说明提示\"><a href=\"#%E8%AF%B4%E6%98%8E%E6%8F%90%E7%A4%BA\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>说明/提示</h4>\n<h5 id=\"样例-1-解释：\"><a href=\"#%E6%A0%B7%E4%BE%8B-1-%E8%A7%A3%E9%87%8A%EF%BC%9A\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>样例 1 解释：</h5>\n<figure><img src=\"https://cos.royce2003.top/49770/01.webp-default\" alt=\"解释\"><figcaption>解释</figcaption></figure>\n<p>故输出结果为 6、10。</p>\n<hr>\n<h5 id=\"数据规模与约定\"><a href=\"#%E6%95%B0%E6%8D%AE%E8%A7%84%E6%A8%A1%E4%B8%8E%E7%BA%A6%E5%AE%9A\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>数据规模与约定</h5>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>30</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">30\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>≤</mo><mn>8</mn><mo separator=\"true\">,</mo><mi>M</mi><mo>≤</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">N\\le8,M\\le10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\">8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span>；</p>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>70</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">70\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>≤</mo><mn>10000</mn><mo separator=\"true\">,</mo><mi>M</mi><mo>≤</mo><mn>10000</mn></mrow><annotation encoding=\"application/x-tex\">N\\le 10000,M\\le10000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span></span></span></span>；</p>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>N</mi><mo separator=\"true\">,</mo><mi>M</mi><mo>≤</mo><mn>500000</mn></mrow><annotation encoding=\"application/x-tex\">1 \\leq N, M\\le 500000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1 \\leq x, y \\leq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304100000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span>，保证任意时刻序列中任意元素的绝对值都不大于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>30</mn></msup></mrow><annotation encoding=\"application/x-tex\">2^{30}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span></span>。</p>\n<h3 id=\"题解\"><a href=\"#%E9%A2%98%E8%A7%A3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题解</h3>\n<p>上一篇文章已经讲了<code>树状数组 1</code>，单点修改区间查询。</p>\n<p>树状数组 2 需要实现的是区间修改，单点查询。</p>\n<p>并且树状数组 2 要完全依赖于树状数组 1，仅在 1 的基础上引入差分数组</p>\n<p>通过差分数组将其转换为单点修改区间查询，没错，就是树状数组 1，的单点修改区间查询</p>\n<p>说到差分我就想到了 xzt 卖煎饼，想到 xzt 卖煎饼我就想到了暴力 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nm)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">n</span><span class=\"mord mathdefault\">m</span><span class=\"mclose\">)</span></span></span></span> 解法，想到这个解法就想到了我是多么菜鸡<img src=\"https://cos.royce2003.top/49770/02.webp-default\" data-align=\"inline\"></p>\n<h4 id=\"前置知识-差分数组\"><a href=\"#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-%E5%B7%AE%E5%88%86%E6%95%B0%E7%BB%84\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>前置知识 差分数组</h4>\n<p>现有一序列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span></span></span></span></p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mn>3</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>1</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>1</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>5</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>9</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>2</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>6</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>5</mn></mrow></mrow><annotation encoding=\"application/x-tex\">A={3,\\,1,\\,4,\\,1,\\,5,\\,9,\\,2,\\,6,\\,5}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">9</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">5</span></span></span></span></span></span>\n<p>建立一个差分数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span></span></span></span>，使得 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><msub><mi>A</mi><mi>i</mi></msub><mo>−</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_i=A_i-A_{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>=</mo><mrow><mn>3</mn><mo separator=\"true\">,</mo><mtext>  </mtext><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>3</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>3</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>7</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding=\"application/x-tex\">D={3,\\;-2,\\,3,\\,-3,\\,4,\\,4,\\,-7,\\,4,\\,-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span></span></span>\n<p>此时将 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span></span></span></span> 序列中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mn>3</mn></msub><mo>∼</mo><msub><mi>A</mi><mn>5</mn></msub></mrow><annotation encoding=\"application/x-tex\">A_3 \\sim A_5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 都加上 3，得到新的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span></span></span></span></p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mn>3</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>1</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>7</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>8</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>9</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>2</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>6</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>5</mn></mrow></mrow><annotation encoding=\"application/x-tex\">A={3,\\,1,\\,7,\\,4,\\,8,\\,9,\\,2,\\,6,\\,5}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">9</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">5</span></span></span></span></span></span>\n<p>此时再更新 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 数组</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>=</mo><mrow><mn>3</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>6</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>3</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>1</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>7</mn><mo separator=\"true\">,</mo><mtext> </mtext><mn>4</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>1</mn></mrow></mrow><annotation encoding=\"application/x-tex\">D={3,\\,-2,\\,6,\\,-3,\\,4,\\,1,\\,-7,\\,4,\\,-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span></span></span>\n<p>不难发现，在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span></span></span></span> 序列的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>∼</mo><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i \\sim A_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 区间分别加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span> ，在差分数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 中就相当于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mtext>  </mtext><mo>+</mo><mo>=</mo><mtext>  </mtext><mi>n</mi><mo separator=\"true\">,</mo><mtext>  </mtext><msub><mi>D</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mtext>  </mtext><mo>−</mo><mo>=</mo><mtext>  </mtext><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">D_i\\;+=\\; n,\\;D_{j+1}\\;-=\\;n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">+</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span></p>\n<p>相信聪明的你已经发现了，这里出现了树状数组 1的单点修改</p>\n<h4 id=\"查询\"><a href=\"#%E6%9F%A5%E8%AF%A2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>查询</h4>\n<p>这个也就变的很简单了，利用差分数组的性质，假设我们要求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">A_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>那么</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mn>3</mn></msub><mo>=</mo><msub><mi>D</mi><mn>1</mn></msub><mo>+</mo><msub><mi>D</mi><mn>2</mn></msub><mo>+</mo><msub><mi>D</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">A_3=D_1+D_2+D_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>\n<p>好啦，就是这么简单</p>\n<h3 id=\"结束\"><a href=\"#%E7%BB%93%E6%9D%9F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>结束</h3>\n<p>附上 AC 代码</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;cstdio></span></span>\n\n<span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span>m<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">,</span>x<span class=\"token punctuation\">,</span>aa<span class=\"token punctuation\">,</span>l<span class=\"token punctuation\">,</span>r<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> a<span class=\"token punctuation\">[</span><span class=\"token number\">500110</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">[</span><span class=\"token number\">500110</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">bool</span> flag <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">char</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>ch<span class=\"token operator\">&lt;</span><span class=\"token string\">'0'</span> <span class=\"token operator\">||</span> ch<span class=\"token operator\">></span><span class=\"token string\">'9'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ch <span class=\"token operator\">==</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">)</span> flag <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> ch <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>ch<span class=\"token operator\">>=</span><span class=\"token string\">'0'</span> <span class=\"token operator\">&amp;&amp;</span> ch<span class=\"token operator\">&lt;=</span><span class=\"token string\">'9'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>x <span class=\"token operator\">*=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>x <span class=\"token operator\">+=</span> ch<span class=\"token operator\">-</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span>ch<span class=\"token operator\">=</span><span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> flag <span class=\"token operator\">?</span> x<span class=\"token operator\">:</span><span class=\"token operator\">-</span>x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">&amp;</span> <span class=\"token operator\">-</span>x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">&lt;=</span>n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        c<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> k<span class=\"token punctuation\">;</span>\n        x <span class=\"token operator\">+=</span> <span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        sum <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        x <span class=\"token operator\">-=</span> <span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    n <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> m <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;=</span>n<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>a<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>m<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        aa <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>aa<span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            l <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> r <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">=</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>r<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            k <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>题目来源：<a href=\"https://www.luogu.com.cn/problem/P3368\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">P3368 【模板】树状数组 2 - 洛谷 | 计算机科学教育新生态</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"P3368 【模板】树状数组 1","path":"/posts/fenwick-tree-1/","cover_image":null,"date":"March 18. 2020","timeToRead":6,"cjkWordCount":1663,"cjkReadTime":8,"description":"","content":"<h2 id=\"题目\"><a href=\"#%E9%A2%98%E7%9B%AE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目</h2>\n<p><sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h4 id=\"题目描述\"><a href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题目描述</h4>\n<p>如题，已知一个数列，你需要进行下面两种操作：</p>\n<ul>\n<li>将某一个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span></li>\n<li>求出某区间每一个数的和</li>\n</ul>\n<!--more-->\n<h4 id=\"输入格式\"><a href=\"#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入格式</h4>\n<p>第一行包含两个正整数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span>，分别表示该数列数字的个数和操作的总个数。</p>\n<p>第二行包含 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">n</span></span></span></span> 个用空格分隔的整数，其中第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 个数字表示数列第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 项的初始值。</p>\n<p>接下来 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">m</span></span></span></span> 行每行包含 33 个整数，表示一个操作，具体如下：</p>\n<ul>\n<li><code>1 x k</code> 含义：将第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span> 个数加上 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span></li>\n<li><code>2 x y</code> 含义：输出区间 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[x,y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span> 内每个数的和</li>\n</ul>\n<h4 id=\"输出格式\"><a href=\"#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输出格式</h4>\n<p>输出包含若干行整数，即为所有操作 22 的结果。</p>\n<h4 id=\"输入输出样例\"><a href=\"#%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%A0%B7%E4%BE%8B\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>输入输出样例</h4>\n<p><strong>输入 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">5 5\n1 5 4 2 3\n1 1 3\n2 2 5\n1 3 -1\n1 4 2\n2 1 4<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>输出 #1</strong></p>\n<pre class=\"language-text line-numbers\"><code class=\"language-text\">14\n16<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<h4 id=\"说明提示\"><a href=\"#%E8%AF%B4%E6%98%8E%E6%8F%90%E7%A4%BA\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>说明/提示</h4>\n<p>【数据范围】</p>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>30</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">30\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mn>8</mn><mtext>，</mtext><mn>1</mn><mo>≤</mo><mi>m</mi><mo>≤</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">1 \\le n \\le 8，1\\le m \\le 10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.13597em;\"></span><span class=\"mord\">8</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span>；</p>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>70</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">70\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo separator=\"true\">,</mo><mtext> </mtext><mi>m</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup><mo separator=\"true\">;</mo></mrow><annotation encoding=\"application/x-tex\">1\\le n,\\,m\\le10^4;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304100000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.008548em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mpunct\">;</span></span></span></span></p>\n<p>对于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">%</span></span></span></span> 的数据，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>≤</mo><mn>5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\le n,m \\le 5\\times 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304100000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>。</p>\n<p>样例说明：</p>\n<p>故输出结果 14、16</p>\n<figure><img src=\"https://gitee.com/royce2003/blog/raw/master/img/2256.png\" alt=\"数据范围\"><figcaption>数据范围</figcaption></figure>\n<p>(写这篇呢其实是因为自己已经不会树状数组了，正好借此机会复习下 QAQ)</p>\n<h2 id=\"题解\"><a href=\"#%E9%A2%98%E8%A7%A3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>题解</h2>\n<h3 id=\"树状数组\"><a href=\"#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>树状数组</h3>\n<p>首先需要了解什么是 <code>树状数组</code></p>\n<p>树状数组用的是树结构的思想，即树型逻辑结构，但他不是树形结构啦</p>\n<h4 id=\"特点\"><a href=\"#%E7%89%B9%E7%82%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>特点</h4>\n<blockquote>\n<p>树状数组 (Binary Indexed Tree(B.I.T), Fenwick Tree)是一个查询和修改复杂度都为 og(n) 的数据结构。主要用于查询任意两位之间的所有元素之和，但是每次只能修改一个元素的值；经过简单修改可以在 log(n) 的复杂度下进行范围修改，但是这时只能查询其中一个元素的值(如果加入多个辅助数组则可以实现区间修改与区间查询)。</p>\n</blockquote>\n<p>对于这题，简单来说就是单点修改区间查询，一般地，树状数组不支持区间修改单点差选，但是我们也有办法让他支持.....</p>\n<p>树状数组的优势就在于其维护的时间复杂度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mtext> </mtext><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(log \\, n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">n</span><span class=\"mclose\">)</span></span></span></span> ，而类似的前缀和数组维护的时间复杂度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">n</span><span class=\"mclose\">)</span></span></span></span>，两者的查询都是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>（说到这我就想起来某次校内赛的xzt买煎饼。。。。还好我拿了20分）</p>\n<h3 id=\"前置知识\"><a href=\"#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>前置知识</h3>\n<h4 id=\"lowbit\"><a href=\"#lowbit\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>lowbit</h4>\n<p>实际上，对于树状数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>r</mi><mi>e</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">tree</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">e</span></span></span></span> 的每一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span>，其实际意义应该为：算上其本身的讯息，总共存储了 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span> 个元素的信息，其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 表示 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span> 在二进制下，末尾零的个数，同时也可以表示最小的含 1 位的二进制权值——换句话讲，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span> 即可表示成：对于每个二进制意义下的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">i</span></span></span></span>，从最末位数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 位，保留这 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 位并删除 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 位以左的所有数位上的数，留下的新二进制数的实际大</p>\n<figure><img src=\"https://gitee.com/royce2003/blog/raw/master/img/0dd7912397dda14482d369acbfb7d0a20df486d1.jpg\" alt=\"树状数组结构\"><figcaption>树状数组结构</figcaption></figure>\n<table>\n<thead>\n<tr>\n<th align=\"center\">十进制</th>\n<th align=\"center\">二进制</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">2</td>\n<td align=\"center\">10</td>\n</tr>\n<tr>\n<td align=\"center\">3</td>\n<td align=\"center\">11</td>\n</tr>\n<tr>\n<td align=\"center\">4</td>\n<td align=\"center\">100</td>\n</tr>\n<tr>\n<td align=\"center\">5</td>\n<td align=\"center\">101</td>\n</tr>\n<tr>\n<td align=\"center\">6</td>\n<td align=\"center\">110</td>\n</tr>\n<tr>\n<td align=\"center\">7</td>\n<td align=\"center\">111</td>\n</tr>\n<tr>\n<td align=\"center\">8</td>\n<td align=\"center\">1000</td>\n</tr>\n<tr>\n<td align=\"center\">9</td>\n<td align=\"center\">1001</td>\n</tr>\n<tr>\n<td align=\"center\">10</td>\n<td align=\"center\">1010</td>\n</tr>\n</tbody>\n</table>\n<p>图文并茂之后有没有看出点什么 QAQ</p>\n<p>记得当时学的时候，在学校大佬的帮助下才理解了这些东西，可能我比较菜吧</p>\n<p><del>没看出来就多看几遍吧</del> 好像也还是看不出来，那就记下来结论吧</p>\n<p>对于每一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span> 的最低含一位，即上文中的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>,可以借助一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">lowbit</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span></span></span></span> 函数实现 emmm 一个极其玄学的东西</p>\n<p>再把 <code>lowbit</code> 说简单点就是</p>\n<p>把一个整数变成二进制，从右往左找到第一个1，然后返回这个1所表示的十进制值。</p>\n<p>玄学公式登场 <code>x &#x26; -x</code></p>\n<p>举个例子</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>=</mo><mn>100</mn><mo separator=\"true\">,</mo><mtext> </mtext><mo>−</mo><mn>4</mn><mo>=</mo><mn>011</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>100</mn><mspace linebreak=\"newline\"></mspace><mtext> </mtext><mspace linebreak=\"newline\"></mspace><mo>∵</mo><mn>100</mn><mtext> </mtext><mi mathvariant=\"normal\">&amp;</mi><mtext> </mtext><mn>100</mn><mo>=</mo><mn>100</mn><mo>=</mo><mn>4</mn><mspace linebreak=\"newline\"></mspace><mtext> </mtext><mspace linebreak=\"newline\"></mspace><mo>∴</mo><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>4</mn><mspace linebreak=\"newline\"></mspace></mrow><annotation encoding=\"application/x-tex\">4 = 100,\\,-4 = 011 + 1 = 100\\\\\n~\\\\\n\\because100\\,\\&amp;\\,100=100=4 \\\\\n ~\\\\\n\\therefore lowbit(4)=4\\\\</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0em;vertical-align:0em;\"></span><span class=\"mspace nobreak\"> </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69224em;vertical-align:0em;\"></span><span class=\"mrel amsrm\">∵</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">&amp;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0em;vertical-align:0em;\"></span><span class=\"mspace nobreak\"> </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69224em;vertical-align:0em;\"></span><span class=\"mrel amsrm\">∴</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span><span class=\"mopen\">(</span><span class=\"mord\">4</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span></span><span class=\"mspace newline\"></span></span></span></span>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">&amp;</span> <span class=\"token operator\">-</span>x<span class=\"token punctuation\">;</span> <span class=\"token comment\">//就是这么玄学</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span></span></code></pre>\n<p>为什么要这样干呢</p>\n<p>我们先列出 1~8 的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">lowbit</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mtext>  </mtext><mn>2</mn><mtext>  </mtext><mn>1</mn><mtext>  </mtext><mn>4</mn><mtext>  </mtext><mn>1</mn><mtext>  </mtext><mn>2</mn><mtext>  </mtext><mn>1</mn><mtext>  </mtext><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">1\\;2\\;1\\;4\\;1\\;2\\;1\\;8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">8</span></span></span></span></p>\n<p>我们让 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span></span></span></span> 管理 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mtext> </mtext><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">A[i-lowbit(i)+1,\\,i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span></span></span></span> 这段区间，如下图</p>\n<figure><img src=\"https://gitee.com/royce2003/blog/raw/master/img/Snipaste_03-19_11-45-31.png\" alt=\"对应管理\"><figcaption>对应管理</figcaption></figure>\n<p>那么我们把某个点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">+x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord\">+</span><span class=\"mord mathdefault\">x</span></span></span></span> 的时候只需要把能管到这个点的都 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">+x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord\">+</span><span class=\"mord mathdefault\">x</span></span></span></span> 就好啦，那我们如何找哪些能管到我们修改的点呢，这时候就需要 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">lowbit</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span></span></span></span> 了</p>\n<h4 id=\"前缀和\"><a href=\"#%E5%89%8D%E7%BC%80%E5%92%8C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>前缀和</h4>\n<h5 id=\"一维前缀和\"><a href=\"#%E4%B8%80%E7%BB%B4%E5%89%8D%E7%BC%80%E5%92%8C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>一维前缀和</h5>\n<p>现有一个长度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 的序列 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span></span></span></span>，需要进行 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">M</span></span></span></span> 次操作，每次操作选取从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 共 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">j-i+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.74285em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 个数并求出他们的总和 （N 和 M 可以很大）  </p>\n<p>例：</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>9</mn><mtext>，</mtext><mtext>  </mtext><mi>A</mi><mo>=</mo><mo stretchy=\"false\">{</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>4</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>9</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>6</mn><mo separator=\"true\">,</mo><mn>5</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">N=9，\\;A=\\{3,1,4,1,5,9,2,6,5\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">9</span><span class=\"mord cjk_fallback\">，</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">9</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">5</span><span class=\"mclose\">}</span></span></span></span></span>\n<p>如果按照题意暴力，最坏情况下时间复杂度 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n\\times m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">m</span><span class=\"mclose\">)</span></span></span></span>（是这个吗，我咋感觉时间复杂度好像大概可能不是这个QAQ）</p>\n<p>反正时间复杂度挺高的就对了</p>\n<p>那我们可以新建一个数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span></span></span></span> ，其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub><mo>=</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_i=B_{i-1} +A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>此时我们需要求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>−</mo><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i-a_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 的总和，<del>意会下</del>，只需要求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub><mo>−</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">B_j-B_{i-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 就好啦</p>\n<p><del>很明显</del>，利用前缀和的方法，因为B数组是在读入时进行处理，可以看作不需要时间，而查询的时间复杂度就是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 啦</p>\n<h5 id=\"二维前缀和\"><a href=\"#%E4%BA%8C%E7%BB%B4%E5%89%8D%E7%BC%80%E5%92%8C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>二维前缀和</h5>\n<p>一维前缀和会了二维的也很简单</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>6</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>7</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>9</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mtext>  </mtext><mi>B</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>11</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>17</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>18</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>21</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>27</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>18</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>26</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">A=\n\\left[\n\\begin{matrix}\n5 &amp; 6 &amp; 6 &amp; 1 &amp; 4 &amp; 6\\\\\n3 &amp; 4 &amp; 2 &amp; 4 &amp; 1 &amp; 7 \\\\\n0 &amp; 9 &amp; 4 &amp; 6 &amp; 2 &amp; 4\n\\end{matrix}\n\\right]\n\\;\nB=\n\\left[\n\\begin{matrix}\n5 &amp; 11 &amp; 17 &amp; 18 &amp; 21 &amp; 27\\\\\n8 &amp; 18 &amp; 26 &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots  &amp; \\cdots &amp; \\cdots\n\\end{matrix}\n\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6010299999999997em;vertical-align:-1.55002em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎢</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">9</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">7</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎥</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6010299999999997em;vertical-align:-1.55002em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎢</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">1</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">8</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">7</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">6</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">8</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">1</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">7</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎥</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>若我们要求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mtext> </mtext><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1,\\,y_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 与 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mtext> </mtext><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2,\\,y_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 两点所围成矩形内数字的和\n公式 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo>=</mo><msub><mi>B</mi><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub><mo>−</mo><msub><mi>B</mi><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>B</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub><mo>+</mo><msub><mi>B</mi><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">sum=B_{x_2,y_2}-B_{x_2,1}-B_{1,y_1}+B_{x_1-1,y_1-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord mathdefault\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"储存\"><a href=\"#%E5%82%A8%E5%AD%98\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>储存</h3>\n<p>树状数组本质就是一个数组，我们用 C 来表示，然后把 C 排成数🎄的样子，就像前面的那个图那样</p>\n<figure><img src=\"https://gitee.com/royce2003/blog/raw/master/img/0dd7912397dda14482d369acbfb7d0a20df486d1.jpg\" alt=\"树状数组结构\"><figcaption>树状数组结构</figcaption></figure>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[1]=A[1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>2</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[2]=A[1]+A[2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[3]=A[3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>2</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[4]=A[1]+A[2]+A[3]+A[4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>5</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>5</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[5]=A[5]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">5</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">5</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>6</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>5</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>6</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[6]=A[5]+A[6]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">6</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">5</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">6</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>7</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>7</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[7]=A[7]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">7</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">7</span><span class=\"mclose\">]</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>8</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>2</mn><mo stretchy=\"false\">]</mo><mo>⋯</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mn>8</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[8]=A[1]+A[2] \\cdots A[8]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">8</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">8</span><span class=\"mclose\">]</span></span></span></span></p>\n<p>很明显 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>w</mi><mi>b</mi><mi>i</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>2</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[i]=A[i-lowbit(i)+1]+A[i-lowbit(i)+2]+ \\cdots +A[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span></span></span></span></p>\n<p>用代码写就是</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j<span class=\"token operator\">=</span>i<span class=\"token operator\">-</span><span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">&lt;=</span> i<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> a<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<p>对于 1, 3, 5, 7 这类 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span></span></span></span> 后只有一个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">A[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span></span></span></span> 的，我们称之为基点<br>\n不难发现基点的都是是奇数，即 lowbit=1\n反之，lowbit=1 的数一定是奇数，也一定是基点。</p>\n<p>而对于 1, 2, 4, 8 这类 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord mathdefault\">i</span><span class=\"mclose\">]</span></span></span></span> 后是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msub><mi>a</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\sum_{x=1}^i a_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.264274em;vertical-align:-0.29971000000000003em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.964564em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">x</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的，我们称之为统括点<br>\n也不难发现，统括点的二进制能写成 1000…… 的形式\n那么统括点一定就是 2 的幂，反之 2 的幂也一定是统括点</p>\n<p>特别的，1 既是基点又是统括点<br>\n6 不是基点也不是统括点</p>\n<h3 id=\"单点修改\"><a href=\"#%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>单点修改</h3>\n<p>如何进行单点修改，其实在之前已经讲过了<br>\n比如我们让 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">A[3]+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>，那么有包含 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">A[3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span> 的所有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span></span></span></span> 都要 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span>\n包括 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">[</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">[</mo><mn>8</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">[</mo><mn>16</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">[</mo><mn>32</mn><mo stretchy=\"false\">]</mo><mo>⋯</mo></mrow><annotation encoding=\"application/x-tex\">C[3],C[4],C[8],C[16],C[32]\\cdots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">8</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">⋯</span></span></span></span></p>\n<p>那么我们只需要这样就行了</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>j<span class=\"token operator\">=</span>i<span class=\"token punctuation\">;</span> j<span class=\"token operator\">&lt;=</span>n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">+=</span><span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    C<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> x<span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<h3 id=\"区间查询\"><a href=\"#%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>区间查询</h3>\n<p>要想得到 i 到 j 的所有数的总和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">sum_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，只需要得到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">sum_{1,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">sum_{1,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub><mo>−</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">sum_{i,j} = sum_{1,i} - sum_{1,j} + A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694379999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>\n<p>也就是前面讲到的前缀和</p>\n<p>先求 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">sum_{1,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> ，即从 i 开始不断减去 lowbit 并加 C 的值，直到找到第一个统括点（第一个包含该点的统括点）</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span>x<span class=\"token punctuation\">;</span> i<span class=\"token operator\">!=</span><span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">-=</span><span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        sum <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    sum <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//因为最后一次循环并没有进入，故在此处再加一次c[i]</span>\n    <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">sum_{1,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">u</span><span class=\"mord\"><span class=\"mord mathdefault\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 同理</p>\n<h3 id=\"结束\"><a href=\"#%E7%BB%93%E6%9D%9F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>结束</h3>\n<p>附上 AC 代码</p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;cstdio></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span>m<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">,</span>x<span class=\"token punctuation\">,</span>aa<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> a<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">[</span><span class=\"token number\">500110</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">&amp;</span> <span class=\"token operator\">-</span>x<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">&lt;=</span>n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        c<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> k<span class=\"token punctuation\">;</span>\n        x <span class=\"token operator\">+=</span> <span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span>x<span class=\"token punctuation\">;</span>i<span class=\"token operator\">!=</span><span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">-=</span><span class=\"token function\">lowbit</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        sum <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    sum <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>ssd\n    cin <span class=\"token operator\">>></span> n <span class=\"token operator\">>></span> m<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;=</span>n<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        cin <span class=\"token operator\">>></span> a<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>m<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        cin <span class=\"token operator\">>></span> aa <span class=\"token operator\">>></span> x <span class=\"token operator\">>></span> k<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>aa<span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function\">find</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span> <span class=\"token comment\">//此处和 find(k) - find(x) + a[x] 是一样的</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>题目来源：<a href=\"https://www.luogu.com.cn/problem/P3374\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">P3374 - 洛谷 | 计算机科学教育新生态</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}}]}}},"context":{}}