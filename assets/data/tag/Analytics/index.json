{"hash":"f5447af08fb91148b9326e1febff581689f9e6f2","data":{"tag":{"title":"Analytics","belongsTo":{"edges":[{"node":{"title":"我是如何加速博客的","path":"/posts/how-i-make-blog-faster/","cover_image":{"type":"image","mimeType":"image/png","src":"/%3CBlog%3E/assets/static/how-i-make-blog-faster.a209973.9110b66f44ef367118bac2f15554b0b1.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/%3CBlog%3E/assets/static/how-i-make-blog-faster.a67b0b2.9110b66f44ef367118bac2f15554b0b1.png 480w","/%3CBlog%3E/assets/static/how-i-make-blog-faster.a209973.9110b66f44ef367118bac2f15554b0b1.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-0525b2aeb3c8a2be09ea48ebd32654d4'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-0525b2aeb3c8a2be09ea48ebd32654d4)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAF6klEQVRIx8VXe2xTZRS/U4wPxEj80xklJiaIaCIqGvEPY0gEMRgwEo2BifIQFtyUsSiEzMEYAxnr2OZG2RhjIwzmBhtzL7qte3VurGvZKGxsfdy2a3t7b3sfvbev1Xnam13u%2bnKJCMmXL%2bfennu%2bc77z%2b51zijhIkl9OioIlPPJv4vz0PynzLwmH0%2b5wEE4nHtrjKCNR7Yof%2be%2bjHvNflPk3sWJzcWwg4KddtNfn9QemwWwsy0isq4ol3xdl2C02m81uhwu2E4R4YTjBcazihnpvpmTD1r1bd6dVXaqjaJqkacIZN4CwWxEe%2bc%2bCaZ1NJQj8T3C8WNlJkiRNxYEQL4Ar4Oj4pNZgNFkxDCKZslr5ZZqaAq2C8stPvrAKefSVhGeWJyQsQhYs/nzLLjuOUwwTeS%2bI2NdIPMA3nMfDe%2bzxeXlQ0i4XCOAH6%2bZgn7XrJBkX7iDETseybMNxLLQgCcKy2DAw1iTvX/Di6kVLPjycVyqTK8oqq5e%2b/RGCPJGangFwCruyexkQjhGgxruoGRtv%2bLNZqbppNE/VNzZ39faBoFSp8wp%2bv97RqVTfLCw5M6RSUwxNudxVVVItambd7jCahlmGHXACHpvMZoPBoNcb9KFdpzcQOPZ1Sjay%2bH3pxcaZmRmfzw%2b7akSz8Pllzya%2bNj6pY1gWECG2jMQCMZxHu5gOeXdyStro7TsQTNaxEzm5kmH1yMHMI9/v%2bQm8P1V8en/G4UPZOVrUKmuQXDv11uVzGXrURDNM1NIhyHwAqMmE2Sw05aCcBOnAzWYTajQuW7Nz4esbcNzBsay8V9Ha1Dgxpln/2RfII881tckgCQA/sbU5GRBnJ4QfulXWUXS6tOZKvdfvKz5TphgYBHn77pRcSWF55YWyispi6VlJYbHZam1paTiT/XFrbTbmYIA1fPkT2DKHKhQF4AH0kxTZ0jWYVXTxuLQm72zdhB7FcGzF%2bpTHlm00mCxej0ehUEz2Nuvu3vlh8yYk4SlZR6cnhKLoGQgrUnDlcIzWYADEA0jgcUSjgR3Id3v8LlhRjYyCPmoyQ368fj/kS9bR7vEFIG9QBF0c52JZoEdUy3CLFgxzsUxFbdumPUeT0k9uTvvtxk2N18OmZkmRx1eeLKsF8LhdzAx2O/vY8ZeWLn/z3Q%2bMZjMYD6MTEqcUwuIJCt6ADG6BDG/gcWhYVVJaXtfQqBkb%2b%2bNK/bWmlgmdzmq3t7a3q0dv9fYPtMu7q2vqxicn6ZCFyAAAQlB2AGhujuFYGiiNGk2Qtr%2bUo2u3Z8p6BoqkpdV1DZcqz7/63pqnl6zIP13hg%2bsPpVTsJxLGsKilQ0DCbGmiJUXFb7yzKv1AhvRsxbc7k5NT9pWfvzAwpPwqaVt3X7%2bksCTpu12p%2b36R9/QBp4nZU%2b9BiCAAQsBgrVZrQI3AYK1WZzSZUBTV6/UkqJMklIqq6pr65rZPtmUiL6%2b7M2lgWCbMk%2bidOGonEr4JfkaRtfXXvtmxG9jc0tZ%2bLDcfyN18XdbV0weyrFP%2ba1bOpxu//DF9/9CwGtIVxgQQghCy2cBXCACIOxsJCgsEnU6HE9DOOKh4M9O%2bg3nnkcTV/cO3ODeHO5zxGhnfm6J27LCCCOUMqhBc%2bYRWJ%2b/p1RlQeAR0DSqH4cp1KDqoVHV290IVBgrxX4ktgxws/NC8LBarzRZsZ1YrL/A7/AoMhIPA6QPHixJXri2/fNU/7YfIxb7NaWRx5pPIMgILYmBCNIVOxxM3yJZgnQ62Pwgj9N4Va/IR7JChMUG8xLwHgzmF0nWbd5woKeOioRGJ1ThjTRaR2RDXNUJEMqGMxrBMxZ/zZlPtysgtyMovTj5wCA4STxNzAvjXMXg%2bE/J9V4YAIAP7c05ebZFlnCg4Wij1%2bX1Ci3zI4/R8lOEvwXRg%2bsipkqJzFzxeT1Lqz5W1DSAIOX9o4/Q8lSGAwN%2bB0ou1h/NLoK/dGp9o7VIwoVFyvuN0JMUfsDL0HHTKqjeaQYaS4Pa4Y47TkbciHmYij39gynylEmpxmPI/73A0WRDJTL0AAAAASUVORK5CYII=' /%3e%3c/svg%3e"},"date":"July 30. 2020","timeToRead":5,"cjkWordCount":3504,"cjkReadTime":16,"description":"折腾博客这么久了，加速博客算是有点经验吧","content":"<div class=\"admonition admonition-note\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div>🍉 同步发布</h5></div><div class=\"admonition-content\"><ul>\n<li><strong>在少数派上阅读本文</strong> — <a href=\"https://sspai.com/post/61820\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">我是如何加速博客的</a></li>\n</ul></div></div>\n<p>谁不想拥有一个超快的博客？<del>我</del>\n这篇文章鸽了好多天了，本来打算 28 号写完的，正好那天下午开始暑假，结果晚上去聚餐了，聚餐结束又大晚上的去爬山了 <del>（真爬山，还有机会）</del>。然后到了 29 号，又花了一个下午和晚上重装系统:confounded:，咕咕咕就到了 30 号。</p>\n<p>不多说了，先来看看我的成果：</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/speed_desktop.png?fmt=webp&#x26;w=1280\" alt=\"speed desktop\"><figcaption>speed desktop</figcaption></figure>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/speed_mobile.png?fmt=webp&#x26;w=1280\" alt=\"speed mobile\"><figcaption>speed mobile</figcaption></figure>\n<p>如果你和我一样，时不时用 PageSpeed Insights 跑跑博客、F12 看看网页加载速度，那么接下来的内容可能会对你有点帮助。</p>\n<p>虽然我这冷淡的博客<strong>什么都不优化就能有九十多分</strong>，但是优化完能明显感觉浏览体验更好了。</p>\n<h2 id=\"服务器--cdn\"><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8--cdn\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>服务器 &#x26; CDN</h2>\n<p>如果你是静态博客，你可以使用自己的服务器或者其他平台提供的静态网站托管，而当你没有备案时，没办法用国内的服务器或者 CDN 服务，速度基本上不来。\n动态博客使用服务器一个道理。</p>\n<p>而备案就见仁见智了，但是必须承认，加速博客的最简单最有效的方法就是备案，然后接入国内 CDN。</p>\n<p>我目前使用的是腾讯云开发中的静态网站托管，之前尝试过 <code>COS + CDN</code> 和 <code>OSS + CDN</code>，但是使用 <code>云储存 + CDN</code> 种方法需要担心的就是流量问题，万一被恶意刷流量，会产生巨额费用，所以防护措施一定要做好。</p>\n<p>现在域名还基本都会配个小绿🔒，但是个别免费 SSL 提供商所提供的服务是真滴慢阿，光 SSL\n连接就去了好几秒，所以选择一个不错的提供商是非常重要的。泛域名证书推荐 Let's Encrypt Authority X3，双域名证书推荐 TrustAsia TLS RSA CA。</p>\n<h2 id=\"访问统计\"><a href=\"#%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>访问统计</h2>\n<p>访问统计分为两种，一种是单纯的 PV UV 统计，比如常见的不蒜子。但是<del>众所周知</del>，不蒜子日常抽风，加载时间动不动就超过 1s，但是我们想要一个超快的博客啊，整个博客的加载时间最好在 2s 以内，被你一个不蒜子占了一半怎么行呢。</p>\n<p>还有一种就是稍微专业一点的，会统计更多的内容，就比如大部分博客使用的百度或 Google 提供的统计，而引入统计的同时会带来一个 js 和一张 gif，还有几个乱七八糟的东西。百度虽然是国内的但百度统计加载还是很慢，基本半秒以内，有时候甚至一秒。而 Google 的在国内有节点，速度其实和百度差不了多少。</p>\n<h3 id=\"leancloud-统计代替不蒜子\"><a href=\"#leancloud-%E7%BB%9F%E8%AE%A1%E4%BB%A3%E6%9B%BF%E4%B8%8D%E8%92%9C%E5%AD%90\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>LeanCloud 统计代替不蒜子</h3>\n<p>对于日常抽风的不蒜子，你完全可以使用 LeanCloud 代替它，原理很简单，就是通过网页加载一段 js，向 LeanCloud 中储存的数据进行修改。但是请注意，该方法速度也不是特别快，但至少比不蒜子的 1s 要强一点，基本能在 0.5s 内完成加载。</p>\n<p>直接在网页中加入以下 js<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup> 即可。并在 LeanCloud 中新建一个应用，获取 <code>app_id</code> <code>app_key</code> <code>server_url</code>，并修改 js 中三者的值。</p>\n<div class=\"admonition admonition-tip\"><div class=\"admonition-heading\"><h5><div class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div>Tip</h5></div><div class=\"admonition-content\"><p>server_url 为该应用绑定的 API 域名</p><p>国内版用户必填，国际版用户可不填</p></div></div>\n<pre class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 查询存储的记录</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> target</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'get'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/classes/Counter?where='</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>target<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token arrow operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>results<span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>code <span class=\"token operator\">===</span> <span class=\"token number\">401</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">throw</span> error<span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>results <span class=\"token operator\">&amp;&amp;</span> results<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> record <span class=\"token operator\">=</span> results<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/classes/Counter'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>target<span class=\"token punctuation\">,</span> time<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token arrow operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record<span class=\"token punctuation\">,</span> error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token keyword\">throw</span> error<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Failed to create'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'LeanCloud Counter Error:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 发起自增请求</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> incrArr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/batch'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"requests\"</span><span class=\"token operator\">:</span> incrArr\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        res <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span><span class=\"token property-access\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">throw</span> res<span class=\"token punctuation\">.</span><span class=\"token property-access\">error</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Failed to save visitor count'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 构建自增请求体</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">objectId</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"PUT\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/1.1/classes/Counter/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> objectId <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"time\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string\">'__op'</span><span class=\"token operator\">:</span> <span class=\"token string\">'Increment'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'amount'</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 校验是否为有效的 UV</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">validUV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> key <span class=\"token operator\">=</span> <span class=\"token string\">'LeanCloud_UV_Flag'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> flag <span class=\"token operator\">=</span> <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 距离标记小于 24 小时则不计为 UV</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">86400000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token dom variable\">localStorage</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Counter</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> enableIncr <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;%= theme.web_analytics.enable %>'</span> <span class=\"token operator\">===</span> <span class=\"token string\">'true'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">hostname</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'localhost'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> getterArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> incrArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 请求 PV 并自增</span>\n    <span class=\"token keyword\">var</span> pvCtn <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-pv-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pvCtn <span class=\"token operator\">||</span> enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> pvGetter <span class=\"token operator\">=</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'site-pv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        incrArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">objectId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">var</span> ele <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-pv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          ele<span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> record<span class=\"token punctuation\">.</span><span class=\"token property-access\">time</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pvCtn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            pvCtn<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">display</span> <span class=\"token operator\">=</span> <span class=\"token string\">'inline'</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      getterArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>pvGetter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 请求 UV 并自增</span>\n    <span class=\"token keyword\">var</span> uvCtn <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-uv-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>uvCtn <span class=\"token operator\">||</span> enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> uvGetter <span class=\"token operator\">=</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'site-uv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> vuv <span class=\"token operator\">=</span> <span class=\"token function\">validUV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        vuv <span class=\"token operator\">&amp;&amp;</span> incrArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">objectId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">var</span> ele <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-site-uv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          ele<span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> record<span class=\"token punctuation\">.</span><span class=\"token property-access\">time</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>vuv <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>uvCtn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            uvCtn<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">display</span> <span class=\"token operator\">=</span> <span class=\"token string\">'inline'</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      getterArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>uvGetter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 如果是文章，请求文章的浏览数，并自增</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;%= is_post() %>'</span> <span class=\"token operator\">===</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> viewCtn <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-post-views-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>viewCtn <span class=\"token operator\">||</span> enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> target <span class=\"token operator\">=</span> <span class=\"token function\">decodeURI</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;%= url_for(page.path) %>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> viewGetter <span class=\"token operator\">=</span> <span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n          incrArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">buildIncrement</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">objectId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>viewCtn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> ele <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#leancloud-post-views'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              ele<span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">.</span><span class=\"token property-access\">time</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n              viewCtn<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">display</span> <span class=\"token operator\">=</span> <span class=\"token string\">'inline'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        getterArr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>viewGetter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 如果启动计数自增，批量发起自增请求</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>enableIncr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token known-class-name class-name\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">all</span><span class=\"token punctuation\">(</span>getterArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        incrArr<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">,</span> incrArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> app_id <span class=\"token operator\">=</span> <span class=\"token string\">'xxx'</span>\n  <span class=\"token keyword\">var</span> app_key <span class=\"token operator\">=</span> <span class=\"token string\">'xxx'</span>\n  <span class=\"token keyword\">var</span> server_url <span class=\"token operator\">=</span> <span class=\"token string\">'xxx'</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">api_server</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">Counter</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">method<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> data</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> api_server <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/1.1</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> url <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        method<span class=\"token punctuation\">,</span>\n        headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string\">'X-LC-Id'</span><span class=\"token operator\">:</span> app_id<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'X-LC-Key'</span><span class=\"token operator\">:</span> app_key<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        body<span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">Counter</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">var</span> api_server <span class=\"token operator\">=</span> app_id<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'-MdYXbMMI'</span> <span class=\"token operator\">?</span> server_url <span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span> app_id<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.api.lncldglobal.com</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>api_server<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span>api_server<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://app-router.leancloud.cn/2/route?appId='</span> <span class=\"token operator\">+</span> app_id<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token arrow operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>api_server<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://'</span> <span class=\"token operator\">+</span> api_server<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"加速-google-analytics\"><a href=\"#%E5%8A%A0%E9%80%9F-google-analytics\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>加速 Google Analytics</h3>\n<p>百度统计没看到过有人弄加速，Google Analytics 的话我目前尝试了两种方法</p>\n<h4 id=\"利用-cloudflare-workers\"><a href=\"#%E5%88%A9%E7%94%A8-cloudflare-workers\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>利用 Cloudflare Workers</h4>\n<p>原理是将一段 js 部署在 Cloudflare Workers，网页向它传输数据，它再异步发给 Google Analytics。详见 <a href=\"https://github.com/SukkaW/cloudflare-workers-async-google-analytics\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@SukkaW/cloudflare-workers-async-google-analytics</a></p>\n<p>但是该方法还是存在一定问题的，Cloudflare 自身的速度 emmm，反向加速的称号可不是吹的，某些地区确实速度非常慢，和原来的 Google Analytics 相比或许会快那么一点点（至少我当时测试的是这样的）</p>\n<h4 id=\"采用-dogedoge-提供的加速\"><a href=\"#%E9%87%87%E7%94%A8-dogedoge-%E6%8F%90%E4%BE%9B%E7%9A%84%E5%8A%A0%E9%80%9F\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>采用 DogeDoge 提供的加速</h4>\n<p>这个是我目前使用的方法，非常简单，直接使用以下代码来引入 ga。</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">ga_tid</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Your google_site_id'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> dga <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    dga<span class=\"token punctuation\">.</span><span class=\"token property-access\">src</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://rmt.dogedoge.com/fetch/public/ga.js\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    s<span class=\"token punctuation\">.</span><span class=\"token property-access\">parentNode</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">insertBefore</span><span class=\"token punctuation\">(</span>dga<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>引入的文件总共就 1 kb 多一点点，速度也是杠杠的，基本两个文件各自都能在 100ms 内加载完成，总共也就 200ms，而我测试后发现，大部分时间两个文件总共加载时间都在 100ms 内。</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/ga.png?fmt=webp\" alt=\"ga\"><figcaption>ga</figcaption></figure>\n<p>强烈推荐使用这种方法，速度贼快，还省事。</p>\n<h2 id=\"预加载\"><a href=\"#%E9%A2%84%E5%8A%A0%E8%BD%BD\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>预加载</h2>\n<p>网站第一次加载的等待时间非常重要，但浏览过程中的链接跳转的加载速度同样重要。</p>\n<p>提前加载网页，即通过 js 对当前页面中的本站链接进行预先加载，或是在鼠标悬浮在链接上时，对该链接进行预先加载。</p>\n<p>这里吐槽下，看到过有些博客使用了 pjax 局部刷新，但是博客本身的速度还是非常慢，导致体验极差，所以如果博客本身速度就非常非常慢，使用 pjax 并不会有什么效果。</p>\n<p>目前我尝试过的共有 4 种方案</p>\n<ul>\n<li>instantclick</li>\n<li><a href=\"https://github.com/GoogleChromeLabs/quicklink\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">quicklink</a></li>\n<li><a href=\"https://github.com/instantpage/instant.page\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">instant.page</a></li>\n<li><a href=\"https://github.com/gijo-varghese/flying-pages\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">flying-pages</a></li>\n</ul>\n<p>首先建议排除 instantclick，配置非常麻烦，需要考虑很多 js 问题，而且项目本身已经没有人维护了（应该是的，上一次更新是几年前的事了）</p>\n<h3 id=\"quicklink\"><a href=\"#quicklink\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>quicklink</h3>\n<p>由 Google 的团队开发，通过脚本检测当前可视区域内的链接，进行预加载。\n比如下方图片中共包含 6 个本站链接，本页面所有内容加载完成后，就会对这 6 个链接预先加载，在本地留下缓存，使得点击跳转的后的加载速度变快。因为它会加载当前可视区的所有链接，所以对服务器的负担会比较重。</p>\n<figure><img src=\"https://rmt.dogedoge.com/fetch/royce/storage/how-i-make-blog-faster/quicklink.png?fmt=webp&#x26;w=1280\" alt=\"quicklink\"><figcaption>quicklink</figcaption></figure>\n<p>他采用的预加载是在 <code>&#x3C;head></code> 中引入 <code>&#x3C;link></code></p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>prefetch<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>xxx<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>使用方法很简单</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/quicklink@2.0.0/dist/quicklink.umd.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n......\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">quicklink<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>更多的用法请查看该项目的 <a href=\"https://github.com/GoogleChromeLabs/quicklink\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub 仓库</a></p>\n<h3 id=\"instantpage\"><a href=\"#instantpage\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>instant.page</h3>\n<p>刚刚的 quicklink 是直接预加载，而这个则是鼠标悬浮在链接上时才对该链接预加载，这无疑极大的减轻了服务器的负担，是个非常好的选择。</p>\n<p>只需要加入以下代码就可以使用了</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>//instant.page/5.1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">integrity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span></span></code></pre>\n<p>预加载的方式和 quicklink 一样，也是引入 <code>&#x3C;link></code>。</p>\n<p>貌似它没有更多用法了。</p>\n<h3 id=\"flying-pages\"><a href=\"#flying-pages\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Flying Pages</h3>\n<p>这个也就是我目前在使用的了。同时具有 quicklink 和 instant.page 的功能，能直接预加载可视区域内的链接，还能预加载鼠标悬浮的链接（前一个未生效的情况下），并且能自动检测服务器状态，如果服务器繁忙则不进行预加载。同时还能修改 4 个参数的值。</p>\n<pre class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\"><span class=\"token maybe-class-name\">FPConfig</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    delay<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 浏览器空闲多少秒后开始预加载</span>\n    ignoreKeywords<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 不进行预加载的链接，例 [\"#\", \"/about\"]</span>\n    maxRPS<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 每秒最大加载数</span>\n    hoverDelay<span class=\"token operator\">:</span> <span class=\"token number\">50</span>    <span class=\"token comment\">// 鼠标悬浮后预加的延迟，毫秒单位</span>\n    <span class=\"token comment\">// 上方数值未默认值</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">defer</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"总结\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>总结</h3>\n<table>\n<thead>\n<tr>\n<th align=\"center\">插件</th>\n<th align=\"center\">Quicklink</th>\n<th align=\"center\">Instant.page</th>\n<th align=\"center\">Flying Pages</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">预加载的内容</td>\n<td align=\"center\">当前可视区域内的链接</td>\n<td align=\"center\">鼠标悬浮的链接</td>\n<td align=\"center\">可视区域 + 鼠标悬浮</td>\n</tr>\n<tr>\n<td align=\"center\">大小</td>\n<td align=\"center\">1.5 KB</td>\n<td align=\"center\">1.3 KB</td>\n<td align=\"center\">1.5 KB</td>\n</tr>\n<tr>\n<td align=\"center\">支持 Safari</td>\n<td align=\"center\">✅</td>\n<td align=\"center\">❌</td>\n<td align=\"center\">✅</td>\n</tr>\n<tr>\n<td align=\"center\">判断服务器状态</td>\n<td align=\"center\">❌</td>\n<td align=\"center\">❌</td>\n<td align=\"center\">✅</td>\n</tr>\n</tbody>\n</table>\n<p>大致的一些差异就在这里，怎么选择看你自己需求。</p>\n<h2 id=\"静态文件\"><a href=\"#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>静态文件</h2>\n<h3 id=\"图片\"><a href=\"#%E5%9B%BE%E7%89%87\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>图片</h3>\n<p>图片是一个网站浏览的大头，之前也有写过一篇文章『<a href=\"/posts/12013.html\">加速网页加载？我选择对图片下手</a>』，通过使用 WebP 来减少网站加载流量，提供网站速度。</p>\n<p>今年 WWDC 上 Safari 的更新也支持了 WebP，终于，我们不再需要为 Safair 不支持 WebP 而对它特殊照顾了。但是我个人还是习惯保留 PNG or JPG 原图，所以我选择了 <a href=\"https://v2ex.com/t/659652#reply43\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DogeDoge 提供的图床服务</a>，支持智能 WebP（浏览器支持 WebP 则返回 WebP 格式，不知此则返回原图）。还有件值得提的事情，不单单又拍云，最近腾讯数据万象也支持了智能 WebP。</p>\n<p>当然，如果你这在使用的图床服务并不支持该功能，或者并没有使用图床，但仍然想得当相同的体验，『<a href=\"https://blog.ichr.me/post/webp-on-hexo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebP 图片优化在 Hexo 上的最佳尝试</a>』 这篇文章中的方法或许是目前最佳的方式。</p>\n<p>此外，图片懒加载是个非常有效的方式，用几 kb 的 js 延迟图片加载，博客的首次加载速度能得到非常大的提升。</p>\n<h3 id=\"减少文件\"><a href=\"#%E5%87%8F%E5%B0%91%E6%96%87%E4%BB%B6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>减少文件</h3>\n<p>这是博客，初衷是写文章，输出内容。当然，美化博客是件很重要的事情，但过度的美化会适得其反，真正重要的是内容，只有内容好了，看的人才会多。不过话说回来，每个 Blogger 应该都有一个折腾的过程：<code>简单 -> 花里胡哨 -> 简单</code>，<del>起点就是终点</del>。现在我的博客能有 99 分，最大的原因就是这个主题，简约而不简陋，除去字体文件，首页加载的文件不超过 10 个。</p>\n<p>既让讲到了字体就谈谈吧，这个算是见仁见智了，有的人认为字体非常重要，直接决定了博客的观感，而有的人觉得无关紧要。我属于前者，所以字体文件在我的博客中算是流量大户了，毕竟我引入了整整三个字体，其中还包括一个中文字体，中文字体的体积可想而知。英文字体：Roboto Slab，中文：思源宋体，代码：Fira Code。两个英文字体的体积还算可以，但中文的体积真的有点大，如果你爱折腾可以试试<a href=\"https://www.font-spider.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">字蛛</a>。</p>\n<h3 id=\"文件压缩\"><a href=\"#%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>文件压缩</h3>\n<p>目前我是用的文件压缩插件是 <a href=\"https://github.com/chenzhutian/hexo-all-minifier\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">hexo-all-minifier</a>，但是并没有开启 <code>image_minifier</code>，图片压缩速度慢而且我没有把图片和博文放在一起的习惯。总体效果不错，体积能减少 20% 左右。</p>\n<p>而对于图片，我使用的是<a href=\"https://zhitu.isux.us/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">智图</a>进行压缩，虽然这个软件已经很久没更新了，但是完全够用</p>\n<h3 id=\"尽量统一外链\"><a href=\"#%E5%B0%BD%E9%87%8F%E7%BB%9F%E4%B8%80%E5%A4%96%E9%93%BE\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>尽量统一外链</h3>\n<p>这里指的外链是文件外链，加载不同域的文件需要不同的 SSL 连接时间。比如你的一个 js 来自 <code>jsdelivr.net</code>，另一个来自 <code>staticfile.org</code>，那么你就需要两次 SSL 连接，而如果你的两个文件全部来自 <code>jsdelivr.net</code> 那你将只需要一次 SSL 连接。</p>\n<h2 id=\"后\"><a href=\"#%E5%90%8E\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>后</h2>\n<p>以上就是我的一点小优化，其实也没什么东西，还说不定有什么错的地方，不过对于不怎么会代码的人或许还有点用，毕竟这些基本不涉及什么非常复杂深奥的东西。</p>\n<p>V2EX 上曾有一句话 『像你这样不分享教程的人有什么资格看不起我们这些小白？』，所以，希望大佬们在做一些事情之后能分享下相关教程，当然啦，全凭意愿 :blossom:</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>来自 <a href=\"https://github.com/fluid-dev/hexo-theme-fluid/blob/master/layout/_partial/plugins/leancloud.ejs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fluid</a></p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}}]}}},"context":{}}